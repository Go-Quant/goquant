(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=e(a);fetch(a.href,n)}})();/**
     * @license
     * KLineChart v9.8.10
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */var we=function(i,t){return we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])},we(i,t)};function V(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");we(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var F=function(){return F=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},F.apply(this,arguments)};function Zt(i,t,e,r){function a(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function s(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?n(c.value):a(c.value).then(s,l)}u((r=r.apply(i,[])).next())})}function Ut(i,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,a,n,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(e=0)),e;)try{if(r=1,a&&(n=u[0]&2?a.return:u[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,u[1])).done)return n;switch(a=0,n&&(u=[u[0]&2,n.value]),u[0]){case 0:case 1:n=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,a=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!n||u[1]>n[0]&&u[1]<n[3])){e.label=u[1];break}if(u[0]===6&&e.label<n[1]){e.label=n[1],n=u;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(u);break}n[2]&&e.ops.pop(),e.trys.pop();continue}u=t.call(i,e)}catch(c){u=[6,c],a=0}finally{r=n=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Xt(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ht(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),a,n=[],o;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)n.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(o)throw o.error}}return n}function ir(i,t,e){if(arguments.length===2)for(var r=0,a=t.length,n;r<a;r++)(n||!(r in t))&&(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return i.concat(n||Array.prototype.slice.call(t))}var N;(function(i){i.Dashed="dashed",i.Solid="solid"})(N||(N={}));var W;(function(i){i.Stroke="stroke",i.Fill="fill",i.StrokeFill="stroke_fill"})(W||(W={}));var $t;(function(i){i.Always="always",i.FollowCross="follow_cross",i.None="none"})($t||($t={}));var St;(function(i){i.Standard="standard",i.Rect="rect"})(St||(St={}));var ae;(function(i){i.Left="left",i.Middle="middle",i.Right="right"})(ae||(ae={}));var ce;(function(i){i.Fixed="fixed",i.Pointer="pointer"})(ce||(ce={}));var ut;(function(i){i.CandleSolid="candle_solid",i.CandleStroke="candle_stroke",i.CandleUpStroke="candle_up_stroke",i.CandleDownStroke="candle_down_stroke",i.Ohlc="ohlc",i.Area="area"})(ut||(ut={}));var Rt;(function(i){i.Left="left",i.Right="right"})(Rt||(Rt={}));var tt;(function(i){i.Normal="normal",i.Percentage="percentage",i.Log="log"})(tt||(tt={}));var le="#F92855",_e="rgba(249, 40, 85, .7)",ue="#2DC08E",ye="rgba(45, 192, 142, .7)",Nt="#888888",fe="#FFFFFF",nt="#1677FF",Wt="#76808F",Ee="#DDDDDD";function qt(i){return"rgba(22, 119, 255, ".concat(i,")")}function zr(){function i(){return{show:!0,size:1,color:"#EDEDED",style:N.Dashed,dashedValue:[2,2]}}return{show:!0,horizontal:i(),vertical:i()}}function Xr(){var i={show:!0,color:Wt,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:ut.CandleSolid,bar:{upColor:ue,downColor:le,noChangeColor:Nt,upBorderColor:ue,downBorderColor:le,noChangeBorderColor:Nt,upWickColor:ue,downWickColor:le,noChangeWickColor:Nt},area:{lineSize:2,lineColor:nt,smooth:!1,value:"close",backgroundColor:[{offset:0,color:qt(.01)},{offset:1,color:qt(.2)}],point:{show:!0,color:nt,radius:4,rippleColor:qt(.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:F({},i),low:F({},i),last:{show:!0,upColor:ue,downColor:le,noChangeColor:Nt,line:{show:!0,style:N.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:W.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:N.Solid,borderSize:0,borderDashedValue:[2,2],color:fe,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:$t.Always,showType:St.Standard,custom:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}],defaultValue:"n/a",rect:{position:ce.Fixed,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:Wt,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function Yr(){var i=["#FF9600","#935EBD",nt,"#E11D74","#01C5C4"].map(function(t){return{style:N.Solid,smooth:!1,size:1,dashedValue:[2,2],color:t}});return{ohlc:{upColor:ye,downColor:_e,noChangeColor:Nt},bars:[{style:W.Fill,borderStyle:N.Solid,borderSize:1,borderDashedValue:[2,2],upColor:ye,downColor:_e,noChangeColor:Nt}],lines:i,circles:[{style:W.Fill,borderStyle:N.Solid,borderSize:1,borderDashedValue:[2,2],upColor:ye,downColor:_e,noChangeColor:Nt}],lastValueMark:{show:!1,text:{show:!1,style:W.Fill,color:fe,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:N.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:$t.Always,showType:St.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:Wt,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function ar(){return{show:!0,size:"auto",axisLine:{show:!0,color:Ee,size:1},tickText:{show:!0,color:Wt,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:Ee}}}function Hr(){var i=ar();return i.type=tt.Normal,i.position=Rt.Right,i.inside=!1,i.reverse=!1,i}function Gr(){function i(){return{show:!0,line:{show:!0,style:N.Dashed,dashedValue:[4,2],size:1,color:Wt},text:{show:!0,style:W.Fill,color:fe,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:N.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:Wt,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:Wt}}}return{show:!0,horizontal:i(),vertical:i()}}function jr(){var i=qt(.35),t=qt(.25);function e(){return{style:W.Fill,color:fe,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:N.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:nt,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:nt}}return{point:{color:nt,borderColor:i,borderSize:1,radius:5,activeColor:nt,activeBorderColor:i,activeBorderSize:3,activeRadius:5},line:{style:N.Solid,smooth:!1,color:nt,size:1,dashedValue:[2,2]},rect:{style:W.Fill,color:t,borderColor:nt,borderSize:1,borderRadius:0,borderStyle:N.Solid,borderDashedValue:[2,2]},polygon:{style:W.Fill,color:nt,borderColor:nt,borderSize:1,borderStyle:N.Solid,borderDashedValue:[2,2]},circle:{style:W.Fill,color:t,borderColor:nt,borderSize:1,borderStyle:N.Solid,borderDashedValue:[2,2]},arc:{style:N.Solid,color:nt,size:1,dashedValue:[2,2]},text:e(),rectText:e()}}function Zr(){return{size:1,color:Ee,fill:!0,activeBackgroundColor:qt(.08)}}function Ur(){return{grid:zr(),candle:Xr(),indicator:Yr(),xAxis:ar(),yAxis:Hr(),separator:Zr(),crosshair:Gr(),overlay:jr()}}function vt(i,t){if(!(!xt(i)&&!xt(t))){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=i[e],a=t[e];xt(a)&&xt(r)?vt(r,a):P(t[e])&&(i[e]=oe(t[e]))}}}function oe(i){if(!xt(i))return i;var t;pt(i)?t=[]:t={};for(var e in i)if(Object.prototype.hasOwnProperty.call(i,e)){var r=i[e];xt(r)?t[e]=oe(r):t[e]=r}return t}function pt(i){return Object.prototype.toString.call(i)==="[object Array]"}function Et(i){return typeof i=="function"}function xt(i){return typeof i=="object"&&P(i)}function k(i){return typeof i=="number"&&!isNaN(i)}function P(i){return i!=null}function zt(i){return typeof i=="boolean"}function L(i){return typeof i=="string"}var qr=/\\(\\)?/g,Kr=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function et(i,t,e){if(P(i)){var r=[];t.replace(Kr,function(s){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];var c=s;return P(l[1])?c=l[2].replace(qr,"$1"):P(l[0])&&(c=l[0].trim()),r.push(c),""});for(var a=i,n=0,o=r.length;P(a)&&n<o;)a=a==null?void 0:a[r[n++]];return P(a)?a:e??"--"}return e??"--"}function $r(i,t,e){var r={};return i.formatToParts(new Date(t)).forEach(function(a){var n=a.type,o=a.value;switch(n){case"year":{r.YYYY=o;break}case"month":{r.MM=o;break}case"day":{r.DD=o;break}case"hour":{r.HH=o==="24"?"00":o;break}case"minute":{r.mm=o;break}case"second":{r.ss=o;break}}}),e.replace(/YYYY|MM|DD|HH|mm|ss/g,function(a){return r[a]})}function U(i,t){var e=+i;return k(e)?e.toFixed(t??2):"".concat(i)}function Qr(i){var t=+i;if(k(t)){if(t>1e9)return"".concat(+(t/1e9).toFixed(3),"B");if(t>1e6)return"".concat(+(t/1e6).toFixed(3),"M");if(t>1e3)return"".concat(+(t/1e3).toFixed(3),"K")}return"".concat(i)}function $(i,t){var e="".concat(i);if(t.length===0)return e;if(e.includes(".")){var r=e.split(".");return"".concat(r[0].replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(t)}),".").concat(r[1])}return e.replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(t)})}function J(i,t){var e="".concat(i),r=new RegExp("\\.0{"+t+",}[1-9][0-9]*$");if(r.test(e)){var a=e.split("."),n=a[a.length-1],o=n.match(/0*/);if(P(o)){var s=o[0].length;return a[a.length-1]=n.replace(/0*/,"0{".concat(s,"}")),a.join(".")}}return e}var ee;function Ft(i){var t,e,r;return(r=(e=(t=i.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&r!==void 0?r:1}function Yt(i,t,e){return"".concat(t??"normal"," ").concat(i??12,"px ").concat(e??"Helvetica Neue")}function he(i,t,e,r){if(!P(ee)){var a=document.createElement("canvas"),n=Ft(a);ee=a.getContext("2d"),ee.scale(n,n)}return ee.font=Yt(t,e,r),Math.round(ee.measureText(i).width)}var ht;(function(i){i.OnDataReady="onDataReady",i.OnZoom="onZoom",i.OnScroll="onScroll",i.OnVisibleRangeChange="onVisibleRangeChange",i.OnTooltipIconClick="onTooltipIconClick",i.OnCrosshairChange="onCrosshairChange",i.OnCandleBarClick="onCandleBarClick",i.OnPaneDrag="onPaneDrag"})(ht||(ht={}));var Jr=function(){function i(){this._callbacks=[]}return i.prototype.subscribe=function(t){var e,r=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;r<0&&this._callbacks.push(t)},i.prototype.unsubscribe=function(t){var e;if(Et(t)){var r=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;r>-1&&this._callbacks.splice(r,1)}else this._callbacks=[]},i.prototype.execute=function(t){this._callbacks.forEach(function(e){e(t)})},i.prototype.isEmpty=function(){return this._callbacks.length===0},i}(),ot;(function(i){i.Normal="normal",i.Price="price",i.Volume="volume"})(ot||(ot={}));function Te(i,t,e,r,a){var n=t.result,o=t.figures,s=t.styles,l=et(s,"circles",r.circles),u=l.length,c=et(s,"bars",r.bars),h=c.length,d=et(s,"lines",r.lines),f=d.length,v=0,g=0,p=0,m,_=0;o.forEach(function(S){var y;switch(S.type){case"circle":{_=v;var x=l[v%u];m=F(F({},x),{color:x.noChangeColor}),v++;break}case"bar":{_=g;var C=c[g%h];m=F(F({},C),{color:C.noChangeColor}),g++;break}case"line":{_=p,m=d[p%f],p++;break}}if(P(m)){var b={prev:{kLineData:i[e-1],indicatorData:n[e-1]},current:{kLineData:i[e],indicatorData:n[e]},next:{kLineData:i[e+1],indicatorData:n[e+1]}},E=(y=S.styles)===null||y===void 0?void 0:y.call(S,b,t,r);a(S,F(F({},m),E),_)}})}var nr=function(){function i(t){this.result=[],this._precisionFlag=!1;var e=t.name,r=t.shortName,a=t.series,n=t.calcParams,o=t.figures,s=t.precision,l=t.shouldOhlc,u=t.shouldFormatBigNumber,c=t.visible,h=t.zLevel,d=t.minValue,f=t.maxValue,v=t.styles,g=t.extendData,p=t.regenerateFigures,m=t.createTooltipDataSource,_=t.draw;this.name=e,this.shortName=r??e,this.series=a??ot.Normal,this.precision=s??4,this.calcParams=n??[],this.figures=o??[],this.shouldOhlc=l??!1,this.shouldFormatBigNumber=u??!1,this.visible=c??!0,this.zLevel=h??0,this.minValue=d??null,this.maxValue=f??null,this.styles=oe(v??{}),this.extendData=g,this.regenerateFigures=p??null,this.createTooltipDataSource=m??null,this.draw=_??null}return i.prototype.setShortName=function(t){return this.shortName!==t?(this.shortName=t,!0):!1},i.prototype.setSeries=function(t){return this.series!==t?(this.series=t,!0):!1},i.prototype.setPrecision=function(t,e){var r=e??!1,a=Math.floor(t);return a!==this.precision&&t>=0&&(!r||r&&!this._precisionFlag)?(this.precision=a,r||(this._precisionFlag=!0),!0):!1},i.prototype.setCalcParams=function(t){var e,r;return this.calcParams=t,this.figures=(r=(e=this.regenerateFigures)===null||e===void 0?void 0:e.call(this,t))!==null&&r!==void 0?r:this.figures,!0},i.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t?(this.shouldOhlc=t,!0):!1},i.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t?(this.shouldFormatBigNumber=t,!0):!1},i.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},i.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},i.prototype.setStyles=function(t){return vt(this.styles,t),!0},i.prototype.setExtendData=function(t){return this.extendData!==t?(this.extendData=t,!0):!1},i.prototype.setFigures=function(t){return this.figures!==t?(this.figures=t,!0):!1},i.prototype.setMinValue=function(t){return this.minValue!==t?(this.minValue=t,!0):!1},i.prototype.setMaxValue=function(t){return this.maxValue!==t?(this.maxValue=t,!0):!1},i.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t?(this.regenerateFigures=t,!0):!1},i.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t?(this.createTooltipDataSource=t,!0):!1},i.prototype.setDraw=function(t){return this.draw!==t?(this.draw=t,!0):!1},i.prototype.calcIndicator=function(t){return Zt(this,void 0,void 0,function(){var e;return Ut(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=r.sent(),this.result=e,[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}})})},i.extend=function(t){var e=function(r){V(a,r);function a(){return r.call(this,t)||this}return a.prototype.calc=function(n,o){return t.calc(n,o)},a}(i);return e},i}(),Kt;(function(i){i.Normal="normal",i.WeakMagnet="weak_magnet",i.StrongMagnet="strong_magnet"})(Kt||(Kt={}));function ti(){return["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]}var He=1,re=-1,ei="overlay_",jt="overlay_figure_",ri=Number.MAX_SAFE_INTEGER,ii=function(){function i(t){this.currentStep=He,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,r=t.modeSensitivity,a=t.extendData,n=t.styles,o=t.name,s=t.totalStep,l=t.lock,u=t.visible,c=t.zLevel,h=t.needDefaultPointFigure,d=t.needDefaultXAxisFigure,f=t.needDefaultYAxisFigure,v=t.createPointFigures,g=t.createXAxisFigures,p=t.createYAxisFigures,m=t.performEventPressedMove,_=t.performEventMoveForDrawing,S=t.onDrawStart,y=t.onDrawing,x=t.onDrawEnd,C=t.onClick,b=t.onDoubleClick,E=t.onRightClick,w=t.onPressedMoveStart,I=t.onPressedMoving,M=t.onPressedMoveEnd,T=t.onMouseEnter,D=t.onMouseLeave,A=t.onRemoved,B=t.onSelected,R=t.onDeselected;this.name=o,this.totalStep=!k(s)||s<2?1:s,this.lock=l??!1,this.visible=u??!0,this.zLevel=c??0,this.needDefaultPointFigure=h??!1,this.needDefaultXAxisFigure=d??!1,this.needDefaultYAxisFigure=f??!1,this.mode=e??Kt.Normal,this.modeSensitivity=r??8,this.extendData=a,this.styles=oe(n??{}),this.createPointFigures=v??null,this.createXAxisFigures=g??null,this.createYAxisFigures=p??null,this.performEventPressedMove=m??null,this.performEventMoveForDrawing=_??null,this.onDrawStart=S??null,this.onDrawing=y??null,this.onDrawEnd=x??null,this.onClick=C??null,this.onDoubleClick=b??null,this.onRightClick=E??null,this.onPressedMoveStart=w??null,this.onPressedMoving=I??null,this.onPressedMoveEnd=M??null,this.onMouseEnter=T??null,this.onMouseLeave=D??null,this.onRemoved=A??null,this.onSelected=B??null,this.onDeselected=R??null}return i.prototype.setId=function(t){return L(this.id)?!1:(this.id=t,!0)},i.prototype.setGroupId=function(t){return L(this.groupId)?!1:(this.groupId=t,!0)},i.prototype.setPaneId=function(t){this.paneId=t},i.prototype.setExtendData=function(t){return t!==this.extendData?(this.extendData=t,!0):!1},i.prototype.setStyles=function(t){return vt(this.styles,t),!0},i.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=ir([],Ht(t),!1),t.length>=this.totalStep-1?(this.currentStep=re,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),this.performEventMoveForDrawing!==null)for(var r=0;r<e;r++)this.performEventMoveForDrawing({currentStep:r+2,mode:this.mode,points:this.points,performPointIndex:r,performPoint:this.points[r]});return this.currentStep===re&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},i.prototype.setLock=function(t){return this.lock!==t?(this.lock=t,!0):!1},i.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},i.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},i.prototype.setMode=function(t){return this.mode!==t?(this.mode=t,!0):!1},i.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t?(this.modeSensitivity=t,!0):!1},i.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t?(this.onDrawStart=t,!0):!1},i.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t?(this.onDrawing=t,!0):!1},i.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t?(this.onDrawEnd=t,!0):!1},i.prototype.setOnClickCallback=function(t){return this.onClick!==t?(this.onClick=t,!0):!1},i.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t?(this.onDoubleClick=t,!0):!1},i.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t?(this.onRightClick=t,!0):!1},i.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t?(this.onPressedMoveStart=t,!0):!1},i.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t?(this.onPressedMoving=t,!0):!1},i.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t?(this.onPressedMoveEnd=t,!0):!1},i.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t?(this.onMouseEnter=t,!0):!1},i.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t?(this.onMouseLeave=t,!0):!1},i.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t?(this.onRemoved=t,!0):!1},i.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t?(this.onSelected=t,!0):!1},i.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t?(this.onDeselected=t,!0):!1},i.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=re:this.currentStep++},i.prototype.forceComplete=function(){this.currentStep=re},i.prototype.isDrawing=function(){return this.currentStep!==re},i.prototype.isStart=function(){return this.currentStep===He},i.prototype.eventMoveForDrawing=function(t){var e,r=this.currentStep-1,a={};k(t.timestamp)&&(a.timestamp=t.timestamp),k(t.dataIndex)&&(a.dataIndex=t.dataIndex),k(t.value)&&(a.value=t.value),this.points[r]=a,(e=this.performEventMoveForDrawing)===null||e===void 0||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:r,performPoint:a})},i.prototype.eventPressedPointMove=function(t,e){var r;k(t.dataIndex)&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),k(t.value)&&(this.points[e].value=t.value),(r=this.performEventPressedMove)===null||r===void 0||r.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},i.prototype.startPressedMove=function(t){this._prevPressedPoint=F({},t),this._prevPressedPoints=oe(this.points)},i.prototype.eventPressedOtherMove=function(t,e){if(this._prevPressedPoint!==null){var r;k(t.dataIndex)&&k(this._prevPressedPoint.dataIndex)&&(r=t.dataIndex-this._prevPressedPoint.dataIndex);var a;k(t.value)&&k(this._prevPressedPoint.value)&&(a=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(n){var o;k(n.timestamp)&&(n.dataIndex=e.timestampToDataIndex(n.timestamp));var s=F({},n);return k(r)&&k(n.dataIndex)&&(s.dataIndex=n.dataIndex+r,s.timestamp=(o=e.dataIndexToTimestamp(s.dataIndex))!==null&&o!==void 0?o:void 0),k(a)&&k(n.value)&&(s.value=n.value+a),s})}},i.extend=function(t){var e=function(r){V(a,r);function a(){return r.call(this,t)||this}return a}(i);return e},i}(),it;(function(i){i[i.Tooltip=0]="Tooltip",i[i.Crosshair=1]="Crosshair",i[i.XAxis=2]="XAxis"})(it||(it={}));function ai(){return{formatDate:$r,formatBigNumber:Qr}}var ni="en-US",Se=-1;function ve(i){return Et(window.requestAnimationFrame)?window.requestAnimationFrame(i):window.setTimeout(i,20)}function Ge(i){Et(window.cancelAnimationFrame)?window.cancelAnimationFrame(i):window.clearTimeout(i)}var Ie=function(){function i(t){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,vt(this._options,t)}return i.prototype._loop=function(){var t=this;this._running=!0;var e=function(){var r;if(t._running){var a=new Date().getTime()-t._time;a<t._options.duration?((r=t._doFrameCallback)===null||r===void 0||r.call(t,a),ve(e)):(t.stop(),t._currentIterationCount++,t._currentIterationCount<t._options.iterationCount&&t.start())}};ve(e)},i.prototype.doFrame=function(t){return this._doFrameCallback=t,this},i.prototype.setDuration=function(t){return this._options.duration=t,this},i.prototype.setIterationCount=function(t){return this._options.iterationCount=t,this},i.prototype.start=function(){this._running||(this._time=new Date().getTime(),this._loop())},i.prototype.stop=function(){var t;this._running&&((t=this._doFrameCallback)===null||t===void 0||t.call(this,this._options.duration)),this._running=!1},i}(),xe=1,je=new Date().getTime();function or(i){var t=new Date().getTime();return t===je?++xe:xe=1,je=t,"".concat(i??"").concat(t,"_").concat(xe)}function It(i,t){var e,r=document.createElement(i),a=t??{};for(var n in a)r.style[n]=(e=a[n])!==null&&e!==void 0?e:"";return r}function Pe(i,t,e){var r=0,a=0;for(a=i.length-1;r!==a;){var n=Math.floor((a+r)/2),o=a-r,s=i[n][t];if(e===i[r][t])return r;if(e===i[a][t])return a;if(e===s)return n;if(e>s?r=n:a=n,o<=2)break}return r}function oi(i){var t=Math.floor(ie(i)),e=Ot(t),r=i/e,a=0;return r<1.5?a=1:r<2.5?a=2:r<3.5?a=3:r<4.5?a=4:r<5.5?a=5:r<6.5?a=6:a=8,i=a*e,t>=-20?+i.toFixed(t<0?-t:0):i}function Ze(i,t){t==null&&(t=10),t=Math.min(Math.max(0,t),20);var e=(+i).toFixed(t);return+e}function si(i){var t=i.toString(),e=t.indexOf("e");if(e>0){var r=+t.slice(e+1);return r<0?-r:0}else{var a=t.indexOf(".");return a<0?0:t.length-1-a}}function sr(i,t,e){var r=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return i.forEach(function(a){var n,o;r[0]=Math.max((n=a[t])!==null&&n!==void 0?n:a,r[0]),r[1]=Math.min((o=a[e])!==null&&o!==void 0?o:a,r[1])}),r}function ie(i){return Math.log(i)/Math.log(10)}function Ot(i){return Math.pow(10,i)}var ct;(function(i){i.Init="init",i.Forward="forward",i.Backward="backward"})(ct||(ct={}));function Ue(){return{from:0,to:0,realFrom:0,realTo:0}}var qe={MIN:1,MAX:50},li=8,ui=80,ci=.88,Me=10,hi=function(){function i(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=li,this._offsetRightDistance=ui,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange=Ue(),this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace}return i.prototype._calcGapBarSpace=function(){var t;return this._barSpace>3?t=Math.floor(this._barSpace*ci):(t=Math.floor(this._barSpace),t===this._barSpace&&t--),t%2===0&&t--,t=Math.max(1,t),t},i.prototype.adjustVisibleRange=function(){var t,e,r=this._chartStore.getDataList(),a=r.length,n=this._totalBarSpace/this._barSpace,o,s;this._scrollLimitRole===1?(o=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,s=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(o=this._minVisibleBarCount.left,s=this._minVisibleBarCount.right),o=Math.max(0,o),s=Math.max(0,s);var l=n-Math.min(o,a);this._lastBarRightSideDiffBarCount>l&&(this._lastBarRightSideDiffBarCount=l);var u=-a+Math.min(s,a);this._lastBarRightSideDiffBarCount<u&&(this._lastBarRightSideDiffBarCount=u);var c=Math.round(this._lastBarRightSideDiffBarCount+a+.5),h=c;c>a&&(c=a);var d=Math.round(c-n)-1;d<0&&(d=0);var f=this._lastBarRightSideDiffBarCount>0?Math.round(a+this._lastBarRightSideDiffBarCount-n)-1:d;if(this._visibleRange={from:d,to:c,realFrom:f,realTo:h},this._chartStore.getActionStore().execute(ht.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),d===0){var v=r[0];this._chartStore.executeLoadMoreCallback((t=v==null?void 0:v.timestamp)!==null&&t!==void 0?t:null),this._chartStore.executeLoadDataCallback({type:ct.Forward,data:v??null})}c===a&&this._chartStore.executeLoadDataCallback({type:ct.Backward,data:(e=r[a-1])!==null&&e!==void 0?e:null})},i.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},i.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};L(t)&&(e.timeZone=t);var r=null;try{r=new Intl.DateTimeFormat("en",e)}catch{}return r},i.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);e!==null&&(this._dateTimeFormat=e)},i.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},i.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},i.prototype.setBarSpace=function(t,e){t<qe.MIN||t>qe.MAX||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),e==null||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},i.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},i.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=this._scrollLimitRole===1?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(e??!1)&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},i.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},i.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},i.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},i.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},i.prototype.setLastBarRightSideDiffBarCount=function(t){return this._lastBarRightSideDiffBarCount=t,this},i.prototype.setMaxOffsetLeftDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.left=t,this},i.prototype.setMaxOffsetRightDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.right=t,this},i.prototype.setLeftMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.left=t,this},i.prototype.setRightMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.right=t,this},i.prototype.getVisibleRange=function(){return this._visibleRange},i.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},i.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace,r=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0);var a=Math.round(r-this._lastBarRightSideDiffBarCount*this._barSpace);a!==0&&this._chartStore.getActionStore().execute(ht.OnScroll,{distance:a})}},i.prototype.getDataByDataIndex=function(t){var e;return(e=this._chartStore.getDataList()[t])!==null&&e!==void 0?e:null},i.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,r=(this._totalBarSpace-t)/this._barSpace,a=e+this._lastBarRightSideDiffBarCount-r;return Math.round(a*1e6)/1e6},i.prototype.dataIndexToTimestamp=function(t){var e,r=this.getDataByDataIndex(t);return(e=r==null?void 0:r.timestamp)!==null&&e!==void 0?e:null},i.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return e.length===0?0:Pe(e,"timestamp",t)},i.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length,r=e+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(r-.5)*this._barSpace)},i.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},i.prototype.zoom=function(t,e){var r=this,a;if(this._zoomEnabled){var n=e??null;if(!k(n==null?void 0:n.x)){var o=this._chartStore.getTooltipStore().getCrosshair();n={x:(a=o==null?void 0:o.x)!==null&&a!==void 0?a:this._totalBarSpace/2}}var s=n.x,l=this.coordinateToFloatIndex(s),u=this._barSpace,c=this._barSpace+t*(this._barSpace/Me);this.setBarSpace(c,function(){r._lastBarRightSideDiffBarCount+=l-r.coordinateToFloatIndex(s)});var h=this._barSpace/u;h!==1&&this._chartStore.getActionStore().execute(ht.OnZoom,{scale:h})}},i.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},i.prototype.getZoomEnabled=function(){return this._zoomEnabled},i.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},i.prototype.getScrollEnabled=function(){return this._scrollEnabled},i.prototype.clear=function(){this._visibleRange=Ue()},i}(),vi={name:"AVP",shortName:"AVP",series:ot.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(i){var t=0,e=0;return i.map(function(r){var a,n,o={},s=(a=r==null?void 0:r.turnover)!==null&&a!==void 0?a:0,l=(n=r==null?void 0:r.volume)!==null&&n!==void 0?n:0;return t+=s,e+=l,e!==0&&(o.avp=t/e),o})}},di={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(i,t,e){var r,a,n,o,s=i.prev,l=i.current,u=(a=(r=s.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,c=(o=(n=l.indicatorData)===null||n===void 0?void 0:n.ao)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,h;c>u?h=et(t.styles,"bars[0].upColor",e.bars[0].upColor):h=et(t.styles,"bars[0].downColor",e.bars[0].downColor);var d=c>u?W.Stroke:W.Fill;return{color:h,style:d,borderColor:h}}}],calc:function(i,t){var e=t.calcParams,r=Math.max(e[0],e[1]),a=0,n=0,o=0,s=0;return i.map(function(l,u){var c={},h=(l.low+l.high)/2;if(a+=h,n+=h,u>=e[0]-1){o=a/e[0];var d=i[u-(e[0]-1)];a-=(d.low+d.high)/2}if(u>=e[1]-1){s=n/e[1];var d=i[u-(e[1]-1)];n-=(d.low+d.high)/2}return u>=r-1&&(c.ao=o-s),c})}},fi={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,a=[];return i.map(function(n,o){var s={},l=n.close;return e.forEach(function(u,c){var h;if(a[c]=((h=a[c])!==null&&h!==void 0?h:0)+l,o>=u-1){var d=a[c]/e[c];s[r[c].key]=(l-d)/d*100,a[c]-=i[o-(u-1)].close}}),s})}};function gi(i,t){var e=i.length,r=0;return i.forEach(function(a){var n=a.close-t;r+=n*n}),r=Math.abs(r),Math.sqrt(r/e)}var pi={name:"BOLL",shortName:"BOLL",series:ot.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=e[0]-1,a=0;return i.map(function(n,o){var s=n.close,l={};if(a+=s,o>=r){l.mid=a/e[0];var u=gi(i.slice(o-r,o+1),l.mid);l.up=l.mid+e[1]*u,l.dn=l.mid-e[1]*u,a-=i[o-r].close}return l})}},mi={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=0,n=0,o=0;return i.map(function(s,l){var u,c,h={},d=s.high,f=s.low,v=s.open,g=((u=i[l-1])!==null&&u!==void 0?u:s).close;if(n+=d-v,o+=v-f,r+=d-g,a+=g-f,l>=e[0]-1){o!==0?h.ar=n/o*100:h.ar=0,a!==0?h.br=r/a*100:h.br=0;var p=i[l-(e[0]-1)],m=p.high,_=p.low,S=p.open,y=((c=i[l-e[0]])!==null&&c!==void 0?c:i[l-(e[0]-1)]).close;r-=m-y,a-=y-_,n-=m-S,o-=S-_}return h})}},_i={name:"BBI",shortName:"BBI",series:ot.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.max.apply(Math,ir([],Ht(e),!1)),a=[],n=[];return i.map(function(o,s){var l={},u=o.close;if(e.forEach(function(h,d){var f;a[d]=((f=a[d])!==null&&f!==void 0?f:0)+u,s>=h-1&&(n[d]=a[d]/h,a[d]-=i[s-(h-1)].close)}),s>=r-1){var c=0;n.forEach(function(h){c+=h}),l.bbi=c/4}return l})}},yi={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=e[0]-1,a=0,n=[];return i.map(function(o,s){var l={},u=(o.high+o.low+o.close)/3;if(a+=u,n.push(u),s>=r){var c=a/e[0],h=n.slice(s-r,s+1),d=0;h.forEach(function(g){d+=Math.abs(g-c)});var f=d/e[0];l.cci=f!==0?(u-c)/f/.015:0;var v=(i[s-r].high+i[s-r].low+i[s-r].close)/3;a-=v}return l})}},Si={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.ceil(e[1]/2.5+1),a=Math.ceil(e[2]/2.5+1),n=Math.ceil(e[3]/2.5+1),o=Math.ceil(e[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,d=[],f=0,v=[],g=[];return i.forEach(function(p,m){var _,S,y,x,C,b={},E=(_=i[m-1])!==null&&_!==void 0?_:p,w=(E.high+E.close+E.low+E.open)/4,I=Math.max(0,p.high-w),M=Math.max(0,w-p.low);m>=e[0]-1&&(M!==0?b.cr=I/M*100:b.cr=0,s+=b.cr,u+=b.cr,h+=b.cr,f+=b.cr,m>=e[0]+e[1]-2&&(l.push(s/e[1]),m>=e[0]+e[1]+r-3&&(b.ma1=l[l.length-1-r]),s-=(S=g[m-(e[1]-1)].cr)!==null&&S!==void 0?S:0),m>=e[0]+e[2]-2&&(c.push(u/e[2]),m>=e[0]+e[2]+a-3&&(b.ma2=c[c.length-1-a]),u-=(y=g[m-(e[2]-1)].cr)!==null&&y!==void 0?y:0),m>=e[0]+e[3]-2&&(d.push(h/e[3]),m>=e[0]+e[3]+n-3&&(b.ma3=d[d.length-1-n]),h-=(x=g[m-(e[3]-1)].cr)!==null&&x!==void 0?x:0),m>=e[0]+e[4]-2&&(v.push(f/e[4]),m>=e[0]+e[4]+o-3&&(b.ma4=v[v.length-1-o]),f-=(C=g[m-(e[4]-1)].cr)!==null&&C!==void 0?C:0)),g.push(b)}),g}},xi={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.max(e[0],e[1]),a=0,n=0,o=0,s=[];return i.forEach(function(l,u){var c,h={},d=l.close;a+=d,n+=d;var f=0,v=0;if(u>=e[0]-1&&(f=a/e[0],a-=i[u-(e[0]-1)].close),u>=e[1]-1&&(v=n/e[1],n-=i[u-(e[1]-1)].close),u>=r-1){var g=f-v;h.dma=g,o+=g,u>=r+e[2]-2&&(h.ama=o/e[2],o-=(c=s[u-(e[2]-1)].dma)!==null&&c!==void 0?c:0)}s.push(h)}),s}},bi={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=0,n=0,o=0,s=0,l=0,u=0,c=0,h=[];return i.forEach(function(d,f){var v,g,p={},m=(v=i[f-1])!==null&&v!==void 0?v:d,_=m.close,S=d.high,y=d.low,x=S-y,C=Math.abs(S-_),b=Math.abs(_-y),E=S-m.high,w=m.low-y,I=Math.max(Math.max(x,C),b),M=E>0&&E>w?E:0,T=w>0&&w>E?w:0;if(r+=I,a+=M,n+=T,f>=e[0]-1){f>e[0]-1?(o=o-o/e[0]+I,s=s-s/e[0]+M,l=l-l/e[0]+T):(o=r,s=a,l=n);var D=0,A=0;o!==0&&(D=s*100/o,A=l*100/o),p.pdi=D,p.mdi=A;var B=0;A+D!==0&&(B=Math.abs(A-D)/(A+D)*100),u+=B,f>=e[0]*2-2&&(f>e[0]*2-2?c=(c*(e[0]-1)+B)/e[0]:c=u/e[0],p.adx=c,f>=e[0]*2+e[1]-3&&(p.adxr=(((g=h[f-(e[1]-1)].adx)!==null&&g!==void 0?g:0)+c)/2))}h.push(p)}),h}},Ci={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=[];return i.map(function(n,o){var s,l={};if(o>0){var u=i[o-1],c=n.high,h=n.low,d=(s=n.volume)!==null&&s!==void 0?s:0,f=(c+h)/2-(u.high+u.low)/2;if(d===0||c-h===0)l.emv=0;else{var v=d/1e8/(c-h);l.emv=f/v}r+=l.emv,a.push(l.emv),o>=e[0]&&(l.maEmv=r/e[0],r-=a[o-e[0]])}return l})}},wi={name:"EMA",shortName:"EMA",series:ot.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,a=0,n=[];return i.map(function(o,s){var l={},u=o.close;return a+=u,e.forEach(function(c,h){s>=c-1&&(s>c-1?n[h]=(2*u+(c-1)*n[h])/(c+1):n[h]=a/c,l[r[h].key]=n[h])}),l})}},Ei={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=[];return i.forEach(function(n,o){var s,l={};if(o>=e[0]){var u=n.close,c=i[o-e[0]].close;l.mtm=u-c,r+=l.mtm,o>=e[0]+e[1]-1&&(l.maMtm=r/e[1],r-=(s=a[o-(e[1]-1)].mtm)!==null&&s!==void 0?s:0)}a.push(l)}),a}},Ii={name:"MA",shortName:"MA",series:ot.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,a=[];return i.map(function(n,o){var s={},l=n.close;return e.forEach(function(u,c){var h;a[c]=((h=a[c])!==null&&h!==void 0?h:0)+l,o>=u-1&&(s[r[c].key]=a[c]/u,a[c]-=i[o-(u-1)].close)}),s})}},Pi={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(i,t,e){var r,a,n,o,s=i.prev,l=i.current,u=(a=(r=s.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,c=(o=(n=l.indicatorData)===null||n===void 0?void 0:n.macd)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,h;c>0?h=et(t.styles,"bars[0].upColor",e.bars[0].upColor):c<0?h=et(t.styles,"bars[0].downColor",e.bars[0].downColor):h=et(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);var d=u<c?W.Stroke:W.Fill;return{style:d,color:h,borderColor:h}}}],calc:function(i,t){var e=t.calcParams,r=0,a,n,o=0,s=0,l=0,u=Math.max(e[0],e[1]);return i.map(function(c,h){var d={},f=c.close;return r+=f,h>=e[0]-1&&(h>e[0]-1?a=(2*f+(e[0]-1)*a)/(e[0]+1):a=r/e[0]),h>=e[1]-1&&(h>e[1]-1?n=(2*f+(e[1]-1)*n)/(e[1]+1):n=r/e[1]),h>=u-1&&(o=a-n,d.dif=o,s+=o,h>=u+e[2]-2&&(h>u+e[2]-2?l=(o*2+l*(e[2]-1))/(e[2]+1):l=s/e[2],d.macd=(o-l)*2,d.dea=l)),d})}},Mi={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=0,n=[];return i.forEach(function(o,s){var l,u,c,h,d=(l=i[s-1])!==null&&l!==void 0?l:o;o.close<d.close?a-=(u=o.volume)!==null&&u!==void 0?u:0:o.close>d.close&&(a+=(c=o.volume)!==null&&c!==void 0?c:0);var f={obv:a};r+=a,s>=e[0]-1&&(f.maObv=r/e[0],r-=(h=n[s-(e[0]-1)].obv)!==null&&h!==void 0?h:0),n.push(f)}),n}},Ti={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(i){var t=0;return i.map(function(e,r){var a,n,o={},s=e.close,l=(a=e.volume)!==null&&a!==void 0?a:1,u=((n=i[r-1])!==null&&n!==void 0?n:e).close,c=0,h=u*l;return h!==0&&(c=(s-u)/h),t+=c,o.pvt=t,o})}},Di={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=0,n=[],o=[];return i.forEach(function(s,l){var u,c,h={},d=((u=i[l-1])!==null&&u!==void 0?u:s).close,f=s.close-d>0?1:0;n.push(f),r+=f,l>=e[0]-1&&(h.psy=r/e[0]*100,a+=h.psy,l>=e[0]+e[1]-2&&(h.maPsy=a/e[1],a-=(c=o[l-(e[1]-1)].psy)!==null&&c!==void 0?c:0),r-=n[l-(e[0]-1)]),o.push(h)}),o}},Ai={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=[],a=0;return i.forEach(function(n,o){var s,l,u={};if(o>=e[0]-1){var c=n.close,h=((s=i[o-e[0]])!==null&&s!==void 0?s:i[o-(e[0]-1)]).close;h!==0?u.roc=(c-h)/h*100:u.roc=0,a+=u.roc,o>=e[0]-1+e[1]-1&&(u.maRoc=a/e[1],a-=(l=r[o-(e[1]-1)].roc)!==null&&l!==void 0?l:0)}r.push(u)}),r}},ki={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){var r=e+1;return{key:"rsi".concat(r),title:"RSI".concat(r,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,a=[],n=[];return i.map(function(o,s){var l,u={},c=((l=i[s-1])!==null&&l!==void 0?l:o).close,h=o.close-c;return e.forEach(function(d,f){var v,g,p;if(h>0?a[f]=((v=a[f])!==null&&v!==void 0?v:0)+h:n[f]=((g=n[f])!==null&&g!==void 0?g:0)+Math.abs(h),s>=d-1){n[f]!==0?u[r[f].key]=100-100/(1+a[f]/n[f]):u[r[f].key]=0;var m=i[s-(d-1)],_=(p=i[s-d])!==null&&p!==void 0?p:m,S=m.close-_.close;S>0?a[f]-=S:n[f]-=Math.abs(S)}}),u})}},Fi={name:"SMA",shortName:"SMA",series:ot.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(i,t){var e=t.calcParams,r=0,a=0;return i.map(function(n,o){var s={},l=n.close;return r+=l,o>=e[0]-1&&(o>e[0]-1?a=(l*e[1]+a*(e[0]-e[1]+1))/(e[0]+1):a=r/e[0],s.sma=a),s})}},Ri={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=[];return i.forEach(function(a,n){var o,s,l,u,c={},h=a.close;if(n>=e[0]-1){var d=sr(i.slice(n-(e[0]-1),n+1),"high","low"),f=d[0],v=d[1],g=f-v,p=(h-v)/(g===0?1:g)*100;c.k=((e[1]-1)*((s=(o=r[n-1])===null||o===void 0?void 0:o.k)!==null&&s!==void 0?s:50)+p)/e[1],c.d=((e[2]-1)*((u=(l=r[n-1])===null||l===void 0?void 0:l.d)!==null&&u!==void 0?u:50)+c.k)/e[2],c.j=3*c.k-2*c.d}r.push(c)}),r}},Bi={name:"SAR",shortName:"SAR",series:ot.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(i,t,e){var r,a,n=i.current,o=(a=(r=n.indicatorData)===null||r===void 0?void 0:r.sar)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,s=n.kLineData,l=((s==null?void 0:s.high)+(s==null?void 0:s.low))/2,u=o<l?et(t.styles,"circles[0].upColor",e.circles[0].upColor):et(t.styles,"circles[0].downColor",e.circles[0].downColor);return{color:u}}}],calc:function(i,t){var e=t.calcParams,r=e[0]/100,a=e[1]/100,n=e[2]/100,o=r,s=-100,l=!1,u=0;return i.map(function(c,h){var d=u,f=c.high,v=c.low;if(l){(s===-100||s<f)&&(s=f,o=Math.min(o+a,n)),u=d+o*(s-d);var g=Math.min(i[Math.max(1,h)-1].low,v);u>c.low?(u=s,o=r,s=-100,l=!l):u>g&&(u=g)}else{(s===-100||s>v)&&(s=v,o=Math.min(o+a,n)),u=d+o*(s-d);var p=Math.max(i[Math.max(1,h)-1].high,f);u<c.high?(u=s,o=0,s=-100,l=!l):u<p&&(u=p)}return{sar:u}})}},Li={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a,n,o,s=0,l=0,u=0,c=[];return i.forEach(function(h,d){var f,v={},g=h.close;if(r+=g,d>=e[0]-1&&(d>e[0]-1?a=(2*g+(e[0]-1)*a)/(e[0]+1):a=r/e[0],s+=a,d>=e[0]*2-2&&(d>e[0]*2-2?n=(2*a+(e[0]-1)*n)/(e[0]+1):n=s/e[0],l+=n,d>=e[0]*3-3))){var p=void 0,m=0;d>e[0]*3-3?(p=(2*n+(e[0]-1)*o)/(e[0]+1),m=(p-o)/o*100):p=l/e[0],o=p,v.trix=m,u+=m,d>=e[0]*3+e[1]-4&&(v.maTrix=u/e[1],u-=(f=c[d-(e[1]-1)].trix)!==null&&f!==void 0?f:0)}c.push(v)}),c}};function Ke(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(i,t,e){var r=i.current.kLineData,a=et(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);return P(r)&&(r.close>r.open?a=et(t.styles,"bars[0].upColor",e.bars[0].upColor):r.close<r.open&&(a=et(t.styles,"bars[0].downColor",e.bars[0].downColor))),{color:a}}}}var Vi={name:"VOL",shortName:"VOL",series:ot.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},Ke()],regenerateFigures:function(i){var t=i.map(function(e,r){return{key:"ma".concat(r+1),title:"MA".concat(e,": "),type:"line"}});return t.push(Ke()),t},calc:function(i,t){var e=t.calcParams,r=t.figures,a=[];return i.map(function(n,o){var s,l=(s=n.volume)!==null&&s!==void 0?s:0,u={volume:l};return e.forEach(function(c,h){var d,f;a[h]=((d=a[h])!==null&&d!==void 0?d:0)+l,o>=c-1&&(u[r[h].key]=a[h]/c,a[h]-=(f=i[o-(c-1)].volume)!==null&&f!==void 0?f:0)}),u})}},Oi={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,a=0,n=0,o=0,s=[];return i.forEach(function(l,u){var c,h,d,f,v,g={},p=l.close,m=((c=i[u-1])!==null&&c!==void 0?c:l).close,_=(h=l.volume)!==null&&h!==void 0?h:0;if(p>m?r+=_:p<m?a+=_:n+=_,u>=e[0]-1){var S=n/2;a+S===0?g.vr=0:g.vr=(r+S)/(a+S)*100,o+=g.vr,u>=e[0]+e[1]-2&&(g.maVr=o/e[1],o-=(d=s[u-(e[1]-1)].vr)!==null&&d!==void 0?d:0);var y=i[u-(e[0]-1)],x=(f=i[u-e[0]])!==null&&f!==void 0?f:y,C=y.close,b=(v=y.volume)!==null&&v!==void 0?v:0;C>x.close?r-=b:C<x.close?a-=b:n-=b}s.push(g)}),s}},Ni={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures;return i.map(function(a,n){var o={},s=a.close;return e.forEach(function(l,u){var c=l-1;if(n>=c){var h=sr(i.slice(n-c,n+1),"high","low"),d=h[0],f=h[1],v=d-f;o[r[u].key]=v===0?0:(s-d)/v*100}}),o})}},De={},Wi=[vi,di,fi,pi,mi,_i,yi,Si,xi,bi,Ci,wi,Ei,Ii,Pi,Mi,Ti,Di,Ai,ki,Fi,Ri,Bi,Li,Vi,Oi,Ni];Wi.forEach(function(i){De[i.name]=nr.extend(i)});function zi(i){De[i.name]=nr.extend(i)}function lr(i){var t;return(t=De[i])!==null&&t!==void 0?t:null}var Xi=function(){function i(t){this._instances=new Map,this._chartStore=t}return i.prototype._overrideInstance=function(t,e){var r=e.shortName,a=e.series,n=e.calcParams,o=e.precision,s=e.figures,l=e.minValue,u=e.maxValue,c=e.shouldOhlc,h=e.shouldFormatBigNumber,d=e.visible,f=e.zLevel,v=e.styles,g=e.extendData,p=e.regenerateFigures,m=e.createTooltipDataSource,_=e.draw,S=e.calc,y=!1;L(r)&&t.setShortName(r)&&(y=!0),P(a)&&t.setSeries(a)&&(y=!0);var x=!1;pt(n)&&t.setCalcParams(n)&&(y=!0,x=!0),pt(s)&&t.setFigures(s)&&(y=!0,x=!0),l!==void 0&&t.setMinValue(l)&&(y=!0),u!==void 0&&t.setMinValue(u)&&(y=!0),k(o)&&t.setPrecision(o)&&(y=!0),zt(c)&&t.setShouldOhlc(c)&&(y=!0),zt(h)&&t.setShouldFormatBigNumber(h)&&(y=!0),zt(d)&&t.setVisible(d)&&(y=!0);var C=!1;return k(f)&&t.setZLevel(f)&&(y=!0,C=!0),P(v)&&t.setStyles(v)&&(y=!0),g!==void 0&&t.setExtendData(g)&&(y=!0,x=!0),p!==void 0&&t.setRegenerateFigures(p)&&(y=!0),m!==void 0&&t.setCreateTooltipDataSource(m)&&(y=!0),_!==void 0&&t.setDraw(_)&&(y=!0),Et(S)&&(t.calc=S,x=!0),[y,x,C]},i.prototype._sort=function(t){var e;L(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(r,a){return r.zLevel-a.zLevel}):this._instances.forEach(function(r){r.sort(function(a,n){return a.zLevel-n.zLevel})})},i.prototype.addInstance=function(t,e,r){return Zt(this,void 0,void 0,function(){var a,n,o,s,l;return Ut(this,function(u){switch(u.label){case 0:return a=t.name,n=this._instances.get(e),P(n)?(o=n.find(function(c){return c.name===a}),P(o)?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2]):[3,2];case 1:return[2,u.sent()];case 2:return P(n)||(n=[]),s=lr(a),l=new s,this.synchronizeSeriesPrecision(l),this._overrideInstance(l,t),r||(n=[]),n.push(l),this._instances.set(e,n),this._sort(e),[4,l.calcIndicator(this._chartStore.getDataList())];case 3:return[2,u.sent()]}})})},i.prototype.getInstances=function(t){var e;return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},i.prototype.removeInstance=function(t,e){var r,a=!1,n=this._instances.get(t);if(P(n)){if(L(e)){var o=n.findIndex(function(s){return s.name===e});o>-1&&(n.splice(o,1),a=!0)}else this._instances.set(t,[]),a=!0;((r=this._instances.get(t))===null||r===void 0?void 0:r.length)===0&&this._instances.delete(t)}return a},i.prototype.hasInstances=function(t){return this._instances.has(t)},i.prototype.calcInstance=function(t,e){return Zt(this,void 0,void 0,function(){var r,a,n,o,s=this;return Ut(this,function(l){switch(l.label){case 0:return r=[],L(t)?L(e)?(a=this._instances.get(e),P(a)&&(n=a.find(function(u){return u.name===t}),P(n)&&r.push(n.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(u){var c=u.find(function(h){return h.name===t});P(c)&&r.push(c.calcIndicator(s._chartStore.getDataList()))}):this._instances.forEach(function(u){u.forEach(function(c){r.push(c.calcIndicator(s._chartStore.getDataList()))})}),[4,Promise.all(r)];case 1:return o=l.sent(),[2,o.includes(!0)]}})})},i.prototype.getInstanceByPaneId=function(t,e){var r,a,n=function(l){var u=new Map;return l.forEach(function(c){u.set(c.name,c)}),u};if(L(t)){var o=(r=this._instances.get(t))!==null&&r!==void 0?r:[];return L(e)?(a=o==null?void 0:o.find(function(l){return l.name===e}))!==null&&a!==void 0?a:null:n(o)}var s=new Map;return this._instances.forEach(function(l,u){s.set(u,n(l))}),s},i.prototype.synchronizeSeriesPrecision=function(t){var e=this._chartStore.getPrecision(),r=e.price,a=e.volume,n=function(o){switch(o.series){case ot.Price:{o.setPrecision(r,!0);break}case ot.Volume:{o.setPrecision(a,!0);break}}};P(t)?n(t):this._instances.forEach(function(o){o.forEach(function(s){n(s)})})},i.prototype.override=function(t,e){return Zt(this,void 0,void 0,function(){var r,a,n,o,s,l,u,c=this;return Ut(this,function(h){switch(h.label){case 0:return r=t.name,a=new Map,e!==null?(n=this._instances.get(e),P(n)&&a.set(e,n)):a=this._instances,o=!1,s=[],l=!1,a.forEach(function(d){var f=d.find(function(g){return g.name===r});if(P(f)){var v=c._overrideInstance(f,t);v[2]&&(l=!0),v[1]?s.push(f.calcIndicator(c._chartStore.getDataList())):v[0]&&(o=!0)}}),l&&this._sort(),[4,Promise.all(s)];case 1:return u=h.sent(),[2,[o,u.includes(!0)]]}})})},i}(),Yi=function(){function i(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return i.prototype.setCrosshair=function(t,e){var r=this._chartStore.getDataList(),a=t??{},n,o;k(a.x)?(n=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x),n<0?o=0:n>r.length-1?o=r.length-1:o=n):(n=r.length-1,o=n);var s=r[o],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(n),u={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair=F(F({},a),{realX:l,kLineData:s,realDataIndex:n,dataIndex:o}),(u.x!==a.x||u.y!==a.y||u.paneId!==a.paneId)&&(s!==null&&this._chartStore.getChart().crosshairChange(this._crosshair),(e??!1)||this._chartStore.getChart().updatePane(1))},i.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,t)},i.prototype.getCrosshair=function(){return this._crosshair},i.prototype.setActiveIcon=function(t){this._activeIcon=t??null},i.prototype.getActiveIcon=function(){return this._activeIcon},i.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},i}(),Hi={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t,e=i.coordinates,r=i.bounding,a=i.overlay,n=i.precision,o=i.thousandsSeparator,s=i.decimalFoldThreshold,l=i.yAxis,u=a.points;if(e.length>0){var c=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?n.price:n.excludePriceVolumeMax,h=[],d=[],f=0,v=r.width;if(e.length>1&&k(u[0].value)&&k(u[1].value)){var g=[1,.786,.618,.5,.382,.236,0],p=e[0].y-e[1].y,m=u[0].value-u[1].value;g.forEach(function(_){var S,y=e[1].y+p*_,x=J($((((S=u[1].value)!==null&&S!==void 0?S:0)+m*_).toFixed(c),o),s);h.push({coordinates:[{x:f,y},{x:v,y}]}),d.push({x:f,y,text:"".concat(x," (").concat((_*100).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:h},{type:"text",isCheckEvent:!1,attrs:d}]}return[]}},Gi={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding,r={x:0,y:t[0].y};return P(t[1])&&t[0].x<t[1].x&&(r.x=e.width),[{type:"line",attrs:{coordinates:[t[0],r]}}]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].value=r.value)}},ji={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=[];return t.length===2&&e.push({coordinates:t}),[{type:"line",attrs:e}]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].value=r.value)}},Zi={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:e.width,y:t[0].y}]}}]}},Ae=function(){function i(){this._children=[],this._callbacks=new Map}return i.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},i.prototype.onEvent=function(t,e,r){var a=this._callbacks.get(t);return P(a)&&this.checkEventOn(e)?a(e,r):!1},i.prototype.checkEventOn=function(t){var e,r;try{for(var a=Xt(this._children),n=a.next();!n.done;n=a.next()){var o=n.value;if(o.checkEventOn(t))return!0}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return!1},i.prototype.dispatchEvent=function(t,e,r){var a=this._children.length-1;if(a>-1){for(var n=a;n>-1;n--)if(this._children[n].dispatchEvent(t,e,r))return!0}return this.onEvent(t,e,r)},i.prototype.addChild=function(t){return this._children.push(t),this},i.prototype.clear=function(){this._children=[]},i}(),Q=2,Ui=function(i){V(t,i);function t(e){var r=i.call(this)||this;return r.attrs=e.attrs,r.styles=e.styles,r}return t.prototype.checkEventOn=function(e){return this.checkEventOnImp(e,this.attrs,this.styles)},t.prototype.setAttrs=function(e){return this.attrs=e,this},t.prototype.setStyles=function(e){return this.styles=e,this},t.prototype.draw=function(e){this.drawImp(e,this.attrs,this.styles)},t.extend=function(e){var r=function(a){V(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.checkEventOnImp=function(o,s,l){return e.checkEventOn(o,s,l)},n.prototype.drawImp=function(o,s,l){e.draw(o,s,l)},n}(t);return r},t}(Ae);function qi(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var a=e[r].coordinates;if(a.length>1)for(var n=1;n<a.length;n++){var o=a[n-1],s=a[n];if(o.x===s.x){if(Math.abs(o.y-i.y)+Math.abs(s.y-i.y)-Math.abs(o.y-s.y)<Q+Q&&Math.abs(i.x-o.x)<Q)return!0}else{var l=ke(o,s),u=ur(l,i),c=Math.abs(u-i.y);if(Math.abs(o.x-i.x)+Math.abs(s.x-i.x)-Math.abs(o.x-s.x)<Q+Q&&c*c/(l[0]*l[0]+1)<Q*Q)return!0}}}return!1}function ur(i,t){return i!==null?t.x*i[0]+i[1]:t.y}function de(i,t,e){var r=ke(i,t);return ur(r,e)}function ke(i,t){var e=i.x-t.x;if(e!==0){var r=(i.y-t.y)/e,a=i.y-r*i.x;return[r,a]}return null}function cr(i,t,e){var r=t.length,a=k(e)?e>0&&e<1?e:0:e?.5:0;if(a>0&&r>2){for(var n=t[0].x,o=t[0].y,s=1;s<r-1;s++){var l=t[s-1],u=t[s],c=t[s+1],h=u.x-l.x,d=u.y-l.y,f=c.x-u.x,v=c.y-u.y,g=c.x-l.x,p=c.y-l.y,m=Math.sqrt(h*h+d*d),_=Math.sqrt(f*f+v*v),S=_/(_+m),y=u.x+g*a*S,x=u.y+p*a*S;y=Math.min(y,Math.max(c.x,u.x)),x=Math.min(x,Math.max(c.y,u.y)),y=Math.max(y,Math.min(c.x,u.x)),x=Math.max(x,Math.min(c.y,u.y)),g=y-u.x,p=x-u.y;var C=u.x-g*m/_,b=u.y-p*m/_;C=Math.min(C,Math.max(l.x,u.x)),b=Math.min(b,Math.max(l.y,u.y)),C=Math.max(C,Math.min(l.x,u.x)),b=Math.max(b,Math.min(l.y,u.y)),g=u.x-C,p=u.y-b,y=u.x+g*_/m,x=u.y+p*_/m,i.bezierCurveTo(n,o,C,b,u.x,u.y),n=y,o=x}var E=t[r-1];i.bezierCurveTo(n,o,E.x,E.y,E.x,E.y)}else for(var s=1;s<r;s++)i.lineTo(t[s].x,t[s].y)}function Ki(i,t,e){var r=[];r=r.concat(t);var a=e.style,n=a===void 0?N.Solid:a,o=e.smooth,s=o===void 0?!1:o,l=e.size,u=l===void 0?1:l,c=e.color,h=c===void 0?"currentColor":c,d=e.dashedValue,f=d===void 0?[2,2]:d;i.lineWidth=u,i.strokeStyle=h,n===N.Dashed?i.setLineDash(f):i.setLineDash([]);var v=u%2===1?.5:0;r.forEach(function(g){var p=g.coordinates;p.length>1&&(p.length===2&&(p[0].x===p[1].x||p[0].y===p[1].y)?(i.beginPath(),p[0].x===p[1].x?(i.moveTo(p[0].x+v,p[0].y),i.lineTo(p[1].x+v,p[1].y)):(i.moveTo(p[0].x,p[0].y+v),i.lineTo(p[1].x,p[1].y+v)),i.stroke(),i.closePath()):(i.save(),u%2===1&&i.translate(.5,.5),i.beginPath(),i.moveTo(p[0].x,p[0].y),cr(i,p,s),i.stroke(),i.closePath(),i.restore()))})}var $i={name:"line",checkEventOn:qi,draw:function(i,t,e){Ki(i,t,e)}};function hr(i,t,e){var r=e??0,a=[];if(i.length>1)if(i[0].x===i[1].x){var n=0,o=t.height;if(a.push({coordinates:[{x:i[0].x,y:n},{x:i[0].x,y:o}]}),i.length>2){a.push({coordinates:[{x:i[2].x,y:n},{x:i[2].x,y:o}]});for(var s=i[0].x-i[2].x,l=0;l<r;l++){var u=s*(l+1);a.push({coordinates:[{x:i[0].x+u,y:n},{x:i[0].x+u,y:o}]})}}}else{var c=0,h=t.width,d=ke(i[0],i[1]),f=d[0],v=d[1];if(a.push({coordinates:[{x:c,y:c*f+v},{x:h,y:h*f+v}]}),i.length>2){var g=i[2].y-f*i[2].x;a.push({coordinates:[{x:c,y:c*f+g},{x:h,y:h*f+g}]});for(var s=v-g,l=0;l<r;l++){var p=v+s*(l+1);a.push({coordinates:[{x:c,y:c*f+p},{x:h,y:h*f+p}]})}}}return a}var Qi={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:hr(t,e)}]}},Ji={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:hr(t,e,1)}]}},ta={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t,e=i.coordinates,r=i.bounding,a=i.precision,n=i.overlay,o=i.thousandsSeparator,s=i.decimalFoldThreshold,l=i.yAxis,u=n.points[0].value,c=u===void 0?0:u,h=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?a.price:a.excludePriceVolumeMax;return[{type:"line",attrs:{coordinates:[e[0],{x:r.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:J($(c.toFixed(h),o),s),baseline:"bottom"}}]}};function ea(i,t){if(i.length>1){var e=void 0;return i[0].x===i[1].x&&i[0].y!==i[1].y?i[0].y<i[1].y?e={x:i[0].x,y:t.height}:e={x:i[0].x,y:0}:i[0].x>i[1].x?e={x:0,y:de(i[0],i[1],{x:0,y:i[0].y})}:e={x:t.width,y:de(i[0],i[1],{x:t.width,y:i[0].y})},{coordinates:[i[0],e]}}return[]}var ra={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:ea(t,e)}]}},ia={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]}},aa={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return t.length===2?t[0].x===t[1].x?[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:de(t[0],t[1],{x:0,y:t[0].y})},{x:e.width,y:de(t[0],t[1],{x:e.width,y:t[0].y})}]}}]:[]}},na={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;if(t.length===2){var r={x:t[0].x,y:0};return t[0].y<t[1].y&&(r.y=e.height),[{type:"line",attrs:{coordinates:[t[0],r]}}]}return[]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].timestamp=r.timestamp,e[0].dataIndex=r.dataIndex)}},oa={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].timestamp=r.timestamp,e[0].dataIndex=r.dataIndex)}},sa={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]}},la={name:"simpleAnnotation",totalStep:2,styles:{line:{style:N.Dashed}},createPointFigures:function(i){var t,e=i.overlay,r=i.coordinates,a;P(e.extendData)&&(Et(e.extendData)?a=e.extendData(e):a=(t=e.extendData)!==null&&t!==void 0?t:"");var n=r[0].x,o=r[0].y-6,s=o-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:n,y:o},{x:n,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:n,y:s},{x:n-4,y:l},{x:n+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:n,y:l,text:a??"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},ua={name:"simpleTag",totalStep:2,styles:{line:{style:N.Dashed}},createPointFigures:function(i){var t=i.bounding,e=i.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(i){var t,e,r=i.overlay,a=i.coordinates,n=i.bounding,o=i.yAxis,s=i.precision,l=(t=o==null?void 0:o.isFromZero())!==null&&t!==void 0?t:!1,u,c;l?(u="left",c=0):(u="right",c=n.width);var h;return P(r.extendData)&&(Et(r.extendData)?h=r.extendData(r):h=(e=r.extendData)!==null&&e!==void 0?e:""),!P(h)&&k(r.points[0].value)&&(h=U(r.points[0].value,s.price)),{type:"text",attrs:{x:c,y:a[0].y,text:h??"",align:u,baseline:"middle"}}}},vr={},ca=[Hi,Gi,ji,Zi,Qi,Ji,ta,ra,ia,aa,na,oa,sa,la,ua];ca.forEach(function(i){vr[i.name]=ii.extend(i)});function ha(i){var t;return(t=vr[i])!==null&&t!==void 0?t:null}var va=30,da=100,z={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},fa=function(){function i(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return i.prototype._overrideInstance=function(t,e){var r=e.id,a=e.groupId,n=e.points,o=e.styles,s=e.lock,l=e.visible,u=e.zLevel,c=e.mode,h=e.modeSensitivity,d=e.extendData,f=e.onDrawStart,v=e.onDrawing,g=e.onDrawEnd,p=e.onClick,m=e.onDoubleClick,_=e.onRightClick,S=e.onPressedMoveStart,y=e.onPressedMoving,x=e.onPressedMoveEnd,C=e.onMouseEnter,b=e.onMouseLeave,E=e.onRemoved,w=e.onSelected,I=e.onDeselected,M=!1,T=!1;return L(r)&&t.setId(r),L(a)&&t.setGroupId(a),pt(n)&&t.setPoints(n)&&(M=!0),P(o)&&t.setStyles(o)&&(M=!0),zt(s)&&t.setLock(s),zt(l)&&t.setVisible(l)&&(M=!0),k(u)&&t.setZLevel(u)&&(M=!0,T=!0),P(c)&&t.setMode(c),k(h)&&t.setModeSensitivity(h),d!==void 0&&t.setExtendData(d)&&(M=!0),f!==void 0&&t.setOnDrawStartCallback(f),v!==void 0&&t.setOnDrawingCallback(v),g!==void 0&&t.setOnDrawEndCallback(g),p!==void 0&&t.setOnClickCallback(p),m!==void 0&&t.setOnDoubleClickCallback(m),_!==void 0&&t.setOnRightClickCallback(_),S!==void 0&&t.setOnPressedMoveStartCallback(S),y!==void 0&&t.setOnPressedMovingCallback(y),x!==void 0&&t.setOnPressedMoveEndCallback(x),C!==void 0&&t.setOnMouseEnterCallback(C),b!==void 0&&t.setOnMouseLeaveCallback(b),E!==void 0&&t.setOnRemovedCallback(E),w!==void 0&&t.setOnSelectedCallback(w),I!==void 0&&t.setOnDeselectedCallback(I),[M,T]},i.prototype.getInstanceById=function(t){var e,r;try{for(var a=Xt(this._instances),n=a.next();!n.done;n=a.next()){var o=n.value,s=o[1],l=s.find(function(u){return u.id===t});if(P(l))return l}}catch(u){e={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},i.prototype._sort=function(t){var e;L(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(r,a){return r.zLevel-a.zLevel}):this._instances.forEach(function(r){r.sort(function(a,n){return a.zLevel-n.zLevel})})},i.prototype.addInstances=function(t,e,r){var a=this,n=t.map(function(s){var l,u,c,h,d=(l=s.id)!==null&&l!==void 0?l:or(ei);if(a.getInstanceById(d)===null){var f=ha(s.name);if(f!==null){var v=new f;v.setPaneId(e);var g=(u=s.groupId)!==null&&u!==void 0?u:d;return s.id=d,s.groupId=g,a._overrideInstance(v,s),v.isDrawing()?a._progressInstanceInfo={paneId:e,instance:v,appointPaneFlag:r}:(a._instances.has(e)||a._instances.set(e,[]),(c=a._instances.get(e))===null||c===void 0||c.push(v)),v.isStart()&&((h=v.onDrawStart)===null||h===void 0||h.call(v,{overlay:v})),d}}return null});if(n.some(function(s){return s!==null})){this._sort();var o=this._chartStore.getChart();o.updatePane(1,e),o.updatePane(1,z.X_AXIS)}return n},i.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},i.prototype.progressInstanceComplete=function(){var t;if(this._progressInstanceInfo!==null){var e=this._progressInstanceInfo,r=e.instance,a=e.paneId;r.isDrawing()||(this._instances.has(a)||this._instances.set(a,[]),(t=this._instances.get(a))===null||t===void 0||t.push(r),this._sort(a),this._progressInstanceInfo=null)}},i.prototype.updateProgressInstanceInfo=function(t,e){this._progressInstanceInfo!==null&&(zt(e)&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},i.prototype.getInstances=function(t){var e;if(!L(t)){var r=[];return this._instances.forEach(function(a){r=r.concat(a)}),r}return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},i.prototype.override=function(t){var e=this,r=t.id,a=t.groupId,n=t.name,o=!1,s=!1,l=function(f){var v=e._overrideInstance(f,t);v[0]&&(o=!0),v[1]&&(s=!0)};if(L(r)){var u=this.getInstanceById(r);u!==null&&l(u)}else{var c=L(n),h=L(a);if(this._instances.forEach(function(f){f.forEach(function(v){(c&&v.name===n||h&&v.groupId===a||!c&&!h)&&l(v)})}),this._progressInstanceInfo!==null){var d=this._progressInstanceInfo.instance;(c&&d.name===n||h&&d.groupId===a||!c&&!h)&&l(d)}}s&&this._sort(),o&&this._chartStore.getChart().updatePane(1)},i.prototype.removeInstance=function(t){var e,r,a,n=function(g,p){if(L(g.id)){if(p.id!==g.id)return!1}else if(L(g.groupId)){if(p.groupId!==g.groupId)return!1}else if(L(g.name)&&p.name!==g.name)return!1;return!0},o=[],s=P(t);if(this._progressInstanceInfo!==null){var l=this._progressInstanceInfo.instance;(!s||s&&n(t,l))&&(o.push(this._progressInstanceInfo.paneId),(a=l.onRemoved)===null||a===void 0||a.call(l,{overlay:l}),this._progressInstanceInfo=null)}if(s){var u=new Map,c=function(g){var p=g[1],m=p.filter(function(_){var S;return n(t,_)?(o.includes(g[0])||o.push(g[0]),(S=_.onRemoved)===null||S===void 0||S.call(_,{overlay:_}),!1):!0});m.length>0&&u.set(g[0],m)};try{for(var h=Xt(this._instances),d=h.next();!d.done;d=h.next()){var f=d.value;c(f)}}catch(g){e={error:g}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}this._instances=u}else this._instances.forEach(function(g,p){o.push(p),g.forEach(function(m){var _;(_=m.onRemoved)===null||_===void 0||_.call(m,{overlay:m})})}),this._instances.clear();if(o.length>0){var v=this._chartStore.getChart();o.forEach(function(g){v.updatePane(1,g)}),v.updatePane(1,z.X_AXIS)}},i.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},i.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},i.prototype.updatePointPosition=function(t,e){if(t>0){var r=this._chartStore.getDataList();this._instances.forEach(function(a){a.forEach(function(n){var o=n.points;o.forEach(function(s){if(!P(s.timestamp)&&P(s.dataIndex)){e===ct.Forward&&(s.dataIndex=s.dataIndex+t);var l=r[s.dataIndex];s.timestamp=l==null?void 0:l.timestamp}})})})}},i.prototype.setHoverInstanceInfo=function(t,e){var r,a,n=this._hoverInstanceInfo,o=n.instance,s=n.figureType,l=n.figureKey,u=n.figureIndex;if(((o==null?void 0:o.id)!==((r=t.instance)===null||r===void 0?void 0:r.id)||s!==t.figureType||u!==t.figureIndex)&&(this._hoverInstanceInfo=t,(o==null?void 0:o.id)!==((a=t.instance)===null||a===void 0?void 0:a.id))){var c=!1,h=!1;o!==null&&(h=!0,Et(o.onMouseLeave)&&(o.onMouseLeave(F({overlay:o,figureKey:l,figureIndex:u},e)),c=!0)),t.instance!==null&&(h=!0,t.instance.setZLevel(ri),Et(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(F({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),c=!0)),h&&this._sort(),c||this._chartStore.getChart().updatePane(1)}},i.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},i.prototype.setClickInstanceInfo=function(t,e){var r,a,n,o,s,l,u,c,h,d=this._clickInstanceInfo,f=d.paneId,v=d.instance,g=d.figureType,p=d.figureKey,m=d.figureIndex;if((a=(r=t.instance)===null||r===void 0?void 0:r.isDrawing())!==null&&a!==void 0&&a||(o=(n=t.instance)===null||n===void 0?void 0:n.onClick)===null||o===void 0||o.call(n,F({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((v==null?void 0:v.id)!==((s=t.instance)===null||s===void 0?void 0:s.id)||g!==t.figureType||m!==t.figureIndex)&&(this._clickInstanceInfo=t,(v==null?void 0:v.id)!==((l=t.instance)===null||l===void 0?void 0:l.id))){(u=v==null?void 0:v.onDeselected)===null||u===void 0||u.call(v,F({overlay:v,figureKey:p,figureIndex:m},e)),(h=(c=t.instance)===null||c===void 0?void 0:c.onSelected)===null||h===void 0||h.call(c,F({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var _=this._chartStore.getChart();_.updatePane(1,t.paneId),f!==t.paneId&&_.updatePane(1,f),_.updatePane(1,z.X_AXIS)}},i.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},i.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},i.prototype.isDrawing=function(){var t,e;return this._progressInstanceInfo!==null&&((e=(t=this._progressInstanceInfo)===null||t===void 0?void 0:t.instance.isDrawing())!==null&&e!==void 0?e:!1)},i}(),ga=function(){function i(){this._actions=new Map}return i.prototype.execute=function(t,e){var r;(r=this._actions.get(t))===null||r===void 0||r.execute(e)},i.prototype.subscribe=function(t,e){var r;this._actions.has(t)||this._actions.set(t,new Jr),(r=this._actions.get(t))===null||r===void 0||r.subscribe(e)},i.prototype.unsubscribe=function(t,e){var r=this._actions.get(t);P(r)&&(r.unsubscribe(e),r.isEmpty()&&this._actions.delete(t))},i.prototype.has=function(t){var e=this._actions.get(t);return P(e)&&!e.isEmpty()},i}(),pa={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},ma={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},_a={light:pa,dark:ma};function dr(i){var t;return(t=_a[i])!==null&&t!==void 0?t:null}var ya=function(){function i(t,e){this._styles=Ur(),this._customApi=ai(),this._locale=ni,this._precision={price:2,volume:0},this._thousandsSeparator=",",this._decimalFoldThreshold=3,this._dataList=[],this._loadMoreCallback=null,this._loadDataCallback=null,this._loading=!0,this._forwardMore=!0,this._backwardMore=!0,this._timeScaleStore=new hi(this),this._indicatorStore=new Xi(this),this._overlayStore=new fa(this),this._tooltipStore=new Yi(this),this._actionStore=new ga,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return i.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.realFrom,r=t.realTo,a=e;a<r;a++){var n=this._dataList[a],o=this._timeScaleStore.dataIndexToCoordinate(a);this._visibleDataList.push({dataIndex:a,x:o,data:n})}},i.prototype.setOptions=function(t){var e,r,a,n;if(P(t)){var o=t.locale,s=t.timezone,l=t.styles,u=t.customApi,c=t.thousandsSeparator,h=t.decimalFoldThreshold;if(L(o)&&(this._locale=o),L(s)&&this._timeScaleStore.setTimezone(s),P(l)){var d=null;L(l)?d=dr(l):d=l,vt(this._styles,d),pt((r=(e=d==null?void 0:d.candle)===null||e===void 0?void 0:e.tooltip)===null||r===void 0?void 0:r.custom)&&(this._styles.candle.tooltip.custom=(n=(a=d==null?void 0:d.candle)===null||a===void 0?void 0:a.tooltip)===null||n===void 0?void 0:n.custom)}P(u)&&vt(this._customApi,u),L(c)&&(this._thousandsSeparator=c),k(h)&&h>0&&(this._decimalFoldThreshold=h)}return this},i.prototype.getStyles=function(){return this._styles},i.prototype.getLocale=function(){return this._locale},i.prototype.getCustomApi=function(){return this._customApi},i.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},i.prototype.getDecimalFoldThreshold=function(){return this._decimalFoldThreshold},i.prototype.getPrecision=function(){return this._precision},i.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.synchronizeSeriesPrecision(),this},i.prototype.getDataList=function(){return this._dataList},i.prototype.getVisibleFirstData=function(){var t,e=this._timeScaleStore.getVisibleRange().from;return(t=this._dataList[e])!==null&&t!==void 0?t:null},i.prototype.getVisibleDataList=function(){return this._visibleDataList},i.prototype.addData=function(t,e,r){return Zt(this,void 0,void 0,function(){var a,n,o,s,l,u,c;return Ut(this,function(h){switch(h.label){case 0:if(a=!1,n=!1,o=0,pt(t)){switch(o=t.length,e){case ct.Init:{this.clear(),this._dataList=t,this._forwardMore=r??!0,this._timeScaleStore.resetOffsetRightDistance(),n=!0;break}case ct.Backward:{this._dataList=this._dataList.concat(t),this._backwardMore=r??!1,n=o>0;break}case ct.Forward:this._dataList=t.concat(this._dataList),this._forwardMore=r??!1,n=o>0}this._loading=!1,a=!0}else s=this._dataList.length,l=t.timestamp,u=et(this._dataList[s-1],"timestamp",0),l>u?(this._dataList.push(t),c=this._timeScaleStore.getLastBarRightSideDiffBarCount(),c<0&&this._timeScaleStore.setLastBarRightSideDiffBarCount(--c),o=1,a=!0,n=!0):l===u&&(this._dataList[s-1]=t,a=!0,n=!0);if(!a)return[3,5];h.label=1;case 1:return h.trys.push([1,4,,5]),this._overlayStore.updatePointPosition(o,e),n?(this._timeScaleStore.adjustVisibleRange(),this._tooltipStore.recalculateCrosshair(!0),[4,this._indicatorStore.calcInstance()]):[3,3];case 2:h.sent(),this._chart.adjustPaneViewport(!1,!0,!0,!0),h.label=3;case 3:return this._actionStore.execute(ht.OnDataReady),[3,5];case 4:return h.sent(),[3,5];case 5:return[2]}})})},i.prototype.setLoadMoreCallback=function(t){this._loadMoreCallback=t},i.prototype.executeLoadMoreCallback=function(t){this._forwardMore&&!this._loading&&P(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(t))},i.prototype.setLoadDataCallback=function(t){this._loadDataCallback=t},i.prototype.executeLoadDataCallback=function(t){var e=this;if(!this._loading&&P(this._loadDataCallback)&&(this._forwardMore&&t.type===ct.Forward||this._backwardMore&&t.type===ct.Backward)){var r=function(a,n){e.addData(a,t.type,n).then(function(){}).catch(function(){})};this._loading=!0,this._loadDataCallback(F(F({},t),{callback:r}))}},i.prototype.clear=function(){this._forwardMore=!0,this._backwardMore=!0,this._loading=!0,this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},i.prototype.getTimeScaleStore=function(){return this._timeScaleStore},i.prototype.getIndicatorStore=function(){return this._indicatorStore},i.prototype.getOverlayStore=function(){return this._overlayStore},i.prototype.getTooltipStore=function(){return this._tooltipStore},i.prototype.getActionStore=function(){return this._actionStore},i.prototype.getChart=function(){return this._chart},i}(),O={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},ne=7;function Sa(){return Zt(this,void 0,void 0,function(){return Ut(this,function(i){switch(i.label){case 0:return[4,new Promise(function(t){var e=new ResizeObserver(function(r){t(r.every(function(a){return"devicePixelContentBoxSize"in a})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})];case 1:return[2,i.sent()]}})})}var $e=function(){function i(t,e){var r=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=Se,this._mediaQueryListener=function(){var a=Ft(r._element);r._nextPixelWidth=Math.round(r._element.clientWidth*a),r._nextPixelHeight=Math.round(r._element.clientHeight*a),r._resetPixelRatio()},this._listener=e,this._element=It("canvas",t),this._ctx=this._element.getContext("2d",{willReadFrequently:!0}),Sa().then(function(a){r._supportedDevicePixelContentBox=a,a?(r._resizeObserver=new ResizeObserver(function(n){var o,s=n.find(function(u){return u.target===r._element}),l=(o=s==null?void 0:s.devicePixelContentBoxSize)===null||o===void 0?void 0:o[0];P(l)&&(r._nextPixelWidth=l.inlineSize,r._nextPixelHeight=l.blockSize,(r._pixelWidth!==r._nextPixelWidth||r._pixelHeight!==r._nextPixelHeight)&&r._resetPixelRatio())}),r._resizeObserver.observe(r._element,{box:"device-pixel-content-box"})):(r._mediaQueryList=window.matchMedia("(resolution: ".concat(Ft(r._element),"dppx)")),r._mediaQueryList.addListener(r._mediaQueryListener))}).catch(function(a){return!1})}return i.prototype._resetPixelRatio=function(){var t=this;this._executeListener(function(){var e=t._element.clientWidth,r=t._element.clientHeight,a=t._nextPixelWidth/e,n=t._nextPixelHeight/r;t._width=e,t._height=r,t._pixelWidth=t._nextPixelWidth,t._pixelHeight=t._nextPixelHeight,t._element.width=t._nextPixelWidth,t._element.height=t._nextPixelHeight,t._ctx.scale(a,n)})},i.prototype._executeListener=function(t){var e=this;this._requestAnimationId===Se&&(this._requestAnimationId=ve(function(){e._ctx.clearRect(0,0,e._width,e._height),t==null||t(),e._listener(),e._requestAnimationId=Se}))},i.prototype.update=function(t,e){if(this._width!==t||this._height!==e){if(this._element.style.width="".concat(t,"px"),this._element.style.height="".concat(e,"px"),!this._supportedDevicePixelContentBox){var r=Ft(this._element);this._nextPixelWidth=Math.round(t*r),this._nextPixelHeight=Math.round(e*r),this._resetPixelRatio()}}else this._executeListener()},i.prototype.getElement=function(){return this._element},i.prototype.getContext=function(){return this._ctx},i.prototype.destroy=function(){var t,e;(t=this._resizeObserver)===null||t===void 0||t.unobserve(this._element),(e=this._mediaQueryList)===null||e===void 0||e.removeListener(this._mediaQueryListener)},i}();function fr(i){var t={width:0,height:0,left:0,right:0,top:0,bottom:0};return P(i)&&vt(t,i),t}var gr=function(i){V(t,i);function t(e,r){var a=i.call(this)||this;return a._bounding=fr(),a._pane=r,a.init(e),a}return t.prototype.init=function(e){this._rootContainer=e,this._container=this.createContainer(),e.appendChild(this._container)},t.prototype.setBounding=function(e){return vt(this._bounding,e),this},t.prototype.getContainer=function(){return this._container},t.prototype.getBounding=function(){return this._bounding},t.prototype.getPane=function(){return this._pane},t.prototype.update=function(e){this.updateImp(this._container,this._bounding,e??3)},t.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},t}(Ae),Fe=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.init=function(e){var r=this;i.prototype.init.call(this,e),this._mainCanvas=new $e({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){r.updateMain(r._mainCanvas.getContext())}),this._overlayCanvas=new $e({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){r.updateOverlay(r._overlayCanvas.getContext())});var a=this.getContainer();a.appendChild(this._mainCanvas.getElement()),a.appendChild(this._overlayCanvas.getElement())},t.prototype.createContainer=function(){return It("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},t.prototype.updateImp=function(e,r,a){var n=r.width,o=r.height,s=r.left;e.style.left="".concat(s,"px");var l=a,u=e.clientWidth,c=e.clientHeight;switch((n!==u||o!==c)&&(e.style.width="".concat(n,"px"),e.style.height="".concat(o,"px"),l=3),l){case 0:{this._mainCanvas.update(n,o);break}case 1:{this._overlayCanvas.update(n,o);break}case 3:case 4:{this._mainCanvas.update(n,o),this._overlayCanvas.update(n,o);break}}},t.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},t.prototype.getImage=function(e){var r=this.getBounding(),a=r.width,n=r.height,o=It("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=Ft(o);return o.width=a*l,o.height=n*l,s.scale(l,l),s.drawImage(this._mainCanvas.getElement(),0,0,a,n),e&&s.drawImage(this._overlayCanvas.getElement(),0,0,a,n),o},t}(gr);function Qt(i){return i==="transparent"||i==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(i)||/^[hH][Ss][Ll][Aa]\(([\s]*(3603[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(i)}function xa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var a=e[r],n=a.x,o=a.y,s=a.r,l=i.x-n,u=i.y-o;if(!(l*l+u*u>s*s))return!0}return!1}function ba(i,t,e){var r=[];r=r.concat(t);var a=e.style,n=a===void 0?W.Fill:a,o=e.color,s=o===void 0?"currentColor":o,l=e.borderSize,u=l===void 0?1:l,c=e.borderColor,h=c===void 0?"currentColor":c,d=e.borderStyle,f=d===void 0?N.Solid:d,v=e.borderDashedValue,g=v===void 0?[2,2]:v,p=(n===W.Fill||e.style===W.StrokeFill)&&(!L(s)||!Qt(s));p&&(i.fillStyle=s,r.forEach(function(m){var _=m.x,S=m.y,y=m.r;i.beginPath(),i.arc(_,S,y,0,Math.PI*2),i.closePath(),i.fill()})),(n===W.Stroke||e.style===W.StrokeFill)&&u>0&&!Qt(h)&&(i.strokeStyle=h,i.lineWidth=u,f===N.Dashed?i.setLineDash(g):i.setLineDash([]),r.forEach(function(m){var _=m.x,S=m.y,y=m.r;(!p||y>u)&&(i.beginPath(),i.arc(_,S,y,0,Math.PI*2),i.closePath(),i.stroke())}))}var Ca={name:"circle",checkEventOn:xa,draw:function(i,t,e){ba(i,t,e)}};function wa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){for(var a=!1,n=e[r].coordinates,o=0,s=n.length-1;o<n.length;s=o++)n[o].y>i.y!=n[s].y>i.y&&i.x<(n[s].x-n[o].x)*(i.y-n[o].y)/(n[s].y-n[o].y)+n[o].x&&(a=!a);if(a)return!0}return!1}function Ea(i,t,e){var r=[];r=r.concat(t);var a=e.style,n=a===void 0?W.Fill:a,o=e.color,s=o===void 0?"currentColor":o,l=e.borderSize,u=l===void 0?1:l,c=e.borderColor,h=c===void 0?"currentColor":c,d=e.borderStyle,f=d===void 0?N.Solid:d,v=e.borderDashedValue,g=v===void 0?[2,2]:v;(n===W.Fill||e.style===W.StrokeFill)&&(!L(s)||!Qt(s))&&(i.fillStyle=s,r.forEach(function(p){var m=p.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.fill()})),(n===W.Stroke||e.style===W.StrokeFill)&&u>0&&!Qt(h)&&(i.strokeStyle=h,i.lineWidth=u,f===N.Dashed?i.setLineDash(g):i.setLineDash([]),r.forEach(function(p){var m=p.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.stroke()}))}var Ia={name:"polygon",checkEventOn:wa,draw:function(i,t,e){Ea(i,t,e)}};function Pa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var a=e[r],n=a.x,o=a.width;o<Q*2&&(n-=Q,o=Q*2);var s=a.y,l=a.height;if(l<Q*2&&(s-=Q,l=Q*2),i.x>=n&&i.x<=n+o&&i.y>=s&&i.y<=s+l)return!0}return!1}function pr(i,t,e){var r,a=[];a=a.concat(t);var n=e.style,o=n===void 0?W.Fill:n,s=e.color,l=s===void 0?"transparent":s,u=e.borderSize,c=u===void 0?1:u,h=e.borderColor,d=h===void 0?"transparent":h,f=e.borderStyle,v=f===void 0?N.Solid:f,g=e.borderRadius,p=g===void 0?0:g,m=e.borderDashedValue,_=m===void 0?[2,2]:m,S=(r=i.roundRect)!==null&&r!==void 0?r:i.rect,y=(o===W.Fill||e.style===W.StrokeFill)&&(!L(l)||!Qt(l));if(y&&(i.fillStyle=l,a.forEach(function(b){var E=b.x,w=b.y,I=b.width,M=b.height;i.beginPath(),S.call(i,E,w,I,M,p),i.closePath(),i.fill()})),(o===W.Stroke||e.style===W.StrokeFill)&&c>0&&!Qt(d)){i.strokeStyle=d,i.fillStyle=d,i.lineWidth=c,v===N.Dashed?i.setLineDash(_):i.setLineDash([]);var x=c%2===1?.5:0,C=Math.round(x*2);a.forEach(function(b){var E=b.x,w=b.y,I=b.width,M=b.height;I>c*2&&M>c*2?(i.beginPath(),S.call(i,E+x,w+x,I-C,M-C,p),i.closePath(),i.stroke()):y||i.fillRect(E,w,I,M)})}}var Ma={name:"rect",checkEventOn:Pa,draw:function(i,t,e){pr(i,t,e)}};function mr(i,t){var e=t.size,r=e===void 0?12:e,a=t.paddingLeft,n=a===void 0?0:a,o=t.paddingTop,s=o===void 0?0:o,l=t.paddingRight,u=l===void 0?0:l,c=t.paddingBottom,h=c===void 0?0:c,d=t.weight,f=d===void 0?"normal":d,v=t.family,g=i.x,p=i.y,m=i.text,_=i.align,S=_===void 0?"left":_,y=i.baseline,x=y===void 0?"top":y,C=i.width,b=i.height,E=C??n+he(m,r,f,v)+u,w=b??s+r+h,I;switch(S){case"left":case"start":{I=g;break}case"right":case"end":{I=g-E;break}default:{I=g-E/2;break}}var M;switch(x){case"top":case"hanging":{M=p;break}case"bottom":case"ideographic":case"alphabetic":{M=p-w;break}default:{M=p-w/2;break}}return{x:I,y:M,width:E,height:w}}function Ta(i,t,e){var r=[];r=r.concat(t);for(var a=0;a<r.length;a++){var n=mr(r[a],e),o=n.x,s=n.y,l=n.width,u=n.height;if(i.x>=o&&i.x<=o+l&&i.y>=s&&i.y<=s+u)return!0}return!1}function Da(i,t,e){var r=[];r=r.concat(t);var a=e.color,n=a===void 0?"currentColor":a,o=e.size,s=o===void 0?12:o,l=e.family,u=e.weight,c=e.paddingLeft,h=c===void 0?0:c,d=e.paddingTop,f=d===void 0?0:d,v=e.paddingRight,g=v===void 0?0:v,p=r.map(function(m){return mr(m,e)});pr(i,p,F(F({},e),{color:e.backgroundColor})),i.textAlign="left",i.textBaseline="top",i.font=Yt(s,u,l),i.fillStyle=n,r.forEach(function(m,_){var S=p[_];i.fillText(m.text,S.x+h,S.y+f,S.width-h-g)})}var _r={name:"text",checkEventOn:Ta,draw:function(i,t,e){Da(i,t,e)}},Aa=_r;function ka(i,t){var e=i.x-t.x,r=i.y-t.y;return Math.sqrt(e*e+r*r)}function Fa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var a=e[r];if(Math.abs(ka(i,a)-a.r)<Q){var n=a.r,o=a.startAngle,s=a.endAngle,l=n*Math.cos(o)+a.x,u=n*Math.sin(o)+a.y,c=n*Math.cos(s)+a.x,h=n*Math.sin(s)+a.y;if(i.x<=Math.max(l,c)+Q&&i.x>=Math.min(l,c)-Q&&i.y<=Math.max(u,h)+Q&&i.y>=Math.min(u,h)-Q)return!0}}return!1}function Ra(i,t,e){var r=[];r=r.concat(t);var a=e.style,n=a===void 0?N.Solid:a,o=e.size,s=o===void 0?1:o,l=e.color,u=l===void 0?"currentColor":l,c=e.dashedValue,h=c===void 0?[2,2]:c;i.lineWidth=s,i.strokeStyle=u,n===N.Dashed?i.setLineDash(h):i.setLineDash([]),r.forEach(function(d){var f=d.x,v=d.y,g=d.r,p=d.startAngle,m=d.endAngle;i.beginPath(),i.arc(f,v,g,p,m),i.stroke(),i.closePath()})}var Ba={name:"arc",checkEventOn:Fa,draw:function(i,t,e){Ra(i,t,e)}},yr={},La=[Ca,$i,Ia,Ma,_r,Aa,Ba];La.forEach(function(i){yr[i.name]=Ui.extend(i)});function Va(i){var t;return(t=yr[i])!==null&&t!==void 0?t:null}var bt=function(i){V(t,i);function t(e){var r=i.call(this)||this;return r._widget=e,r}return t.prototype.getWidget=function(){return this._widget},t.prototype.createFigure=function(e,r){var a=Va(e.name);if(a!==null){var n=new a(e);if(P(r)){for(var o in r)r.hasOwnProperty(o)&&n.registerEvent(o,r[o]);this.addChild(n)}return n}return null},t.prototype.draw=function(e){this.clear(),this.drawImp(e)},t}(Ae),Oa=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,a,n=this.getWidget(),o=this.getWidget().getPane(),s=o.getChart(),l=n.getBounding(),u=s.getStyles().grid,c=u.show;if(c){e.save(),e.globalCompositeOperation="destination-over";var h=u.horizontal,d=h.show;if(d){var f=o.getAxisComponent(),v=f.getTicks().map(function(_){return{coordinates:[{x:0,y:_.coord},{x:l.width,y:_.coord}]}});(r=this.createFigure({name:"line",attrs:v,styles:h}))===null||r===void 0||r.draw(e)}var g=u.vertical,p=g.show;if(p){var m=s.getXAxisPane().getAxisComponent(),v=m.getTicks().map(function(S){return{coordinates:[{x:S.coord,y:0},{x:S.coord,y:l.height}]}});(a=this.createFigure({name:"line",attrs:v,styles:g}))===null||a===void 0||a.draw(e)}e.restore()}},t}(bt),Re=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.eachChildren=function(e){var r=this.getWidget().getPane(),a=r.getChart().getChartStore(),n=a.getVisibleDataList(),o=a.getTimeScaleStore().getBarSpace();n.forEach(function(s,l){e(s,o,l)})},t}(bt),Sr=function(i){V(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._boundCandleBarClickEvent=function(r){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(ht.OnCandleBarClick,r),!1}},e}return t.prototype.drawImp=function(e){var r=this,a=this.getWidget().getPane(),n=a.getId()===z.CANDLE,o=a.getChart().getChartStore(),s=this.getCandleBarOptions(o);if(s!==null){var l=0,u=0;if(s.type===ut.Ohlc){var c=o.getTimeScaleStore().getBarSpace().gapBar;l=Math.min(Math.max(Math.round(c*.2),1),8),l>2&&l%2===1&&l--,u=Math.floor(u/2)}var h=a.getAxisComponent();this.eachChildren(function(d,f){var v=d.data,g=d.x;if(P(v)){var p=v.open,m=v.high,_=v.low,S=v.close,y=s.type,x=s.styles,C=[];S>p?(C[0]=x.upColor,C[1]=x.upBorderColor,C[2]=x.upWickColor):S<p?(C[0]=x.downColor,C[1]=x.downBorderColor,C[2]=x.downWickColor):(C[0]=x.noChangeColor,C[1]=x.noChangeBorderColor,C[2]=x.noChangeWickColor);var b=h.convertToPixel(p),E=h.convertToPixel(S),w=[b,E,h.convertToPixel(m),h.convertToPixel(_)];w.sort(function(M,T){return M-T});var I=[];switch(y){case ut.CandleSolid:{I=r._createSolidBar(g,w,f,C);break}case ut.CandleStroke:{I=r._createStrokeBar(g,w,f,C);break}case ut.CandleUpStroke:{S>p?I=r._createStrokeBar(g,w,f,C):I=r._createSolidBar(g,w,f,C);break}case ut.CandleDownStroke:{p>S?I=r._createStrokeBar(g,w,f,C):I=r._createSolidBar(g,w,f,C);break}case ut.Ohlc:{I=[{name:"rect",attrs:[{x:g-u,y:w[0],width:l,height:w[3]-w[0]},{x:g-f.halfGapBar,y:b+l>w[3]?w[3]-l:b,width:f.halfGapBar,height:l},{x:g+u,y:E+l>w[3]?w[3]-l:E,width:f.halfGapBar-u,height:l}],styles:{color:C[0]}}];break}}I.forEach(function(M){var T,D;n&&(D={mouseClickEvent:r._boundCandleBarClickEvent(d)}),(T=r.createFigure(M,D))===null||T===void 0||T.draw(e)})}})}},t.prototype.getCandleBarOptions=function(e){var r=e.getStyles().candle;return{type:r.type,styles:r.bar}},t.prototype._createSolidBar=function(e,r,a,n){return[{name:"rect",attrs:{x:e,y:r[0],width:1,height:r[3]-r[0]},styles:{color:n[2]}},{name:"rect",attrs:{x:e-a.halfGapBar,y:r[1],width:a.gapBar,height:Math.max(1,r[2]-r[1])},styles:{style:W.StrokeFill,color:n[0],borderColor:n[1]}}]},t.prototype._createStrokeBar=function(e,r,a,n){return[{name:"rect",attrs:[{x:e,y:r[0],width:1,height:r[1]-r[0]},{x:e,y:r[2],width:1,height:r[3]-r[2]}],styles:{color:n[2]}},{name:"rect",attrs:{x:e-a.halfGapBar,y:r[1],width:a.gapBar,height:Math.max(1,r[2]-r[1])},styles:{style:W.Stroke,borderColor:n[1]}}]},t}(Re),Na=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getCandleBarOptions=function(e){var r,a,n=this.getWidget().getPane(),o=n.getAxisComponent();if(!o.isInCandle()){var s=e.getIndicatorStore().getInstances(n.getId());try{for(var l=Xt(s),u=l.next();!u.done;u=l.next()){var c=u.value;if(c.shouldOhlc&&c.visible){var h=c.styles,d=e.getStyles().indicator,f=et(h,"ohlc.upColor",d.ohlc.upColor),v=et(h,"ohlc.downColor",d.ohlc.downColor),g=et(h,"ohlc.noChangeColor",d.ohlc.noChangeColor);return{type:ut.Ohlc,styles:{upColor:f,downColor:v,noChangeColor:g,upBorderColor:f,downBorderColor:v,noChangeBorderColor:g,upWickColor:f,downWickColor:v,noChangeWickColor:g}}}}}catch(p){r={error:p}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}}return null},t.prototype.drawImp=function(e){var r=this;i.prototype.drawImp.call(this,e);var a=this.getWidget(),n=a.getPane(),o=n.getChart(),s=a.getBounding(),l=o.getXAxisPane().getAxisComponent(),u=n.getAxisComponent(),c=o.getChartStore(),h=c.getDataList(),d=c.getTimeScaleStore(),f=d.getVisibleRange(),v=c.getIndicatorStore().getInstances(n.getId()),g=c.getStyles().indicator;e.save(),v.forEach(function(p){var m;if(p.visible){p.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";var _=!1;if(p.draw!==null&&(e.save(),_=(m=p.draw({ctx:e,kLineDataList:h,indicator:p,visibleRange:f,bounding:s,barSpace:d.getBarSpace(),defaultStyles:g,xAxis:l,yAxis:u}))!==null&&m!==void 0?m:!1,e.restore()),!_){var S=p.result,y=[];r.eachChildren(function(x,C){var b,E,w,I=C.halfGapBar,M=x.dataIndex,T=x.x,D=l.convertToPixel(M-1),A=l.convertToPixel(M+1),B=(b=S[M-1])!==null&&b!==void 0?b:null,R=(E=S[M])!==null&&E!==void 0?E:null,X=(w=S[M+1])!==null&&w!==void 0?w:null,j={x:D},rt={x:T},at={x:A};p.figures.forEach(function(Y){var H=Y.key,q=B==null?void 0:B[H];k(q)&&(j[H]=u.convertToPixel(q));var Z=R==null?void 0:R[H];k(Z)&&(rt[H]=u.convertToPixel(Z));var K=X==null?void 0:X[H];k(K)&&(at[H]=u.convertToPixel(K))}),Te(h,p,M,g,function(Y,H,q){var Z,K,G;if(P(R==null?void 0:R[Y.key])){var mt=rt[Y.key],dt=(Z=Y.attrs)===null||Z===void 0?void 0:Z.call(Y,{data:{prev:B,current:R,next:X},coordinate:{prev:j,current:rt,next:at},bounding:s,barSpace:C,xAxis:l,yAxis:u});if(!P(dt))switch(Y.type){case"circle":{dt={x:T,y:mt,r:Math.max(1,I)};break}case"rect":case"bar":{var Pt=(K=Y.baseValue)!==null&&K!==void 0?K:u.getRange().from,Mt=u.convertToPixel(Pt),Bt=Math.abs(Mt-mt);Pt!==(R==null?void 0:R[Y.key])&&(Bt=Math.max(1,Bt));var _t=void 0;mt>Mt?_t=Mt:_t=mt,dt={x:T-I,y:_t,width:Math.max(1,I*2),height:Bt};break}case"line":{P(y[q])||(y[q]=[]),k(rt[Y.key])&&k(at[Y.key])&&y[q].push({coordinates:[{x:rt.x,y:rt[Y.key]},{x:at.x,y:at[Y.key]}],styles:H});break}}var Gt=Y.type;P(dt)&&Gt!=="line"&&((G=r.createFigure({name:Gt==="bar"?"rect":Gt,attrs:dt,styles:H}))===null||G===void 0||G.draw(e))}})}),y.forEach(function(x){if(x.length>1){for(var C=[{coordinates:[x[0].coordinates[0],x[0].coordinates[1]],styles:x[0].styles}],b=1;b<x.length;b++){var E=C[C.length-1],w=x[b],I=E.coordinates[E.coordinates.length-1];I.x===w.coordinates[0].x&&I.y===w.coordinates[0].y&&E.styles.style===w.styles.style&&E.styles.color===w.styles.color&&E.styles.size===w.styles.size&&E.styles.smooth===w.styles.smooth&&E.styles.dashedValue[0]===w.styles.dashedValue[0]&&E.styles.dashedValue[1]===w.styles.dashedValue[1]?E.coordinates.push(w.coordinates[1]):C.push({coordinates:[w.coordinates[0],w.coordinates[1]],styles:w.styles})}C.forEach(function(M){var T,D=M.coordinates,A=M.styles;(T=r.createFigure({name:"line",attrs:{coordinates:D},styles:A}))===null||T===void 0||T.draw(e)})}})}}}),e.restore()},t}(Sr),Wa=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),a=r.getPane(),n=r.getBounding(),o=r.getPane().getChart().getChartStore(),s=o.getTooltipStore().getCrosshair(),l=o.getStyles().crosshair;if(L(s.paneId)&&l.show){if(s.paneId===a.getId()){var u=s.y;this._drawLine(e,[{x:0,y:u},{x:n.width,y:u}],l.horizontal)}var c=s.realX;this._drawLine(e,[{x:c,y:0},{x:c,y:n.height}],l.vertical)}},t.prototype._drawLine=function(e,r,a){var n;if(a.show){var o=a.line;o.show&&((n=this.createFigure({name:"line",attrs:{coordinates:r},styles:o}))===null||n===void 0||n.draw(e))}},t}(bt),xr=function(i){V(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._boundIconClickEvent=function(r){return function(){var a=e.getWidget().getPane();return a.getChart().getChartStore().getActionStore().execute(ht.OnTooltipIconClick,F({},r)),!0}},e._boundIconMouseMoveEvent=function(r){return function(){var a=e.getWidget().getPane(),n=a.getChart().getChartStore().getTooltipStore();return n.setActiveIcon(F({},r)),!0}},e}return t.prototype.drawImp=function(e){var r=this.getWidget(),a=r.getPane(),n=a.getChart().getChartStore(),o=n.getTooltipStore().getCrosshair();if(P(o.kLineData)){var s=r.getBounding(),l=n.getCustomApi(),u=n.getThousandsSeparator(),c=n.getDecimalFoldThreshold(),h=n.getIndicatorStore().getInstances(a.getId()),d=n.getTooltipStore().getActiveIcon(),f=n.getStyles().indicator,v=f.tooltip,g=v.offsetLeft,p=v.offsetTop,m=v.offsetRight;this.drawIndicatorTooltip(e,a.getId(),n.getDataList(),o,d,h,l,u,c,g,p,s.width-m,f)}},t.prototype.drawIndicatorTooltip=function(e,r,a,n,o,s,l,u,c,h,d,f,v){var g=this,p=v.tooltip;if(this.isDrawTooltip(n,p)){var m=p.text;s.forEach(function(_){var S=0,y={x:h,y:d},x=g.getIndicatorTooltipData(a,n,_,l,u,c,v),C=x.name,b=x.calcParamsText,E=x.values,w=x.icons,I=C.length>0,M=E.length>0;if(I||M){var T=Ht(g.classifyTooltipIcons(w),3),D=T[0],A=T[1],B=T[2];if(S=g.drawStandardTooltipIcons(e,o,D,y,r,_.name,h,S,f),I){var R=C;b.length>0&&(R="".concat(R).concat(b)),S=g.drawStandardTooltipLegends(e,[{title:{text:"",color:m.color},value:{text:R,color:m.color}}],y,h,S,f,m)}S=g.drawStandardTooltipIcons(e,o,A,y,r,_.name,h,S,f),M&&(S=g.drawStandardTooltipLegends(e,E,y,h,S,f,p.text)),S=g.drawStandardTooltipIcons(e,o,B,y,r,_.name,h,S,f),d=y.y+S}})}return d},t.prototype.drawStandardTooltipIcons=function(e,r,a,n,o,s,l,u,c){var h=this;if(a.length>0){var d=0,f=0;a.forEach(function(v){var g=v.marginLeft,p=g===void 0?0:g,m=v.marginTop,_=m===void 0?0:m,S=v.marginRight,y=S===void 0?0:S,x=v.marginBottom,C=x===void 0?0:x,b=v.paddingLeft,E=b===void 0?0:b,w=v.paddingTop,I=w===void 0?0:w,M=v.paddingRight,T=M===void 0?0:M,D=v.paddingBottom,A=D===void 0?0:D,B=v.size,R=v.fontFamily,X=v.icon;e.font=Yt(B,"normal",R),d+=p+E+e.measureText(X).width+T+y,f=Math.max(f,_+I+B+A+C)}),n.x+d>c?(n.x=l,n.y+=u,u=f):u=Math.max(u,f),a.forEach(function(v){var g,p=v.marginLeft,m=p===void 0?0:p,_=v.marginTop,S=_===void 0?0:_,y=v.marginRight,x=y===void 0?0:y,C=v.paddingLeft,b=C===void 0?0:C,E=v.paddingTop,w=E===void 0?0:E,I=v.paddingRight,M=I===void 0?0:I,T=v.paddingBottom,D=T===void 0?0:T,A=v.color,B=v.activeColor,R=v.size,X=v.fontFamily,j=v.icon,rt=v.backgroundColor,at=v.activeBackgroundColor,Y=(r==null?void 0:r.paneId)===o&&(r==null?void 0:r.indicatorName)===s&&(r==null?void 0:r.iconId)===v.id;(g=h.createFigure({name:"text",attrs:{text:j,x:n.x+m,y:n.y+S},styles:{paddingLeft:b,paddingTop:w,paddingRight:M,paddingBottom:D,color:Y?B:A,size:R,family:X,backgroundColor:Y?at:rt}},{mouseClickEvent:h._boundIconClickEvent({paneId:o,indicatorName:s,iconId:v.id}),mouseMoveEvent:h._boundIconMouseMoveEvent({paneId:o,indicatorName:s,iconId:v.id})}))===null||g===void 0||g.draw(e),n.x+=m+b+e.measureText(j).width+M+x})}return u},t.prototype.drawStandardTooltipLegends=function(e,r,a,n,o,s,l){var u=this;if(r.length>0){var c=l.marginLeft,h=l.marginTop,d=l.marginRight,f=l.marginBottom,v=l.size,g=l.family,p=l.weight;e.font=Yt(v,p,g),r.forEach(function(m){var _,S,y=m.title,x=m.value,C=e.measureText(y.text).width,b=e.measureText(x.text).width,E=C+b,w=h+v+f;a.x+c+E+d>s?(a.x=n,a.y+=o,o=w):o=Math.max(o,w),y.text.length>0&&((_=u.createFigure({name:"text",attrs:{x:a.x+c,y:a.y+h,text:y.text},styles:{color:y.color,size:v,family:g,weight:p}}))===null||_===void 0||_.draw(e)),(S=u.createFigure({name:"text",attrs:{x:a.x+c+C,y:a.y+h,text:x.text},styles:{color:x.color,size:v,family:g,weight:p}}))===null||S===void 0||S.draw(e),a.x+=c+E+d})}return o},t.prototype.isDrawTooltip=function(e,r){var a=r.showRule;return a===$t.Always||a===$t.FollowCross&&L(e.paneId)},t.prototype.getIndicatorTooltipData=function(e,r,a,n,o,s,l){var u,c,h=l.tooltip,d=h.showName?a.shortName:"",f="",v=a.calcParams;v.length>0&&h.showParams&&(f="(".concat(v.join(","),")"));var g={name:d,calcParamsText:f,values:[],icons:h.icons},p=r.dataIndex,m=(u=a.result)!==null&&u!==void 0?u:[],_=[];if(a.visible){var S=(c=m[p])!==null&&c!==void 0?c:{};Te(e,a,p,l,function(A,B){if(L(A.title)){var R=B.color,X=S[A.key];k(X)&&(X=U(X,a.precision),a.shouldFormatBigNumber&&(X=n.formatBigNumber(X))),_.push({title:{text:A.title,color:R},value:{text:J($(X??h.defaultValue,o),s),color:R}})}}),g.values=_}if(a.createTooltipDataSource!==null){var y=this.getWidget(),x=y.getPane(),C=x.getChart().getChartStore(),b=a.createTooltipDataSource({kLineDataList:e,indicator:a,visibleRange:C.getTimeScaleStore().getVisibleRange(),bounding:y.getBounding(),crosshair:r,defaultStyles:l,xAxis:x.getChart().getXAxisPane().getAxisComponent(),yAxis:x.getAxisComponent()}),E=b.name,w=b.calcParamsText,I=b.values,M=b.icons;if(L(E)&&h.showName&&(g.name=E),L(w)&&h.showParams&&(g.calcParamsText=w),P(M)&&(g.icons=M),P(I)&&a.visible){var T=[],D=l.tooltip.text.color;I.forEach(function(A){var B={text:"",color:D};xt(A.title)?B=A.title:B.text=A.title;var R={text:"",color:D};xt(A.value)?R=A.value:R.text=A.value,R.text=J($(R.text,o),s),T.push({title:B,value:R})}),g.values=T}}return g},t.prototype.classifyTooltipIcons=function(e){var r=[],a=[],n=[];return e.forEach(function(o){switch(o.position){case ae.Left:{r.push(o);break}case ae.Middle:{a.push(o);break}case ae.Right:{n.push(o);break}}}),[r,a,n]},t}(bt),br=function(i){V(t,i);function t(e){var r=i.call(this,e)||this;return r._initEvent(),r}return t.prototype._initEvent=function(){var e=this,r=this.getWidget().getPane(),a=r.getId(),n=r.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(o){var s,l=n.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;u.isStart()&&(n.updateProgressInstanceInfo(a),c=a);var h=u.points.length-1,d="".concat(jt,"point_").concat(h);return u.isDrawing()&&c===a&&(u.eventMoveForDrawing(e._coordinateToPoint(l.instance,o)),(s=u.onDrawing)===null||s===void 0||s.call(u,F({overlay:u,figureKey:d,figureIndex:h},o))),e._figureMouseMoveEvent(u,1,d,h,0)(o)}return n.setHoverInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseClickEvent",function(o){var s,l,u=n.getProgressInstanceInfo();if(u!==null){var c=u.instance,h=u.paneId;c.isStart()&&(n.updateProgressInstanceInfo(a,!0),h=a);var d=c.points.length-1,f="".concat(jt,"point_").concat(d);return c.isDrawing()&&h===a&&(c.eventMoveForDrawing(e._coordinateToPoint(c,o)),(s=c.onDrawing)===null||s===void 0||s.call(c,F({overlay:c,figureKey:f,figureIndex:d},o)),c.nextStep(),c.isDrawing()||(n.progressInstanceComplete(),(l=c.onDrawEnd)===null||l===void 0||l.call(c,F({overlay:c,figureKey:f,figureIndex:d},o)))),e._figureMouseClickEvent(c,1,f,d,0)(o)}return n.setClickInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseDoubleClickEvent",function(o){var s,l=n.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;if(u.isDrawing()&&c===a&&(u.forceComplete(),!u.isDrawing())){n.progressInstanceComplete();var h=u.points.length-1,d="".concat(jt,"point_").concat(h);(s=u.onDrawEnd)===null||s===void 0||s.call(u,F({overlay:u,figureKey:d,figureIndex:h},o))}var f=u.points.length-1;return e._figureMouseClickEvent(u,1,"".concat(jt,"point_").concat(f),f,0)(o)}return!1}).registerEvent("mouseRightClickEvent",function(o){var s=n.getProgressInstanceInfo();if(s!==null){var l=s.instance;if(l.isDrawing()){var u=l.points.length-1;return e._figureMouseRightClickEvent(l,1,"".concat(jt,"point_").concat(u),u,0)(o)}}return!1}).registerEvent("mouseUpEvent",function(o){var s,l=n.getPressedInstanceInfo(),u=l.instance,c=l.figureIndex,h=l.figureKey;return u!==null&&((s=u.onPressedMoveEnd)===null||s===void 0||s.call(u,F({overlay:u,figureKey:h,figureIndex:c},o))),n.setPressedInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(o){var s,l,u=n.getPressedInstanceInfo(),c=u.instance,h=u.figureType,d=u.figureIndex,f=u.figureKey;if(c!==null){if(!c.lock&&!((l=(s=c.onPressedMoving)===null||s===void 0?void 0:s.call(c,F({overlay:c,figureIndex:d,figureKey:f},o)))!==null&&l!==void 0&&l)){var v=e._coordinateToPoint(c,o);h===1?c.eventPressedPointMove(v,d):c.eventPressedOtherMove(v,e.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},t.prototype._createFigureEvents=function(e,r,a,n,o,s){var l;if(!e.isDrawing()){var u=[];if(P(s)&&(zt(s)?s&&(u=ti()):u=s),u.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(e,r,a,n,o),mouseDownEvent:this._figureMouseDownEvent(e,r,a,n,o),mouseClickEvent:this._figureMouseClickEvent(e,r,a,n,o),mouseRightClickEvent:this._figureMouseRightClickEvent(e,r,a,n,o),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,r,a,n,o)};l={},!u.includes("mouseMoveEvent")&&!u.includes("touchMoveEvent")&&(l.mouseMoveEvent=this._figureMouseMoveEvent(e,r,a,n,o)),!u.includes("mouseDownEvent")&&!u.includes("touchStartEvent")&&(l.mouseDownEvent=this._figureMouseDownEvent(e,r,a,n,o)),!u.includes("mouseClickEvent")&&!u.includes("tapEvent")&&(l.mouseClickEvent=this._figureMouseClickEvent(e,r,a,n,o)),!u.includes("mouseDoubleClickEvent")&&!u.includes("doubleTapEvent")&&(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(e,r,a,n,o)),u.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(e,r,a,n,o))}return l},t.prototype._figureMouseMoveEvent=function(e,r,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane(),c=u.getChart().getChartStore().getOverlayStore();return c.setHoverInstanceInfo({paneId:u.getId(),instance:e,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},t.prototype._figureMouseDownEvent=function(e,r,a,n,o){var s=this;return function(l){var u,c=s.getWidget().getPane(),h=c.getId(),d=c.getChart().getChartStore().getOverlayStore();return e.startPressedMove(s._coordinateToPoint(e,l)),(u=e.onPressedMoveStart)===null||u===void 0||u.call(e,F({overlay:e,figureIndex:n,figureKey:a},l)),d.setPressedInstanceInfo({paneId:h,instance:e,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o}),!0}},t.prototype._figureMouseClickEvent=function(e,r,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane(),c=u.getId(),h=u.getChart().getChartStore().getOverlayStore();return h.setClickInstanceInfo({paneId:c,instance:e,figureType:r,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},t.prototype._figureMouseDoubleClickEvent=function(e,r,a,n,o){return function(s){var l;return(l=e.onDoubleClick)===null||l===void 0||l.call(e,F(F({},s),{figureIndex:n,figureKey:a,overlay:e})),!0}},t.prototype._figureMouseRightClickEvent=function(e,r,a,n,o){var s=this;return function(l){var u,c;if(!((c=(u=e.onRightClick)===null||u===void 0?void 0:u.call(e,F({overlay:e,figureIndex:n,figureKey:a},l)))!==null&&c!==void 0&&c)){var h=s.getWidget().getPane(),d=h.getChart().getChartStore().getOverlayStore();d.removeInstance(e)}return!0}},t.prototype._coordinateToPoint=function(e,r){var a,n={},o=this.getWidget().getPane(),s=o.getChart(),l=o.getId(),u=s.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var c=s.getXAxisPane().getAxisComponent(),h=c.convertFromPixel(r.x),d=(a=u.dataIndexToTimestamp(h))!==null&&a!==void 0?a:void 0;n.dataIndex=h,n.timestamp=d}if(this.coordinateToPointValueFlag()){var f=o.getAxisComponent(),v=f.convertFromPixel(r.y);if(e.mode!==Kt.Normal&&l===z.CANDLE&&k(n.dataIndex)){var g=u.getDataByDataIndex(n.dataIndex);if(g!==null){var p=e.modeSensitivity;if(v>g.high)if(e.mode===Kt.WeakMagnet){var m=f.convertToPixel(g.high),_=f.convertFromPixel(m-p);v<_&&(v=g.high)}else v=g.high;else if(v<g.low)if(e.mode===Kt.WeakMagnet){var S=f.convertToPixel(g.low),_=f.convertFromPixel(S-p);v>_&&(v=g.low)}else v=g.low;else{var y=Math.max(g.open,g.close),x=Math.min(g.open,g.close);v>y?v-y<g.high-v?v=y:v=g.high:v<x?v-g.low<x-v?v=g.low:v=x:y-v<v-x?v=y:v=x}}}n.value=v}return n},t.prototype.coordinateToPointValueFlag=function(){return!0},t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.dispatchEvent=function(e,r,a){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,r,a):i.prototype.dispatchEvent.call(this,e,r,a)},t.prototype.checkEventOn=function(){return!0},t.prototype.drawImp=function(e){var r=this,a=this.getWidget(),n=a.getPane(),o=n.getId(),s=n.getChart(),l=n.getAxisComponent(),u=s.getXAxisPane().getAxisComponent(),c=a.getBounding(),h=s.getChartStore(),d=h.getCustomApi(),f=h.getThousandsSeparator(),v=h.getDecimalFoldThreshold(),g=h.getTimeScaleStore(),p=g.getDateTimeFormat(),m=g.getBarSpace(),_=h.getPrecision(),S=h.getStyles().overlay,y=h.getOverlayStore(),x=y.getHoverInstanceInfo(),C=y.getClickInstanceInfo(),b=this.getCompleteOverlays(y,o),E=h.getIndicatorStore().getInstances(o),w=E.reduce(function(T,D){var A=D.precision;return T[D.name]=A,T.max=Math.max(T.max,A),T.min=Math.min(T.min,A),T.excludePriceVolumeMax=Math.max(T.excludePriceVolumeMax,A),T.excludePriceVolumeMin=Math.min(T.excludePriceVolumeMin,A),T},F(F({},_),{max:Math.max(_.price,_.volume),min:Math.min(_.price,_.volume),excludePriceVolumeMax:Number.MIN_SAFE_INTEGER,excludePriceVolumeMin:Number.MAX_SAFE_INTEGER}));b.forEach(function(T){T.visible&&r._drawOverlay(e,T,c,m,w,p,d,f,v,S,u,l,x,C,g)});var I=y.getProgressInstanceInfo();if(I!==null){var M=this.getProgressOverlay(I,o);M!==null&&M.visible&&this._drawOverlay(e,M,c,m,w,p,d,f,v,S,u,l,x,C,g)}},t.prototype._drawOverlay=function(e,r,a,n,o,s,l,u,c,h,d,f,v,g,p){var m=r.points,_=m.map(function(y){var x,C,b=y.dataIndex;k(y.timestamp)&&(b=p.timestampToDataIndex(y.timestamp));var E={x:0,y:0};return k(b)&&(E.x=(x=d==null?void 0:d.convertToPixel(b))!==null&&x!==void 0?x:0),k(y.value)&&(E.y=(C=f==null?void 0:f.convertToPixel(y.value))!==null&&C!==void 0?C:0),E});if(_.length>0){var S=new Array().concat(this.getFigures(r,_,a,n,o,u,c,s,h,d,f));this.drawFigures(e,r,S,h)}this.drawDefaultFigures(e,r,_,a,o,s,l,u,c,h,d,f,v,g)},t.prototype.drawFigures=function(e,r,a,n){var o=this;a.forEach(function(s,l){var u=s.type,c=s.styles,h=s.attrs,d=s.ignoreEvent,f=[].concat(h);f.forEach(function(v,g){var p,m,_,S=o._createFigureEvents(r,2,(p=s.key)!==null&&p!==void 0?p:"",l,g,d),y=F(F(F({},n[u]),(m=r.styles)===null||m===void 0?void 0:m[u]),c);(_=o.createFigure({name:u,attrs:v,styles:y},S))===null||_===void 0||_.draw(e)})})},t.prototype.getCompleteOverlays=function(e,r){return e.getInstances(r)},t.prototype.getProgressOverlay=function(e,r){return e.paneId===r?e.instance:null},t.prototype.getFigures=function(e,r,a,n,o,s,l,u,c,h,d){var f,v;return(v=(f=e.createPointFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:r,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:d}))!==null&&v!==void 0?v:[]},t.prototype.drawDefaultFigures=function(e,r,a,n,o,s,l,u,c,h,d,f,v,g){var p=this,m,_;if(r.needDefaultPointFigure&&(((m=v.instance)===null||m===void 0?void 0:m.id)===r.id&&v.figureType!==0||((_=g.instance)===null||_===void 0?void 0:_.id)===r.id&&g.figureType!==0)){var S=r.styles,y=F(F({},h.point),S==null?void 0:S.point);a.forEach(function(x,C){var b,E,w,I=x.x,M=x.y,T=y.radius,D=y.color,A=y.borderColor,B=y.borderSize;((b=v.instance)===null||b===void 0?void 0:b.id)===r.id&&v.figureType===1&&v.figureIndex===C&&(T=y.activeRadius,D=y.activeColor,A=y.activeBorderColor,B=y.activeBorderSize),(E=p.createFigure({name:"circle",attrs:{x:I,y:M,r:T+B},styles:{color:A}},p._createFigureEvents(r,1,"".concat(jt,"point_").concat(C),C,0)))===null||E===void 0||E.draw(e),(w=p.createFigure({name:"circle",attrs:{x:I,y:M,r:T},styles:{color:D}}))===null||w===void 0||w.draw(e)})}},t}(bt),Cr=function(i){V(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._gridView=new Oa(a),a._indicatorView=new Na(a),a._crosshairLineView=new Wa(a),a._tooltipView=a.createTooltipView(),a._overlayView=new br(a),a.addChild(a._tooltipView),a.addChild(a._overlayView),a.getContainer().style.cursor="crosshair",a.registerEvent("mouseMoveEvent",function(){return r.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),a}return t.prototype.getName=function(){return O.MAIN},t.prototype.updateMain=function(e){this.updateMainContent(e),this._indicatorView.draw(e),this._gridView.draw(e)},t.prototype.createTooltipView=function(){return new xr(this)},t.prototype.updateMainContent=function(e){},t.prototype.updateOverlay=function(e){this._overlayView.draw(e),this._crosshairLineView.draw(e),this._tooltipView.draw(e)},t}(Fe),za=function(i){V(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._ripplePoint=e.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),e._animationFrameTime=0,e._animation=new Ie({iterationCount:1/0}).doFrame(function(r){e._animationFrameTime=r;var a=e.getWidget().getPane();a.getChart().updatePane(0,a.getId())}),e}return t.prototype.drawImp=function(e){var r,a,n,o=this.getWidget(),s=o.getPane(),l=s.getChart(),u=l.getDataList(),c=u.length-1,h=o.getBounding(),d=s.getAxisComponent(),f=l.getStyles().candle.area,v=[],g=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,m=null;if(this.eachChildren(function(b){var E=b.data,w=b.x,I=E==null?void 0:E[f.value];if(k(I)){var M=d.convertToPixel(I);p===Number.MIN_SAFE_INTEGER&&(p=w),v.push({x:w,y:M}),g=Math.min(g,M),b.dataIndex===c&&(m={x:w,y:M})}}),v.length>0){(r=this.createFigure({name:"line",attrs:{coordinates:v},styles:{color:f.lineColor,size:f.lineSize,smooth:f.smooth}}))===null||r===void 0||r.draw(e);var _=f.backgroundColor,S=void 0;if(pt(_)){var y=e.createLinearGradient(0,h.height,0,g);try{_.forEach(function(b){var E=b.offset,w=b.color;y.addColorStop(E,w)})}catch{}S=y}else S=_;e.fillStyle=S,e.beginPath(),e.moveTo(p,h.height),e.lineTo(v[0].x,v[0].y),cr(e,v,f.smooth),e.lineTo(v[v.length-1].x,h.height),e.closePath(),e.fill()}var x=f.point;if(x.show&&P(m)){(a=this.createFigure({name:"circle",attrs:{x:m.x,y:m.y,r:x.radius},styles:{style:"fill",color:x.color}}))===null||a===void 0||a.draw(e);var C=x.rippleRadius;x.animation&&(C=x.radius+this._animationFrameTime/x.animationDuration*(x.rippleRadius-x.radius),this._animation.setDuration(x.animationDuration).start()),(n=this._ripplePoint)===null||n===void 0||n.setAttrs({x:m.x,y:m.y,r:C}).setStyles({style:"fill",color:x.rippleColor}).draw(e)}else this.stopAnimation()},t.prototype.stopAnimation=function(){this._animation.stop()},t}(Re),Xa=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),a=r.getPane(),n=a.getChart().getChartStore(),o=n.getStyles().candle.priceMark,s=o.high,l=o.low;if(o.show&&(s.show||l.show)){var u=n.getThousandsSeparator(),c=n.getDecimalFoldThreshold(),h=n.getPrecision(),d=a.getAxisComponent(),f=Number.MIN_SAFE_INTEGER,v=0,g=Number.MAX_SAFE_INTEGER,p=0;this.eachChildren(function(S){var y=S.data,x=S.x;P(y)&&(f<y.high&&(f=y.high,v=x),g>y.low&&(g=y.low,p=x))});var m=d.convertToPixel(f),_=d.convertToPixel(g);s.show&&f!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,J($(U(f,h.price),u),c),{x:v,y:m},m<_?[-2,-5]:[2,5],s),l.show&&g!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,J($(U(g,h.price),u),c),{x:p,y:_},m<_?[2,5]:[-2,-5],l)}},t.prototype._drawMark=function(e,r,a,n,o){var s,l,u,c=a.x,h=a.y+n[0];(s=this.createFigure({name:"line",attrs:{coordinates:[{x:c-2,y:h+n[0]},{x:c,y:h},{x:c+2,y:h+n[0]}]},styles:{color:o.color}}))===null||s===void 0||s.draw(e);var d,f,v,g=this.getWidget().getBounding().width;c>g/2?(d=c-5,f=d-o.textOffset,v="right"):(d=c+5,v="left",f=d+o.textOffset);var p=h+n[1];(l=this.createFigure({name:"line",attrs:{coordinates:[{x:c,y:h},{x:c,y:p},{x:d,y:p}]},styles:{color:o.color}}))===null||l===void 0||l.draw(e),(u=this.createFigure({name:"text",attrs:{x:f,y:p,text:r,align:v,baseline:"middle"},styles:{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}}))===null||u===void 0||u.draw(e)},t}(Re),Ya=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.line;if(l.show&&u.show&&c.show){var h=n.getAxisComponent(),d=s.getDataList(),f=d[d.length-1];if(f!=null){var v=f.close,g=f.open,p=h.convertToNicePixel(v),m=void 0;v>g?m=u.upColor:v<g?m=u.downColor:m=u.noChangeColor,(r=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:p},{x:o.width,y:p}]},styles:{style:c.style,color:m,size:c.size,dashedValue:c.dashedValue}}))===null||r===void 0||r.draw(e)}}},t}(bt),Ha={time:"",open:"",high:"",low:"",close:"",volume:"",turnover:"",change:""},Ga={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "},ja={"zh-CN":Ha,"en-US":Ga};function Za(i,t){var e,r;return(r=(e=ja[t])===null||e===void 0?void 0:e[i])!==null&&r!==void 0?r:i}var Ua=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),a=r.getPane(),n=a.getId(),o=a.getChart().getChartStore(),s=o.getTooltipStore().getCrosshair();if(P(s.kLineData)){var l=r.getBounding(),u=a.getYAxisWidget().getBounding(),c=o.getDataList(),h=o.getPrecision(),d=o.getLocale(),f=o.getCustomApi(),v=o.getThousandsSeparator(),g=o.getDecimalFoldThreshold(),p=o.getTooltipStore().getActiveIcon(),m=o.getIndicatorStore().getInstances(a.getId()),_=o.getTimeScaleStore().getDateTimeFormat(),S=o.getStyles(),y=S.candle,x=S.indicator;if(y.tooltip.showType===St.Rect&&x.tooltip.showType===St.Rect){var C=this.isDrawTooltip(s,y.tooltip),b=this.isDrawTooltip(s,x.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,_,d,f,v,g,C,b,y.tooltip.offsetTop,S)}else if(y.tooltip.showType===St.Standard&&x.tooltip.showType===St.Standard){var E=y.tooltip,w=E.offsetLeft,I=E.offsetTop,M=E.offsetRight,T=l.width-M,D=this._drawCandleStandardTooltip(e,c,n,s,p,h,_,d,f,v,g,w,I,T,y);this.drawIndicatorTooltip(e,n,c,s,p,m,f,v,g,w,D,T,x)}else if(y.tooltip.showType===St.Rect&&x.tooltip.showType===St.Standard){var A=y.tooltip,w=A.offsetLeft,I=A.offsetTop,M=A.offsetRight,T=l.width-M,B=this.drawIndicatorTooltip(e,n,c,s,p,m,f,v,g,w,I,T,x),C=this.isDrawTooltip(s,y.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,_,d,f,v,g,C,!1,B,S)}else{var R=y.tooltip,w=R.offsetLeft,I=R.offsetTop,M=R.offsetRight,T=l.width-M,X=this._drawCandleStandardTooltip(e,c,n,s,p,h,_,d,f,v,g,w,I,T,y),b=this.isDrawTooltip(s,x.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,_,d,f,v,g,!1,b,X,S)}}},t.prototype._drawCandleStandardTooltip=function(e,r,a,n,o,s,l,u,c,h,d,f,v,g,p){var m,_,S,y=p.tooltip,x=y.text,C=0,b={x:f,y:v};if(this.isDrawTooltip(n,y)){var E=(m=n.dataIndex)!==null&&m!==void 0?m:0,w=this._getCandleTooltipLegends({prev:(_=r[E-1])!==null&&_!==void 0?_:null,current:n.kLineData,next:(S=r[E+1])!==null&&S!==void 0?S:null},s,l,u,c,h,d,p),I=Ht(this.classifyTooltipIcons(y.icons),3),M=I[0],T=I[1],D=I[2];C=this.drawStandardTooltipIcons(e,o,M,b,a,"",f,C,g),C=this.drawStandardTooltipIcons(e,o,T,b,a,"",f,C,g),w.length>0&&(C=this.drawStandardTooltipLegends(e,w,b,f,C,g,x)),C=this.drawStandardTooltipIcons(e,o,D,b,a,"",f,C,g)}return b.y+C},t.prototype._drawRectTooltip=function(e,r,a,n,o,s,l,u,c,h,d,f,v,g,p,m){var _=this,S,y,x,C,b,E=m.candle,w=m.indicator,I=E.tooltip,M=w.tooltip;if(v||g){var T=(S=s.dataIndex)!==null&&S!==void 0?S:0,D=this._getCandleTooltipLegends({prev:(y=r[T-1])!==null&&y!==void 0?y:null,current:s.kLineData,next:(x=r[T+1])!==null&&x!==void 0?x:null},l,u,c,h,d,f,E),A=I.offsetLeft,B=I.offsetTop,R=I.offsetRight,X=I.offsetBottom,j=I.text,rt=j.marginLeft,at=j.marginRight,Y=j.marginTop,H=j.marginBottom,q=j.size,Z=j.weight,K=j.family,G=I.rect,mt=G.position,dt=G.paddingLeft,Pt=G.paddingRight,Mt=G.paddingTop,Bt=G.paddingBottom,_t=G.offsetLeft,Gt=G.offsetRight,ge=G.offsetTop,Be=G.offsetBottom,Tt=G.borderSize,kr=G.borderRadius,Fr=G.borderColor,Rr=G.color,Jt=0,Dt=0,At=0;v&&(e.font=Yt(q,Z,K),D.forEach(function(Ct){var st=Ct.title,lt=Ct.value,gt="".concat(st.text).concat(lt.text),wt=e.measureText(gt).width+rt+at;Jt=Math.max(Jt,wt)}),At+=(H+Y+q)*D.length);var Lt=M.text,Le=Lt.marginLeft,Ve=Lt.marginRight,Oe=Lt.marginTop,Ne=Lt.marginBottom,te=Lt.size,pe=Lt.weight,me=Lt.family,We=[];if(g&&(e.font=Yt(te,pe,me),a.forEach(function(Ct){var st,lt=(st=_.getIndicatorTooltipData(r,s,Ct,h,d,f,w).values)!==null&&st!==void 0?st:[];We.push(lt),lt.forEach(function(gt){var wt=gt.title,se=gt.value,Nr="".concat(wt.text).concat(se.text),Wr=e.measureText(Nr).width+Le+Ve;Jt=Math.max(Jt,Wr),At+=Oe+Ne+te})})),Dt+=Jt,Dt!==0&&At!==0){Dt+=Tt*2+dt+Pt,At+=Tt*2+Mt+Bt;var Br=n.width/2,ze=mt===ce.Pointer&&s.paneId===z.CANDLE,Xe=((C=s.realX)!==null&&C!==void 0?C:0)>Br,ft=0;if(ze){var Ye=s.realX;Xe?ft=Ye-Gt-Dt:ft=Ye+_t}else Xe?(ft=_t+A,m.yAxis.inside&&m.yAxis.position===Rt.Left&&(ft+=o.width)):(ft=n.width-Gt-Dt-R,m.yAxis.inside&&m.yAxis.position===Rt.Right&&(ft-=o.width));var Vt=p+ge;if(ze){var Lr=s.y;Vt=Lr-At/2,Vt+At>n.height-Be-X&&(Vt=n.height-Be-At-X),Vt<p+ge&&(Vt=p+ge+B)}(b=this.createFigure({name:"rect",attrs:{x:ft,y:Vt,width:Dt,height:At},styles:{style:W.StrokeFill,color:Rr,borderColor:Fr,borderSize:Tt,borderRadius:kr}}))===null||b===void 0||b.draw(e);var Vr=ft+Tt+dt+rt,kt=Vt+Tt+Mt;if(v&&D.forEach(function(Ct){var st,lt;kt+=Y;var gt=Ct.title;(st=_.createFigure({name:"text",attrs:{x:Vr,y:kt,text:gt.text},styles:{color:gt.color,size:q,family:K,weight:Z}}))===null||st===void 0||st.draw(e);var wt=Ct.value;(lt=_.createFigure({name:"text",attrs:{x:ft+Dt-Tt-at-Pt,y:kt,text:wt.text,align:"right"},styles:{color:wt.color,size:q,family:K,weight:Z}}))===null||lt===void 0||lt.draw(e),kt+=q+H}),g){var Or=ft+Tt+dt+Le;We.forEach(function(Ct){Ct.forEach(function(st){var lt,gt;kt+=Oe;var wt=st.title,se=st.value;(lt=_.createFigure({name:"text",attrs:{x:Or,y:kt,text:wt.text},styles:{color:wt.color,size:te,family:me,weight:pe}}))===null||lt===void 0||lt.draw(e),(gt=_.createFigure({name:"text",attrs:{x:ft+Dt-Tt-Ve-Pt,y:kt,text:se.text,align:"right"},styles:{color:se.color,size:te,family:me,weight:pe}}))===null||gt===void 0||gt.draw(e),kt+=te+Ne})})}}}},t.prototype._getCandleTooltipLegends=function(e,r,a,n,o,s,l,u){var c,h,d,f,v,g=u.tooltip,p=g.text.color,m=e.current,_=(h=(c=e.prev)===null||c===void 0?void 0:c.close)!==null&&h!==void 0?h:m.close,S=m.close-_,y=r.price,x=r.volume,C={"{time}":o.formatDate(a,m.timestamp,"YYYY-MM-DD HH:mm",it.Tooltip),"{open}":J($(U(m.open,y),s),l),"{high}":J($(U(m.high,y),s),l),"{low}":J($(U(m.low,y),s),l),"{close}":J($(U(m.close,y),s),l),"{volume}":J($(o.formatBigNumber(U((d=m.volume)!==null&&d!==void 0?d:g.defaultValue,x)),s),l),"{turnover}":J($(U((f=m.turnover)!==null&&f!==void 0?f:g.defaultValue,y),s),l),"{change}":_===0?g.defaultValue:"".concat($(U(S/_*100),s),"%")},b=(v=Et(g.custom)?g.custom(e,u):g.custom)!==null&&v!==void 0?v:[];return b.map(function(E){var w,I=E.title,M=E.value,T={text:"",color:""};xt(I)?T=F({},I):(T.text=I,T.color=p),T.text=Za(T.text,n);var D={text:g.defaultValue,color:""};xt(M)?D=F({},M):(D.text=M,D.color=p);var A=D.text.match(/{(\S*)}/);if(A!==null&&A.length>1){var B="{".concat(A[1],"}");D.text=D.text.replace(B,(w=C[B])!==null&&w!==void 0?w:g.defaultValue),B==="{change}"&&(D.color=S===0?u.priceMark.last.noChangeColor:S>0?u.priceMark.last.upColor:u.priceMark.last.downColor)}return{title:T,value:D}})},t}(xr),qa=function(i){V(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._candleBarView=new Sr(a),a._candleAreaView=new za(a),a._candleHighLowPriceView=new Xa(a),a._candleLastPriceLineView=new Ya(a),a.addChild(a._candleBarView),a}return t.prototype.updateMainContent=function(e){var r=this.getPane().getChart().getStyles().candle;r.type!==ut.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},t.prototype.createTooltipView=function(){return new Ua(this)},t}(Cr),wr=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this,a,n,o=this.getWidget(),s=o.getPane(),l=o.getBounding(),u=s.getAxisComponent(),c=this.getAxisStyles(s.getChart().getStyles());if(c.show){c.axisLine.show&&((a=this.createFigure({name:"line",attrs:this.createAxisLine(l,c),styles:c.axisLine}))===null||a===void 0||a.draw(e));var h=u.getTicks();if(c.tickLine.show){var d=this.createTickLines(h,l,c);d.forEach(function(v){var g;(g=r.createFigure({name:"line",attrs:v,styles:c.tickLine}))===null||g===void 0||g.draw(e)})}if(c.tickText.show){var f=this.createTickTexts(h,l,c);(n=this.createFigure({name:"text",attrs:f,styles:c.tickText}))===null||n===void 0||n.draw(e)}}},t}(bt),Ka=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.yAxis},t.prototype.createAxisLine=function(e,r){var a=this.getWidget().getPane().getAxisComponent(),n=r.axisLine.size,o;return a.isFromZero()?o=0:o=e.width-n,{coordinates:[{x:o,y:0},{x:o,y:e.height}]}},t.prototype.createTickLines=function(e,r,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=0,u=0;return n.isFromZero()?(l=0,o.show&&(l+=o.size),u=l+s.length):(l=r.width,o.show&&(l-=o.size),u=l-s.length),e.map(function(c){return{coordinates:[{x:l,y:c.coord},{x:u,y:c.coord}]}})},t.prototype.createTickTexts=function(e,r,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=a.tickText,u=0;n.isFromZero()?(u=l.marginStart,o.show&&(u+=o.size),s.show&&(u+=s.length)):(u=r.width-l.marginEnd,o.show&&(u-=o.size),s.show&&(u-=s.length));var c=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(function(h){return{x:u,y:h.coord,text:h.text,align:c,baseline:"middle"}})},t}(wr),$a=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.text;if(l.show&&u.show&&c.show){var h=s.getPrecision(),d=n.getAxisComponent(),f=s.getDataList(),v=f[f.length-1];if(P(v)){var g=v.close,p=v.open,m=d.convertToNicePixel(g),_=void 0;g>p?_=u.upColor:g<p?_=u.downColor:_=u.noChangeColor;var S=void 0;if(d.getType()===tt.Percentage){var y=s.getVisibleFirstData(),x=y.close;S="".concat(((g-x)/x*100).toFixed(2),"%")}else S=U(g,h.price);S=J($(S,s.getThousandsSeparator()),s.getDecimalFoldThreshold());var C=void 0,b=void 0;d.isFromZero()?(C=0,b="left"):(C=o.width,b="right"),(r=this.createFigure({name:"text",attrs:{x:C,y:m,text:S,align:b,baseline:"middle"},styles:F(F({},c),{backgroundColor:_})}))===null||r===void 0||r.draw(e)}}},t}(bt),Qa=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getCustomApi(),u=s.getStyles().indicator,c=u.lastValueMark,h=c.text;if(c.show){var d=n.getAxisComponent(),f=s.getDataList(),v=f.length-1,g=s.getIndicatorStore().getInstances(n.getId()),p=s.getThousandsSeparator(),m=s.getDecimalFoldThreshold();g.forEach(function(_){var S=_.result,y=S[v];if(P(y)&&_.visible){var x=_.precision;Te(f,_,v,u,function(C,b){var E,w=y[C.key];if(k(w)){var I=d.convertToNicePixel(w),M=U(w,x);_.shouldFormatBigNumber&&(M=l.formatBigNumber(M)),M=J($(M,p),m);var T=void 0,D=void 0;d.isFromZero()?(T=0,D="left"):(T=o.width,D="right"),(E=r.createFigure({name:"text",attrs:{x:T,y:I,text:M,align:D,baseline:"middle"},styles:F(F({},h),{backgroundColor:b.color})}))===null||E===void 0||E.draw(e)}})}})}},t}(bt),Er=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},t.prototype.drawDefaultFigures=function(e,r,a,n,o,s,l,u,c,h,d,f,v,g){this.drawFigures(e,r,this.getDefaultFigures(r,a,n,o,s,l,u,c,d,f,g),h)},t.prototype.getDefaultFigures=function(e,r,a,n,o,s,l,u,c,h,d){var f,v,g=[];if(e.needDefaultYAxisFigure&&e.id===((f=d.instance)===null||f===void 0?void 0:f.id)&&d.paneId===this.getWidget().getPane().getId()){var p=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER,_=(v=h==null?void 0:h.isFromZero())!==null&&v!==void 0?v:!1,S,y;_?(S="left",y=0):(S="right",y=a.width),r.forEach(function(x,C){var b=e.points[C];if(k(b.value)){p=Math.min(p,x.y),m=Math.max(m,x.y);var E=J($(U(b.value,n.price),l),u);g.push({type:"text",attrs:{x:y,y:x.y,text:E,align:S,baseline:"middle"},ignoreEvent:!0})}}),r.length>1&&g.unshift({type:"rect",attrs:{x:0,y:p,width:a.width,height:m-p},ignoreEvent:!0})}return g},t.prototype.getFigures=function(e,r,a,n,o,s,l,u,c,h,d){var f,v;return(v=(f=e.createYAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:r,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:d}))!==null&&v!==void 0?v:[]},t}(br),Ir=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=a.getPane().getChart().getChartStore(),l=s.getTooltipStore().getCrosshair(),u=s.getStyles().crosshair;if(L(l.paneId)&&this.compare(l,n.getId())&&u.show){var c=this.getDirectionStyles(u),h=c.text;if(c.show&&h.show){var d=n.getAxisComponent(),f=this.getText(l,s,d);e.font=Yt(h.size,h.weight,h.family),(r=this.createFigure({name:"text",attrs:this.getTextAttrs(f,e.measureText(f).width,l,o,d,h),styles:h}))===null||r===void 0||r.draw(e)}}},t.prototype.compare=function(e,r){return e.paneId===r},t.prototype.getDirectionStyles=function(e){return e.horizontal},t.prototype.getText=function(e,r,a){var n=a,o=a.convertFromPixel(e.y),s;if(n.getType()===tt.Percentage){var l=r.getVisibleFirstData();s="".concat(((o-l.close)/l.close*100).toFixed(2),"%")}else{var u=r.getIndicatorStore().getInstances(e.paneId),c=0,h=!1;n.isInCandle()?c=r.getPrecision().price:u.forEach(function(d){c=Math.max(d.precision,c),h||(h=d.shouldFormatBigNumber)}),s=U(o,c),h&&(s=r.getCustomApi().formatBigNumber(s))}return J($(s,r.getThousandsSeparator()),r.getDecimalFoldThreshold())},t.prototype.getTextAttrs=function(e,r,a,n,o,s){var l=o,u,c;return l.isFromZero()?(u=0,c="left"):(u=n.width,c="right"),{x:u,y:a.y,text:e,align:c,baseline:"middle"}},t}(bt),Ja=function(i){V(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._yAxisView=new Ka(a),a._candleLastPriceLabelView=new $a(a),a._indicatorLastValueView=new Qa(a),a._overlayYAxisView=new Er(a),a._crosshairHorizontalLabelView=new Ir(a),a.getContainer().style.cursor="ns-resize",a.addChild(a._overlayYAxisView),a}return t.prototype.getName=function(){return O.Y_AXIS},t.prototype.updateMain=function(e){this._yAxisView.draw(e),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(e),this._indicatorLastValueView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayYAxisView.draw(e),this._crosshairHorizontalLabelView.draw(e)},t}(Fe),Pr=function(){function i(t){this._range={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._prevRange={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return i.prototype.getParent=function(){return this._parent},i.prototype.buildTicks=function(t){if(this._autoCalcTickFlag&&(this._range=this.calcRange()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||t){this._prevRange=this._range;var e=this.optimalTicks(this._calcTicks());return this._ticks=this.createTicks({range:this._range,bounding:this.getSelfBounding(),defaultTicks:e}),!0}return!1},i.prototype.getTicks=function(){return this._ticks},i.prototype.getScrollZoomEnabled=function(){var t;return(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)!==null&&t!==void 0?t:!0},i.prototype.setRange=function(t){this._autoCalcTickFlag=!1,this._range=t},i.prototype.getRange=function(){return this._range},i.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},i.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},i.prototype._calcTicks=function(){var t=this._range,e=t.realFrom,r=t.realTo,a=t.realRange,n=[];if(a>=0){var o=Ht(this._calcTickInterval(a),2),s=o[0],l=o[1],u=Ze(Math.ceil(e/s)*s,l),c=Ze(Math.floor(r/s)*s,l),h=0,d=u;if(s!==0)for(;d<=c;){var f=d.toFixed(l);n[h]={text:f,coord:0,value:f},++h,d+=s}}return n},i.prototype._calcTickInterval=function(t){var e=oi(t/8),r=si(e);return[e,r]},i}(),tn=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e,r,a,n,o=this.getParent(),s=o.getChart(),l=s.getChartStore(),u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,h=[],d=!1,f=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER,p=l.getIndicatorStore().getInstances(o.getId());p.forEach(function(H){var q,Z,K;d||(d=(q=H.shouldOhlc)!==null&&q!==void 0?q:!1),g=Math.min(g,H.precision),k(H.minValue)&&(f=Math.min(f,H.minValue)),k(H.maxValue)&&(v=Math.max(v,H.maxValue)),h.push({figures:(Z=H.figures)!==null&&Z!==void 0?Z:[],result:(K=H.result)!==null&&K!==void 0?K:[]})});var m=4,_=this.isInCandle();if(_){var S=l.getPrecision().price;g!==Number.MAX_SAFE_INTEGER?m=Math.min(g,S):m=S}else g!==Number.MAX_SAFE_INTEGER&&(m=g);var y=l.getVisibleDataList(),x=s.getStyles().candle,C=x.type===ut.Area,b=x.area.value,E=_&&!C||!_&&d;y.forEach(function(H){var q=H.dataIndex,Z=H.data;if(P(Z)&&(E&&(u=Math.min(u,Z.low),c=Math.max(c,Z.high)),_&&C)){var K=Z[b];k(K)&&(u=Math.min(u,K),c=Math.max(c,K))}h.forEach(function(G){var mt,dt=G.figures,Pt=G.result,Mt=(mt=Pt[q])!==null&&mt!==void 0?mt:{};dt.forEach(function(Bt){var _t=Mt[Bt.key];k(_t)&&(u=Math.min(u,_t),c=Math.max(c,_t))})})}),u!==Number.MAX_SAFE_INTEGER&&c!==Number.MIN_SAFE_INTEGER?(u=Math.min(f,u),c=Math.max(v,c)):(u=0,c=10);var w=this.getType(),I;switch(w){case tt.Percentage:{var M=l.getVisibleFirstData();P(M)&&k(M.close)&&(u=(u-M.close)/M.close*100,c=(c-M.close)/M.close*100),I=Math.pow(10,-2);break}case tt.Log:{u=ie(u),c=ie(c),I=.05*Ot(-m);break}default:I=Ot(-m)}if(u===c||Math.abs(u-c)<I){var T=f===u,D=v===c;u=T?u:D?u-8*I:u-4*I,c=D?c:T?c+8*I:c+4*I}var A=(r=(e=this.getParent().getYAxisWidget())===null||e===void 0?void 0:e.getBounding().height)!==null&&r!==void 0?r:0,B=o.getOptions().gap,R=(a=B==null?void 0:B.top)!==null&&a!==void 0?a:.2;R>=1&&(R=R/A);var X=(n=B==null?void 0:B.bottom)!==null&&n!==void 0?n:.1;X>=1&&(X=X/A);var j=Math.abs(c-u);u=u-j*X,c=c+j*R,j=Math.abs(c-u);var rt,at,Y;return w===tt.Log?(rt=Ot(u),at=Ot(c),Y=Math.abs(at-rt)):(rt=u,at=c,Y=j),{from:u,to:c,range:j,realFrom:rt,realTo:at,realRange:Y}},t.prototype._innerConvertToPixel=function(e){var r,a,n=(a=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,o=this.getRange(),s=o.from,l=o.range,u=(e-s)/l;return this.isReverse()?Math.round(u*n):Math.round((1-u)*n)},t.prototype.isInCandle=function(){return this.getParent().getId()===z.CANDLE},t.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:tt.Normal},t.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},t.prototype.isReverse=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.reverse:!1},t.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,r=e.inside;return e.position===Rt.Left&&r||e.position===Rt.Right&&!r},t.prototype.optimalTicks=function(e){var r=this,a,n,o=this.getParent(),s=(n=(a=o.getYAxisWidget())===null||a===void 0?void 0:a.getBounding().height)!==null&&n!==void 0?n:0,l=o.getChart().getChartStore(),u=l.getCustomApi(),c=[],h=this.getType(),d=l.getIndicatorStore().getInstances(o.getId()),f=l.getThousandsSeparator(),v=l.getDecimalFoldThreshold(),g=0,p=!1;this.isInCandle()?g=l.getPrecision().price:d.forEach(function(S){g=Math.max(g,S.precision),p||(p=S.shouldFormatBigNumber)});var m=l.getStyles().xAxis.tickText.size,_;return e.forEach(function(S){var y=S.value,x,C=r._innerConvertToPixel(+y);switch(h){case tt.Percentage:{x="".concat(U(y,2),"%");break}case tt.Log:{C=r._innerConvertToPixel(ie(+y)),x=U(y,g);break}default:{x=U(y,g),p&&(x=u.formatBigNumber(y));break}}x=J($(x,f),v);var b=k(_);C>m&&C<s-m&&(b&&Math.abs(_-C)>m*2||!b)&&(c.push({text:x,coord:C,value:y}),_=C)}),c},t.prototype.getAutoSize=function(){var e=this.getParent(),r=e.getChart(),a=r.getStyles(),n=a.yAxis,o=n.size;if(o!=="auto")return o;var s=r.getChartStore(),l=s.getCustomApi(),u=0;if(n.show&&(n.axisLine.show&&(u+=n.axisLine.size),n.tickLine.show&&(u+=n.tickLine.length),n.tickText.show)){var c=0;this.getTicks().forEach(function(y){c=Math.max(c,he(y.text,n.tickText.size,n.tickText.weight,n.tickText.family))}),u+=n.tickText.marginStart+n.tickText.marginEnd+c}var h=a.crosshair,d=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var f=s.getIndicatorStore().getInstances(e.getId()),v=0,g=!1;f.forEach(function(y){v=Math.max(y.precision,v),g||(g=y.shouldFormatBigNumber)});var p=2;if(this.getType()!==tt.Percentage)if(this.isInCandle()){var m=s.getPrecision().price,_=a.indicator.lastValueMark;_.show&&_.text.show?p=Math.max(v,m):p=m}else p=v;var S=U(this.getRange().to,p);g&&(S=l.formatBigNumber(S)),S=J(S,s.getDecimalFoldThreshold()),d+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+h.horizontal.text.borderSize*2+he(S,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(u,d)},t.prototype.getSelfBounding=function(){return this.getParent().getYAxisWidget().getBounding()},t.prototype.convertFromPixel=function(e){var r,a,n=(a=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,o=this.getRange(),s=o.from,l=o.range,u=this.isReverse()?e/n:1-e/n,c=u*l+s;switch(this.getType()){case tt.Percentage:{var h=this.getParent().getChart().getChartStore().getVisibleFirstData();return P(h)&&k(h.close)?h.close*c/100+h.close:0}case tt.Log:return Ot(c);default:return c}},t.prototype.convertToRealValue=function(e){var r=e;return this.getType()===tt.Log&&(r=Ot(e)),r},t.prototype.convertToPixel=function(e){var r=e;switch(this.getType()){case tt.Percentage:{var a=this.getParent().getChart().getChartStore().getVisibleFirstData();P(a)&&k(a.close)&&(r=(e-a.close)/a.close*100);break}case tt.Log:{r=ie(e);break}default:r=e}return this._innerConvertToPixel(r)},t.prototype.convertToNicePixel=function(e){var r,a,n=(a=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&a!==void 0?a:0,o=this.convertToPixel(e);return Math.round(Math.max(n*.05,Math.min(o,n*.98)))},t.extend=function(e){var r=function(a){V(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.createTicks=function(o){return e.createTicks(o)},n}(t);return r},t}(Pr),en={name:"default",createTicks:function(i){var t=i.defaultTicks;return t}},Qe={default:tn.extend(en)};function rn(i){var t;return(t=Qe[i])!==null&&t!==void 0?t:Qe.default}var Mr=function(){function i(t,e,r,a){this._bounding=fr(),this._chart=r,this._id=a,this._init(t,e)}return i.prototype._init=function(t,e){this._rootContainer=t,this._container=It("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),e!==null?t.insertBefore(this._container,e):t.appendChild(this._container)},i.prototype.getContainer=function(){return this._container},i.prototype.getId=function(){return this._id},i.prototype.getChart=function(){return this._chart},i.prototype.getBounding=function(){return this._bounding},i.prototype.update=function(t){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(t??3,this._container,this._bounding)},i.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},i}(),Tr=function(i){V(t,i);function t(e,r,a,n,o){var s=i.call(this,e,r,a,n)||this;s._yAxisWidget=null,s._options={minHeight:va,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{name:"default",scrollZoomEnabled:!0}};var l=s.getContainer();return s._mainWidget=s.createMainWidget(l),s._yAxisWidget=s.createYAxisWidget(l),s.setOptions(o),s}return t.prototype.setOptions=function(e){var r,a,n,o=(r=e.axisOptions)===null||r===void 0?void 0:r.name;(this._options.axisOptions.name!==o&&L(o)||!P(this._axis))&&(this._axis=this.createAxisComponent(o??"default")),vt(this._options,e);var s,l;return this.getId()===z.X_AXIS?(s=this.getMainWidget().getContainer(),l="ew-resize"):(s=this.getYAxisWidget().getContainer(),l="ns-resize"),!((n=(a=e.axisOptions)===null||a===void 0?void 0:a.scrollZoomEnabled)!==null&&n!==void 0)||n?s.style.cursor=l:s.style.cursor="default",this},t.prototype.getOptions=function(){return this._options},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(e,r,a){var n,o;vt(this.getBounding(),e);var s={};return P(e.height)&&(s.height=e.height),P(e.top)&&(s.top=e.top),this._mainWidget.setBounding(s),(n=this._yAxisWidget)===null||n===void 0||n.setBounding(s),P(r)&&this._mainWidget.setBounding(r),P(a)&&((o=this._yAxisWidget)===null||o===void 0||o.setBounding(a)),this},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.updateImp=function(e){var r;this._mainWidget.update(e),(r=this._yAxisWidget)===null||r===void 0||r.update(e)},t.prototype.destroy=function(){var e;i.prototype.destroy.call(this),this._mainWidget.destroy(),(e=this._yAxisWidget)===null||e===void 0||e.destroy()},t.prototype.getImage=function(e){var r=this.getBounding(),a=r.width,n=r.height,o=It("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=Ft(o);o.width=a*l,o.height=n*l,s.scale(l,l);var u=this._mainWidget.getBounding();if(s.drawImage(this._mainWidget.getImage(e),u.left,0,u.width,u.height),this._yAxisWidget!==null){var c=this._yAxisWidget.getBounding();s.drawImage(this._yAxisWidget.getImage(e),c.left,0,c.width,c.height)}return o},t.prototype.createYAxisWidget=function(e){return null},t}(Mr),Dr=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var r=rn(e??"default");return new r(this)},t.prototype.createMainWidget=function(e){return new Cr(e,this)},t.prototype.createYAxisWidget=function(e){return new Ja(e,this)},t}(Tr),an=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createMainWidget=function(e){return new qa(e,this)},t}(Dr),nn=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.xAxis},t.prototype.createAxisLine=function(e){return{coordinates:[{x:0,y:0},{x:e.width,y:0}]}},t.prototype.createTickLines=function(e,r,a){var n=a.tickLine,o=a.axisLine.size;return e.map(function(s){return{coordinates:[{x:s.coord,y:0},{x:s.coord,y:o+n.length}]}})},t.prototype.createTickTexts=function(e,r,a){var n=a.tickText,o=a.axisLine.size,s=a.tickLine.length;return e.map(function(l){return{x:l.coord,y:o+s+n.marginStart,text:l.text,align:"center",baseline:"top"}})},t}(wr),on=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.coordinateToPointValueFlag=function(){return!1},t.prototype.getCompleteOverlays=function(e){return e.getInstances()},t.prototype.getProgressOverlay=function(e){return e.instance},t.prototype.getDefaultFigures=function(e,r,a,n,o,s,l,u,c,h,d){var f,v=[];if(e.needDefaultXAxisFigure&&e.id===((f=d.instance)===null||f===void 0?void 0:f.id)){var g=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;r.forEach(function(m,_){g=Math.min(g,m.x),p=Math.max(p,m.x);var S=e.points[_];if(k(S.timestamp)){var y=s.formatDate(o,S.timestamp,"YYYY-MM-DD HH:mm",it.Crosshair);v.push({type:"text",attrs:{x:m.x,y:0,text:y,align:"center"},ignoreEvent:!0})}}),r.length>1&&v.unshift({type:"rect",attrs:{x:g,y:0,width:p-g,height:a.height},ignoreEvent:!0})}return v},t.prototype.getFigures=function(e,r,a,n,o,s,l,u,c,h,d){var f,v;return(v=(f=e.createXAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:r,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:d}))!==null&&v!==void 0?v:[]},t}(Er),sn=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.compare=function(e){return P(e.kLineData)&&e.dataIndex===e.realDataIndex},t.prototype.getDirectionStyles=function(e){return e.vertical},t.prototype.getText=function(e,r){var a,n=(a=e.kLineData)===null||a===void 0?void 0:a.timestamp;return r.getCustomApi().formatDate(r.getTimeScaleStore().getDateTimeFormat(),n,"YYYY-MM-DD HH:mm",it.Crosshair)},t.prototype.getTextAttrs=function(e,r,a,n,o,s){var l=a.realX,u,c="center";return l-r/2-s.paddingLeft<0?(u=0,c="left"):l+r/2+s.paddingRight>n.width?(u=n.width,c="right"):u=l,{x:u,y:0,text:e,align:c,baseline:"top"}},t}(Ir),ln=function(i){V(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._xAxisView=new nn(a),a._overlayXAxisView=new on(a),a._crosshairVerticalLabelView=new sn(a),a.getContainer().style.cursor="ew-resize",a.addChild(a._overlayXAxisView),a}return t.prototype.getName=function(){return O.X_AXIS},t.prototype.updateMain=function(e){this._xAxisView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayXAxisView.draw(e),this._crosshairVerticalLabelView.draw(e)},t}(Fe),un=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e=this.getParent().getChart().getChartStore(),r=e.getTimeScaleStore().getVisibleRange(),a=r.from,n=r.to,o=a,s=n-1,l=n-a;return{from:o,to:s,range:l,realFrom:o,realTo:s,realRange:l}},t.prototype.optimalTicks=function(e){var r,a,n=this.getParent().getChart(),o=n.getChartStore(),s=o.getCustomApi().formatDate,l=[],u=e.length,c=o.getDataList();if(u>0){var h=o.getTimeScaleStore().getDateTimeFormat(),d=n.getStyles().xAxis.tickText,f=he("00-00 00:00",d.size,d.weight,d.family),v=parseInt(e[0].value,10),g=this.convertToPixel(v),p=1;if(u>1){var m=parseInt(e[1].value,10),_=this.convertToPixel(m),S=Math.abs(_-g);S<f&&(p=Math.ceil(f/S))}for(var y=0;y<u;y+=p){var x=parseInt(e[y].value,10),C=c[x],b=C.timestamp,E=s(h,b,"HH:mm",it.XAxis);if(y!==0){var w=parseInt(e[y-p].value,10),I=c[w],M=I.timestamp;E=(r=this._optimalTickLabel(s,h,b,M))!==null&&r!==void 0?r:E}var T=this.convertToPixel(x);l.push({text:E,coord:T,value:b})}var D=l.length;if(D===1)l[0].text=s(h,l[0].value,"YYYY-MM-DD HH:mm",it.XAxis);else{var A=l[0].value,B=l[1].value;if(P(l[2])){var R=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(R)?l[0].text=s(h,A,"MM-DD",it.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(R)?l[0].text=s(h,A,"YYYY-MM",it.XAxis):/^[0-9]{4}$/.test(R)&&(l[0].text=s(h,A,"YYYY",it.XAxis))}else l[0].text=(a=this._optimalTickLabel(s,h,A,B))!==null&&a!==void 0?a:l[0].text}}return l},t.prototype._optimalTickLabel=function(e,r,a,n){var o=e(r,a,"YYYY",it.XAxis),s=e(r,a,"YYYY-MM",it.XAxis),l=e(r,a,"MM-DD",it.XAxis);return o!==e(r,n,"YYYY",it.XAxis)?o:s!==e(r,n,"YYYY-MM",it.XAxis)?s:l!==e(r,n,"MM-DD",it.XAxis)?l:null},t.prototype.getAutoSize=function(){var e=this.getParent().getChart().getStyles(),r=e.xAxis,a=r.size;if(a!=="auto")return a;var n=e.crosshair,o=0;r.show&&(r.axisLine.show&&(o+=r.axisLine.size),r.tickLine.show&&(o+=r.tickLine.length),r.tickText.show&&(o+=r.tickText.marginStart+r.tickText.marginEnd+r.tickText.size));var s=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(s+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+n.vertical.text.borderSize*2+n.vertical.text.size),Math.max(o,s)},t.prototype.getSelfBounding=function(){return this.getParent().getMainWidget().getBounding()},t.prototype.convertTimestampFromPixel=function(e){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),a=r.coordinateToDataIndex(e);return r.dataIndexToTimestamp(a)},t.prototype.convertTimestampToPixel=function(e){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),a=r.timestampToDataIndex(e);return r.dataIndexToCoordinate(a)},t.prototype.convertFromPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(e)},t.prototype.convertToPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(e)},t.extend=function(e){var r=function(a){V(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.createTicks=function(o){return e.createTicks(o)},n}(t);return r},t}(Pr),cn={name:"default",createTicks:function(i){var t=i.defaultTicks;return t}},Je={default:un.extend(cn)};function hn(i){var t;return(t=Je[i])!==null&&t!==void 0?t:Je.default}var vn=function(i){V(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var r=hn(e);return new r(this)},t.prototype.createMainWidget=function(e){return new ln(e,this)},t}(Tr);function dn(i,t){var e=0;return function(){var r=Date.now();r-e>t&&(i.apply(this,arguments),e=r)}}var fn=function(i){V(t,i);function t(e,r){var a=i.call(this,e,r)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._pressedMouseMoveEvent=dn(a._pressedTouchMouseMoveEvent,20),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return t.prototype.getName=function(){return O.SEPARATOR},t.prototype.checkEventOn=function(){return!0},t.prototype._mouseDownEvent=function(e){this._dragFlag=!0,this._dragStartY=e.pageY;var r=this.getPane();return this._topPaneHeight=r.getTopPane().getBounding().height,this._bottomPaneHeight=r.getBottomPane().getBounding().height,!0},t.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},t.prototype._pressedTouchMouseMoveEvent=function(e){var r=e.pageY-this._dragStartY,a=this.getPane(),n=a.getTopPane(),o=a.getBottomPane(),s=r<0;if(n!==null&&(o!=null&&o.getOptions().dragEnabled)){var l=void 0,u=void 0,c=void 0,h=void 0;s?(l=n,u=o,c=this._topPaneHeight,h=this._bottomPaneHeight):(l=o,u=n,c=this._bottomPaneHeight,h=this._topPaneHeight);var d=l.getOptions().minHeight;if(c>d){var f=Math.max(c-Math.abs(r),d),v=c-f;l.setBounding({height:f}),u.setBounding({height:h+v});var g=a.getChart();g.getChartStore().getActionStore().execute(ht.OnPaneDrag,{paneId:a.getId()}),g.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},t.prototype._mouseEnterEvent=function(){var e,r=this.getPane(),a=r.getBottomPane();if((e=a==null?void 0:a.getOptions().dragEnabled)!==null&&e!==void 0&&e){var n=r.getChart(),o=n.getStyles().separator;return this.getContainer().style.background=o.activeBackgroundColor,!0}return!1},t.prototype._mouseLeaveEvent=function(){return this._dragFlag?!1:(this.getContainer().style.background="",!0)},t.prototype.createContainer=function(){return It("div",{width:"100%",height:"".concat(ne,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},t.prototype.updateImp=function(e,r,a){if(a===4||a===2){var n=this.getPane().getChart().getStyles().separator;e.style.top="".concat(-Math.floor((ne-n.size)/2),"px"),e.style.height="".concat(ne,"px")}},t}(gr),tr=function(i){V(t,i);function t(e,r,a,n,o,s){var l=i.call(this,e,r,a,n)||this;return l.getContainer().style.overflow="",l._topPane=o,l._bottomPane=s,l._separatorWidget=new fn(l.getContainer(),l),l}return t.prototype.setBounding=function(e){return vt(this.getBounding(),e),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(e){return this._topPane=e,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(e){return this._bottomPane=e,this},t.prototype.getWidget=function(){return this._separatorWidget},t.prototype.getImage=function(e){var r=this.getBounding(),a=r.width,n=r.height,o=this.getChart().getStyles().separator,s=It("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=Ft(s);return s.width=a*u,s.height=n*u,l.scale(u,u),l.fillStyle=o.color,l.fillRect(0,0,a,n),s},t.prototype.updateImp=function(e,r,a){if(e===4||e===2){var n=this.getChart().getStyles().separator;r.style.backgroundColor=n.color,r.style.height="".concat(a.height,"px"),r.style.marginLeft="".concat(a.left,"px"),r.style.width="".concat(a.width,"px"),this._separatorWidget.update(e)}},t}(Mr);function er(){var i;return typeof window>"u"?!1:((i=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&i!==void 0?i:-1)>-1}function be(){return typeof window>"u"?!1:/iPhone|iPad|iPod/.test(window.navigator.platform)}var gn=10,pn=function(){function i(t,e,r){var a=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!be(),this._onFirefoxOutsideMouseUp=function(n){a._mouseUpHandler(n)},this._onMobileSafariDoubleClick=function(n){if(a._firesTouchEvents(n)){if(++a._tapCount,a._tapTimeoutId!==null&&a._tapCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._tapCoordinate).manhattanDistance;o<30&&!a._cancelTap&&a._processEvent(a._makeCompatEvent(n),a._handler.doubleTapEvent),a._resetTapTimeout()}}else if(++a._clickCount,a._clickTimeoutId!==null&&a._clickCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._clickCoordinate).manhattanDistance;o<5&&!a._cancelClick&&a._processEvent(a._makeCompatEvent(n),a._handler.mouseDoubleClickEvent),a._resetClickTimeout()}},this._target=t,this._handler=e,this._options=r,this._init()}return i.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},i.prototype._mouseEnterHandler=function(t){var e=this,r,a,n;(r=this._unsubscribeMousemove)===null||r===void 0||r.call(this),(a=this._unsubscribeMouseWheel)===null||a===void 0||a.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){e._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){e._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},i.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._mouseMoveHandler=function(t){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},i.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!P(this._handler.mouseWheelHortEvent)||(this._preventDefault(t),Math.abs(t.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!P(this._handler.mouseWheelVertEvent))return;var e=-(t.deltaY/100);if(e===0)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32;break}if(e!==0){var r=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),r)}}},i.prototype._contextMenuHandler=function(t){this._preventDefault(t)},i.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var r=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),a=r.xOffset,n=r.yOffset,o=r.manhattanDistance;if(!(!this._touchMoveExceededManhattanDistance&&o<5)){if(!this._touchMoveExceededManhattanDistance){var s=a*.5,l=n>=s&&!this._options.treatVertDragAsPageScroll(),u=s>n&&!this._options.treatHorzDragAsPageScroll();!l&&!u&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},i.prototype._mouseMoveWithDownHandler=function(t){if(t.button===0){var e=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate),r=e.manhattanDistance;r>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent)}},i.prototype._mouseTouchMoveWithDownInfo=function(t,e){var r=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y),n=r+a;return{xOffset:r,yOffset:a,manhattanDistance:n}},i.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var r=this._makeCompatEvent(t,e);if(this._processEvent(r,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance;a<30&&!this._cancelTap&&this._processEvent(r,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(r,this._handler.tapEvent),P(this._handler.tapEvent)&&this._preventDefault(t));this._tapCount===0&&this._preventDefault(t),t.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},i.prototype._mouseUpHandler=function(t){if(t.button===0){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),er()){var r=this._target.ownerDocument.documentElement;r.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance;a<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},i.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},i.prototype._touchStartHandler=function(t){if(this._activeTouchId===null){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var r=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{var a=this._touchMoveHandler.bind(this),n=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){r.removeEventListener("touchmove",a),r.removeEventListener("touchend",n)},r.addEventListener("touchmove",a,{passive:!1}),r.addEventListener("touchend",n,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500)}this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},i.prototype._mouseDownHandler=function(t){if(t.button===2){this._preventDefault(t),this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);return}if(t.button===0){var e=this._target.ownerDocument.documentElement;er()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{var r=this._mouseMoveWithDownHandler.bind(this),a=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",r),e.removeEventListener("mouseup",a)},e.addEventListener("mousemove",r),e.addEventListener("mouseup",a)}this._mousePressed=!0,!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},i.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{var e=this._target.ownerDocument,r=function(a){t._handler.mouseDownOutsideEvent!=null&&(a.composed&&t._target.contains(a.composedPath()[0])||a.target!==null&&t._target.contains(a.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",r)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",r)},e.addEventListener("mousedown",r),e.addEventListener("touchstart",r,{passive:!0})}be()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(a){if(a.button===1)return a.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},i.prototype._initPinch=function(){var t=this;!P(this._handler.pinchStartEvent)&&!P(this._handler.pinchEvent)&&!P(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",function(e){t._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(e){if(!(e.touches.length!==2||t._startPinchMiddleCoordinate===null)&&P(t._handler.pinchEvent)){var r=t._getTouchDistance(e.touches[0],e.touches[1]),a=r/t._startPinchDistance;t._handler.pinchEvent(F(F({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),a),t._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",function(e){t._checkPinchState(e.touches)}))},i.prototype._checkPinchState=function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},i.prototype._startPinch=function(t){var e,r=(e=this._target.getBoundingClientRect())!==null&&e!==void 0?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-r.left+(t[1].clientX-r.left))/2,y:(t[0].clientY-r.top+(t[1].clientY-r.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),P(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},i.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,P(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},i.prototype._mouseLeaveHandler=function(t){var e,r,a;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(r=this._unsubscribeMouseWheel)===null||r===void 0||r.call(this),(a=this._unsubscribeContextMenu)===null||a===void 0||a.call(this),!this._firesTouchEvents(t)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!be())},i.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);e!==null&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},i.prototype._firesTouchEvents=function(t){var e;return P((e=t.sourceCapabilities)===null||e===void 0?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},i.prototype._processEvent=function(t,e){e==null||e.call(this._handler,t)},i.prototype._makeCompatEvent=function(t,e){var r=this,a,n=e??t,o=(a=this._target.getBoundingClientRect())!==null&&a!==void 0?a:{left:0,top:0};return{x:n.clientX-o.left,y:n.clientY-o.top,pageX:n.pageX,pageY:n.pageY,isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click"&&t.type!=="wheel",preventDefault:function(){t.type!=="touchstart"&&r._preventDefault(t)}}},i.prototype._getTouchDistance=function(t,e){var r=t.clientX-e.clientX,a=t.clientY-e.clientY;return Math.sqrt(r*r+a*a)},i.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},i.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},i.prototype._eventTimeStamp=function(t){var e;return(e=t.timeStamp)!==null&&e!==void 0?e:performance.now()},i.prototype._touchWithId=function(t,e){for(var r=0;r<t.length;++r)if(t[r].identifier===e)return t[r];return null},i}(),mn=function(){function i(t,e){var r=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(a){if(a.shiftKey)switch(a.code){case"Equal":{r._chart.getChartStore().getTimeScaleStore().zoom(.5);break}case"Minus":{r._chart.getChartStore().getTimeScaleStore().zoom(-.5);break}case"ArrowLeft":{var n=r._chart.getChartStore().getTimeScaleStore();n.startScroll(),n.scroll(-3*n.getBarSpace().bar);break}case"ArrowRight":{var n=r._chart.getChartStore().getTimeScaleStore();n.startScroll(),n.scroll(3*n.getBarSpace().bar);break}}},this._container=t,this._chart=e,this._event=new pn(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return i.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},i.prototype.pinchEvent=function(t,e){var r=this._findWidgetByEvent(t),a=r.pane,n=r.widget;if((a==null?void 0:a.getId())!==z.X_AXIS&&(n==null?void 0:n.getName())===O.MAIN){var o=this._makeWidgetEvent(t,n),s=(e-this._pinchScale)*5;return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(s,{x:o.x,y:o.y}),!0}return!1},i.prototype.mouseWheelHortEvent=function(t,e){var r=this._chart.getChartStore().getTimeScaleStore();return r.startScroll(),r.scroll(e),!0},i.prototype.mouseWheelVertEvent=function(t,e){var r=this._findWidgetByEvent(t).widget,a=this._makeWidgetEvent(t,r),n=r==null?void 0:r.getName();return n===O.MAIN?(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:a.x,y:a.y}),!0):!1},i.prototype.mouseDownEvent=function(t){var e,r,a=this._findWidgetByEvent(t),n=a.pane,o=a.widget;if(this._mouseDownWidget=o,o!==null){var s=this._makeWidgetEvent(t,o),l=o.getName();switch(l){case O.SEPARATOR:return o.dispatchEvent("mouseDownEvent",s);case O.MAIN:{var u=(e=n.getAxisComponent().getRange())!==null&&e!==void 0?e:null;return this._prevYAxisRange=u===null?u:F({},u),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),o.dispatchEvent("mouseDownEvent",s)}case O.X_AXIS:{var c=o.dispatchEvent("mouseDownEvent",s);return c&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,c}case O.Y_AXIS:{var c=o.dispatchEvent("mouseDownEvent",s);c&&this._chart.updatePane(1);var u=(r=n.getAxisComponent().getRange())!==null&&r!==void 0?r:null;return this._prevYAxisRange=u===null?u:F({},u),this._yAxisStartScaleDistance=s.pageY,c}}}return!1},i.prototype.mouseMoveEvent=function(t){var e,r,a,n=this._findWidgetByEvent(t),o=n.pane,s=n.widget,l=this._makeWidgetEvent(t,s);if((((e=this._mouseMoveTriggerWidgetInfo.pane)===null||e===void 0?void 0:e.getId())!==(o==null?void 0:o.getId())||((r=this._mouseMoveTriggerWidgetInfo.widget)===null||r===void 0?void 0:r.getName())!==(s==null?void 0:s.getName()))&&(s==null||s.dispatchEvent("mouseEnterEvent",l),(a=this._mouseMoveTriggerWidgetInfo.widget)===null||a===void 0||a.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:o,widget:s}),s!==null){var u=s.getName();switch(u){case O.MAIN:{var c=s.dispatchEvent("mouseMoveEvent",l),h=this._chart.getChartStore(),d={x:l.x,y:l.y,paneId:o==null?void 0:o.getId()};return c&&h.getTooltipStore().getActiveIcon()!==null&&(d=void 0,s!==null&&(s.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(d),c}case O.SEPARATOR:case O.X_AXIS:case O.Y_AXIS:{var c=s.dispatchEvent("mouseMoveEvent",l);return this._chart.getChartStore().getTooltipStore().setCrosshair(),c}}}return!1},i.prototype.pressedMouseMoveEvent=function(t){var e,r,a,n,o;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===O.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var s=this._findWidgetByEvent(t),l=s.pane,u=s.widget;if(u!==null&&((e=this._mouseDownWidget)===null||e===void 0?void 0:e.getPane().getId())===(l==null?void 0:l.getId())&&((r=this._mouseDownWidget)===null||r===void 0?void 0:r.getName())===u.getName()){var c=this._makeWidgetEvent(t,u),h=u.getName();switch(h){case O.MAIN:{var d=u.getBounding(),f=u.dispatchEvent("pressedMouseMoveEvent",c);if(!f&&this._startScrollCoordinate!==null){var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&!v.getAutoCalcTickFlag()&&v.getScrollZoomEnabled()){var g=this._prevYAxisRange,p=g.from,m=g.to,_=g.range,S;(a=v==null?void 0:v.isReverse())!==null&&a!==void 0&&a?S=this._startScrollCoordinate.y-c.y:S=c.y-this._startScrollCoordinate.y;var y=S/d.height,x=_*y,C=p+x,b=m+x,E=v.convertToRealValue(C),w=v.convertToRealValue(b);v.setRange({from:C,to:b,range:b-C,realFrom:E,realTo:w,realRange:w-E})}var I=c.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(I)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:c.x,y:c.y,paneId:l==null?void 0:l.getId()}),f}case O.X_AXIS:{var f=u.dispatchEvent("pressedMouseMoveEvent",c);if(f)this._chart.updatePane(1);else{var M=l.getAxisComponent();if(!((n=M==null?void 0:M.getScrollZoomEnabled())!==null&&n!==void 0)||n){var y=this._xAxisStartScaleDistance/c.pageX;if(Number.isFinite(y)){var T=(y-this._xAxisScale)*10;this._xAxisScale=y,this._chart.getChartStore().getTimeScaleStore().zoom(T,(o=this._xAxisStartScaleCoordinate)!==null&&o!==void 0?o:void 0)}}}return f}case O.Y_AXIS:{var f=u.dispatchEvent("pressedMouseMoveEvent",c);if(f)this._chart.updatePane(1);else{var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&v.getScrollZoomEnabled()){var D=this._prevYAxisRange,p=D.from,m=D.to,_=D.range,y=c.pageY/this._yAxisStartScaleDistance,A=_*y,x=(A-_)/2,C=p-x,b=m+x,E=v.convertToRealValue(C),w=v.convertToRealValue(b);v.setRange({from:C,to:b,range:A,realFrom:E,realTo:w,realRange:w-E}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}}return f}}}return!1},i.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,r=!1;if(e!==null){var a=this._makeWidgetEvent(t,e),n=e.getName();switch(n){case O.MAIN:case O.SEPARATOR:case O.X_AXIS:case O.Y_AXIS:{r=e.dispatchEvent("mouseUpEvent",a);break}}r&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,r},i.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(e!==null){var r=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",r)}return!1},i.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,r=!1;if(e!==null){var a=this._makeWidgetEvent(t,e),n=e.getName();switch(n){case O.MAIN:case O.X_AXIS:case O.Y_AXIS:{r=e.dispatchEvent("mouseRightClickEvent",a);break}}r&&this._chart.updatePane(1)}return!1},i.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,a=e.widget;if(a!==null){var n=a.getName();switch(n){case O.MAIN:{var o=this._makeWidgetEvent(t,a);return a.dispatchEvent("mouseDoubleClickEvent",o)}case O.Y_AXIS:{var s=r.getAxisComponent();if(!s.getAutoCalcTickFlag())return s.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0;break}}}return!1},i.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},i.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,a=e.widget;if(a!==null){var n=this._makeWidgetEvent(t,a),o=a.getName();switch(o){case O.MAIN:{var s=this._chart.getChartStore(),l=s.getTooltipStore();if(a.dispatchEvent("mouseDownEvent",n))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(Ge(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:n.x,y:n.y},s.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var u=n.x-this._touchCoordinate.x,c=n.y-this._touchCoordinate.y,h=Math.sqrt(u*u+c*c);h<gn?(this._touchCoordinate={x:n.x,y:n.y},l.setCrosshair({x:n.x,y:n.y,paneId:r==null?void 0:r.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case O.X_AXIS:case O.Y_AXIS:{var d=a.dispatchEvent("mouseDownEvent",n);return d&&this._chart.updatePane(1),d}}}return!1},i.prototype.touchMoveEvent=function(t){var e,r,a,n=this._findWidgetByEvent(t),o=n.pane,s=n.widget;if(s!==null){var l=this._makeWidgetEvent(t,s),u=s.getName(),c=this._chart.getChartStore(),h=c.getTooltipStore();switch(u){case O.MAIN:{if(s.dispatchEvent("pressedMouseMoveEvent",l))return(e=l.preventDefault)===null||e===void 0||e.call(l),h.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(r=l.preventDefault)===null||r===void 0||r.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var d=l.x-this._startScrollCoordinate.x;c.getTimeScaleStore().scroll(d)}return!0}case O.X_AXIS:case O.Y_AXIS:{var f=s.dispatchEvent("pressedMouseMoveEvent",l);return f&&((a=l.preventDefault)===null||a===void 0||a.call(l),this._chart.updatePane(1)),f}}}return!1},i.prototype.touchEndEvent=function(t){var e=this,r=this._findWidgetByEvent(t).widget;if(r!==null){var a=this._makeWidgetEvent(t,r),n=r.getName();switch(n){case O.MAIN:{if(r.dispatchEvent("mouseUpEvent",a),this._startScrollCoordinate!==null){var o=new Date().getTime()-this._flingStartTime,s=a.x-this._startScrollCoordinate.x,l=s/(o>0?o:1)*20;if(o<200&&Math.abs(l)>0){var u=this._chart.getChartStore().getTimeScaleStore(),c=function(){e._flingScrollRequestId=ve(function(){u.startScroll(),u.scroll(l),l=l*(1-.025),Math.abs(l)<1?e._flingScrollRequestId!==null&&(Ge(e._flingScrollRequestId),e._flingScrollRequestId=null):c()})};c()}}return!0}case O.X_AXIS:case O.Y_AXIS:{var h=r.dispatchEvent("mouseUpEvent",a);h&&this._chart.updatePane(1)}}}return!1},i.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,a=e.widget,n=!1;if(a!==null){var o=this._makeWidgetEvent(t,a),s=a.dispatchEvent("mouseClickEvent",o);if(a.getName()===O.MAIN){var l=this._makeWidgetEvent(t,a),u=this._chart.getChartStore(),c=u.getTooltipStore();s?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,c.setCrosshair(void 0,!0),n=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},c.setCrosshair({x:l.x,y:l.y,paneId:r==null?void 0:r.getId()},!0),n=!0),this._touchCancelCrosshair=!1)}(n||s)&&this._chart.updatePane(1)}return n},i.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},i.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,a=e.widget;if(a!==null&&a.getName()===O.MAIN){var n=this._makeWidgetEvent(t,a);return this._touchCoordinate={x:n.x,y:n.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:n.x,y:n.y,paneId:r==null?void 0:r.getId()}),!0}return!1},i.prototype._findWidgetByEvent=function(t){var e,r,a,n,o=t.x,s=t.y,l=this._chart.getAllSeparatorPanes(),u=this._chart.getChartStore().getStyles().separator.size;try{for(var c=Xt(l),h=c.next();!h.done;h=c.next()){var d=Ht(h.value,2),f=d[1],v=f.getBounding(),g=v.top-Math.round((ne-u)/2);if(o>=v.left&&o<=v.left+v.width&&s>=g&&s<=g+ne)return{pane:f,widget:f.getWidget()}}}catch(I){e={error:I}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}var p=this._chart.getAllDrawPanes(),m=null;try{for(var _=Xt(p),S=_.next();!S.done;S=_.next()){var y=S.value,v=y.getBounding();if(o>=v.left&&o<=v.left+v.width&&s>=v.top&&s<=v.top+v.height){m=y;break}}}catch(I){a={error:I}}finally{try{S&&!S.done&&(n=_.return)&&n.call(_)}finally{if(a)throw a.error}}var x=null;if(m!==null){if(x===null){var C=m.getMainWidget(),b=C.getBounding();o>=b.left&&o<=b.left+b.width&&s>=b.top&&s<=b.top+b.height&&(x=C)}if(x===null){var E=m.getYAxisWidget();if(E!==null){var w=E.getBounding();o>=w.left&&o<=w.left+w.width&&s>=w.top&&s<=w.top+w.height&&(x=E)}}}return{pane:m,widget:x}},i.prototype._makeWidgetEvent=function(t,e){var r,a,n,o=(r=e==null?void 0:e.getBounding())!==null&&r!==void 0?r:null;return F(F({},t),{x:t.x-((a=o==null?void 0:o.left)!==null&&a!==void 0?a:0),y:t.y-((n=o==null?void 0:o.top)!==null&&n!==void 0?n:0)})},i.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},i}(),yt;(function(i){i.Root="root",i.Main="main",i.YAxis="yAxis"})(yt||(yt={}));var _n=function(){function i(t,e){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(t),this._chartEvent=new mn(this._chartContainer,this),this._chartStore=new ya(this,e),this._initPanes(e),this.adjustPaneViewport(!0,!0,!0)}return i.prototype._initContainer=function(t){this._container=t,this._chartContainer=It("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},i.prototype._initPanes=function(t){var e=this,r,a=(r=t==null?void 0:t.layout)!==null&&r!==void 0?r:[{type:"candle"}],n=!1,o=!1,s=function(l){if(!o){var u=e._createPane(vn,z.X_AXIS,l??{});e._xAxisPane=u,o=!0}};a.forEach(function(l){var u,c,h;switch(l.type){case"candle":{if(!n){var d=(u=l.options)!==null&&u!==void 0?u:{};vt(d,{id:z.CANDLE}),e._candlePane=e._createPane(an,z.CANDLE,d);var f=(c=l.content)!==null&&c!==void 0?c:[];f.forEach(function(g){e.createIndicator(g,!0,d)}),n=!0}break}case"indicator":{var f=(h=l.content)!==null&&h!==void 0?h:[];if(f.length>0){var v;f.forEach(function(p){P(v)?e.createIndicator(p,!0,{id:v}):v=e.createIndicator(p,!0,l.options)})}break}case"xAxis":{s(l.options);break}}}),s({position:"bottom"})},i.prototype._createPane=function(t,e,r){var a=null,n=null,o=r==null?void 0:r.position;switch(o){case"top":{var s=this._drawPanes[0];P(s)&&(n=new t(this._chartContainer,s.getContainer(),this,e,r??{}),a=0);break}case"bottom":break;default:for(var l=this._drawPanes.length-1;l>-1;l--){var u=this._drawPanes[l],c=this._drawPanes[l-1];if((u==null?void 0:u.getOptions().position)==="bottom"&&(c==null?void 0:c.getOptions().position)!=="bottom"){n=new t(this._chartContainer,u.getContainer(),this,e,r??{}),a=l;break}}}P(n)||(n=new t(this._chartContainer,null,this,e,r??{}));var h;if(k(a)?(this._drawPanes.splice(a,0,n),h=a):(this._drawPanes.push(n),h=this._drawPanes.length-1),n.getId()!==z.X_AXIS){var d=this._drawPanes[h+1];if(P(d)&&d.getId()===z.X_AXIS&&(d=this._drawPanes[h+2]),P(d)){var f=this._separatorPanes.get(d);P(f)?f.setTopPane(n):(f=new tr(this._chartContainer,d.getContainer(),this,"",n,d),this._separatorPanes.set(d,f))}var v=this._drawPanes[h-1];if(P(v)&&v.getId()===z.X_AXIS&&(v=this._drawPanes[h-2]),P(v)){var f=new tr(this._chartContainer,n.getContainer(),this,"",v,n);this._separatorPanes.set(n,f)}}return n},i.prototype._measurePaneHeight=function(){var t=this,e,r=Math.floor(this._container.clientHeight),a=this._chartStore.getStyles().separator.size,n=this._xAxisPane.getAxisComponent().getAutoSize(),o=r-n-this._separatorPanes.size*a;o<0&&(o=0);var s=0;this._drawPanes.forEach(function(c){if(c.getId()!==z.CANDLE&&c.getId()!==z.X_AXIS){var h=c.getBounding().height,d=c.getOptions().minHeight;h<d&&(h=d),s+h>o?(s=o,h=Math.max(o-s,0)):s+=h,c.setBounding({height:h})}});var l=o-s;(e=this._candlePane)===null||e===void 0||e.setBounding({height:l}),this._xAxisPane.setBounding({height:n});var u=0;this._drawPanes.forEach(function(c){var h=t._separatorPanes.get(c);P(h)&&(h.setBounding({height:a,top:u}),u+=a),c.setBounding({top:u}),u+=c.getBounding().height})},i.prototype._measurePaneWidth=function(){var t=this,e=Math.floor(this._container.clientWidth),r=this._chartStore.getStyles(),a=r.yAxis,n=a.position===Rt.Left,o=!a.inside,s=0,l=0,u=0,c=0;this._drawPanes.forEach(function(p){p.getId()!==z.X_AXIS&&(l=Math.max(l,p.getAxisComponent().getAutoSize()))}),l>e&&(l=e),o?(s=e-l,n?(u=0,c=l):(u=e-l,c=0)):(s=e,c=0,n?u=0:u=e-l),this._chartStore.getTimeScaleStore().setTotalBarSpace(s);var h={width:e},d={width:s,left:c},f={width:l,left:u},v=r.separator.fill,g;o&&!v?g=d:g=h,this._drawPanes.forEach(function(p){var m;(m=t._separatorPanes.get(p))===null||m===void 0||m.setBounding(g),p.setBounding(h,d,f)})},i.prototype._setPaneOptions=function(t,e){var r,a;if(L(t.id)){var n=this.getDrawPaneById(t.id),o=!1;if(n!==null){var s=e;if(t.id!==z.CANDLE&&k(t.height)&&t.height>0){var l=Math.max((r=t.minHeight)!==null&&r!==void 0?r:n.getOptions().minHeight,0),u=Math.max(l,t.height);n.setBounding({height:u}),s=!0,o=!0}(L((a=t.axisOptions)===null||a===void 0?void 0:a.name)||P(t.gap))&&(s=!0),n.setOptions(t),s&&this.adjustPaneViewport(o,!0,!0,!0,!0)}}},i.prototype.getDrawPaneById=function(t){if(t===z.CANDLE)return this._candlePane;if(t===z.X_AXIS)return this._xAxisPane;var e=this._drawPanes.find(function(r){return r.getId()===t});return e??null},i.prototype.getContainer=function(){return this._container},i.prototype.getChartStore=function(){return this._chartStore},i.prototype.getXAxisPane=function(){return this._xAxisPane},i.prototype.getAllDrawPanes=function(){return this._drawPanes},i.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},i.prototype.adjustPaneViewport=function(t,e,r,a,n){t&&this._measurePaneHeight();var o=e,s=a??!1,l=n??!1;(s||l)&&this._drawPanes.forEach(function(u){var c=u.getAxisComponent().buildTicks(l);o||(o=c)}),o&&this._measurePaneWidth(),(r??!1)&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},i.prototype.updatePane=function(t,e){if(P(e)){var r=this.getDrawPaneById(e);r==null||r.update(t)}else this._separatorPanes.forEach(function(a){a.update(t)}),this._drawPanes.forEach(function(a){a.update(t)})},i.prototype.crosshairChange=function(t){var e=this,r=this._chartStore.getActionStore();if(r.has(ht.OnCrosshairChange)){var a={};this._drawPanes.forEach(function(n){var o=n.getId(),s={},l=e._chartStore.getIndicatorStore().getInstances(o);l.forEach(function(u){var c,h=u.result;s[u.name]=h[(c=t.dataIndex)!==null&&c!==void 0?c:h.length-1]}),a[o]=s}),L(t.paneId)&&r.execute(ht.OnCrosshairChange,F(F({},t),{indicatorData:a}))}},i.prototype.getDom=function(t,e){var r,a;if(L(t)){var n=this.getDrawPaneById(t);if(n!==null){var o=e??yt.Root;switch(o){case yt.Root:return n.getContainer();case yt.Main:return n.getMainWidget().getContainer();case yt.YAxis:return(a=(r=n.getYAxisWidget())===null||r===void 0?void 0:r.getContainer())!==null&&a!==void 0?a:null}}}else return this._chartContainer;return null},i.prototype.getSize=function(t,e){var r,a;if(P(t)){var n=this.getDrawPaneById(t);if(n!==null){var o=e??yt.Root;switch(o){case yt.Root:return n.getBounding();case yt.Main:return n.getMainWidget().getBounding();case yt.YAxis:return(a=(r=n.getYAxisWidget())===null||r===void 0?void 0:r.getBounding())!==null&&a!==void 0?a:null}}}else return{width:Math.floor(this._chartContainer.clientWidth),height:Math.floor(this._chartContainer.clientHeight),left:0,top:0,right:0,bottom:0};return null},i.prototype.setStyles=function(t){var e,r;this._chartStore.setOptions({styles:t});var a;L(t)?a=dr(t):a=t,P((e=a==null?void 0:a.yAxis)===null||e===void 0?void 0:e.type)&&((r=this._candlePane)===null||r===void 0||r.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getStyles=function(){return this._chartStore.getStyles()},i.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getLocale=function(){return this._chartStore.getLocale()},i.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},i.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},i.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},i.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},i.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},i.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},i.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(t)},i.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(t)},i.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},i.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},i.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},i.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},i.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},i.prototype.clearData=function(){this._chartStore.clear()},i.prototype.getDataList=function(){return this._chartStore.getDataList()},i.prototype.applyNewData=function(t,e,r){this._chartStore.addData(t,ct.Init,e).then(function(){}).catch(function(){}).finally(function(){r==null||r()})},i.prototype.applyMoreData=function(t,e,r){this._chartStore.addData(t,ct.Forward,e??!0).then(function(){}).catch(function(){}).finally(function(){r==null||r()})},i.prototype.updateData=function(t,e){this._chartStore.addData(t).then(function(){}).catch(function(){}).finally(function(){e==null||e()})},i.prototype.loadMore=function(t){this._chartStore.setLoadMoreCallback(t)},i.prototype.setLoadDataCallback=function(t){this._chartStore.setLoadDataCallback(t)},i.prototype.createIndicator=function(t,e,r,a){var n=this,o,s=L(t)?{name:t}:t;if(lr(s.name)===null)return null;var l=r==null?void 0:r.id,u=this.getDrawPaneById(l??"");if(u!==null)this._chartStore.getIndicatorStore().addInstance(s,l??"",e??!1).then(function(d){var f;n._setPaneOptions(r??{},(f=u.getAxisComponent().buildTicks(!0))!==null&&f!==void 0?f:!1)}).catch(function(d){});else{l??(l=or(z.INDICATOR));var c=this._createPane(Dr,l,r??{}),h=(o=r==null?void 0:r.height)!==null&&o!==void 0?o:da;c.setBounding({height:h}),this._chartStore.getIndicatorStore().addInstance(s,l,e??!1).finally(function(){n.adjustPaneViewport(!0,!0,!0,!0,!0),a==null||a()})}return l??null},i.prototype.overrideIndicator=function(t,e,r){var a=this;this._chartStore.getIndicatorStore().override(t,e??null).then(function(n){var o=Ht(n,2),s=o[0],l=o[1];(s||l)&&(a.adjustPaneViewport(!1,l,!0,l),r==null||r())}).catch(function(){})},i.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},i.prototype.removeIndicator=function(t,e){var r,a,n,o=this._chartStore.getIndicatorStore(),s=o.removeInstance(t,e);if(s){var l=!1;if(t!==z.CANDLE&&!o.hasInstances(t)){var u=this.getDrawPaneById(t),c=this._drawPanes.findIndex(function(m){return m.getId()===t});if(u!==null){l=!0;var h=this._separatorPanes.get(u);if(P(h)){var d=h==null?void 0:h.getTopPane();try{for(var f=Xt(this._separatorPanes),v=f.next();!v.done;v=f.next()){var g=v.value;if(g[1].getTopPane().getId()===u.getId()){g[1].setTopPane(d);break}}}catch(m){r={error:m}}finally{try{v&&!v.done&&(a=f.return)&&a.call(f)}finally{if(r)throw r.error}}h.destroy(),this._separatorPanes.delete(u)}this._drawPanes.splice(c,1),u.destroy();var p=this._drawPanes[0];P(p)&&p.getId()===z.X_AXIS&&(p=this._drawPanes[1]),(n=this._separatorPanes.get(p))===null||n===void 0||n.destroy(),this._separatorPanes.delete(p)}}this.adjustPaneViewport(l,!0,!0,!0,!0)}},i.prototype.createOverlay=function(t,e){var r=[];if(L(t))r=[{name:t}];else if(pt(t))r=t.map(function(s){return L(s)?{name:s}:s});else{var a=t;r=[a]}var n=!0;(!P(e)||this.getDrawPaneById(e)===null)&&(e=z.CANDLE,n=!1);var o=this._chartStore.getOverlayStore().addInstances(r,e,n);return pt(t)?o:o[0]},i.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},i.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},i.prototype.removeOverlay=function(t){var e;P(t)&&(L(t)?e={id:t}:e=t),this._chartStore.getOverlayStore().removeInstance(e)},i.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},i.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},i.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},i.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},i.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},i.prototype.scrollByDistance=function(t,e){var r=k(e)&&e>0?e:0,a=this._chartStore.getTimeScaleStore();if(a.startScroll(),r>0){var n=new Ie({duration:r});n.doFrame(function(o){var s=t*(o/r);a.scroll(s)}),n.start()}else a.scroll(t)},i.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),r=e.getBarSpace().bar,a=e.getLastBarRightSideDiffBarCount()-e.getInitialOffsetRightDistance()/r,n=a*r;this.scrollByDistance(n,t)},i.prototype.scrollToDataIndex=function(t,e){var r=this._chartStore.getTimeScaleStore(),a=(r.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*r.getBarSpace().bar;this.scrollByDistance(a,e)},i.prototype.scrollToTimestamp=function(t,e){var r=Pe(this.getDataList(),"timestamp",t);this.scrollToDataIndex(r,e)},i.prototype.zoomAtCoordinate=function(t,e,r){var a=k(r)&&r>0?r:0,n=this._chartStore.getTimeScaleStore(),o=n.getBarSpace().bar,s=o*t,l=s-o;if(a>0){var u=0,c=new Ie({duration:a});c.doFrame(function(h){var d=l*(h/a),f=(d-u)/n.getBarSpace().bar*Me;n.zoom(f,e),u=d}),c.start()}else n.zoom(l/o*Me,e)},i.prototype.zoomAtDataIndex=function(t,e,r){var a=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:a,y:0},r)},i.prototype.zoomAtTimestamp=function(t,e,r){var a=Pe(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,a,r)},i.prototype.convertToPixel=function(t,e){var r,a=e.paneId,n=a===void 0?z.CANDLE:a,o=e.absolute,s=o===void 0?!1:o,l=[];if(n!==z.X_AXIS){var u=this.getDrawPaneById(n);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),d=new Array().concat(t),f=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=d.map(function(g){var p={},m=g.dataIndex;if(k(g.timestamp)&&(m=c.timestampToDataIndex(g.timestamp)),k(m)&&(p.x=f==null?void 0:f.convertToPixel(m)),k(g.value)){var _=v==null?void 0:v.convertToPixel(g.value);p.y=s?h.top+_:_}return p})}}return pt(t)?l:(r=l[0])!==null&&r!==void 0?r:{}},i.prototype.convertFromPixel=function(t,e){var r,a=e.paneId,n=a===void 0?z.CANDLE:a,o=e.absolute,s=o===void 0?!1:o,l=[];if(n!==z.X_AXIS){var u=this.getDrawPaneById(n);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),d=new Array().concat(t),f=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=d.map(function(g){var p,m,_={};if(k(g.x)){var S=(p=f==null?void 0:f.convertFromPixel(g.x))!==null&&p!==void 0?p:-1;_.dataIndex=S,_.timestamp=(m=c.dataIndexToTimestamp(S))!==null&&m!==void 0?m:void 0}if(k(g.y)){var y=s?g.y-h.top:g.y;_.value=v.convertFromPixel(y)}return _})}}return pt(t)?l:(r=l[0])!==null&&r!==void 0?r:{}},i.prototype.executeAction=function(t,e){var r;switch(t){case ht.OnCrosshairChange:{var a=F({},e);a.paneId=(r=a.paneId)!==null&&r!==void 0?r:z.CANDLE,this._chartStore.getTooltipStore().setCrosshair(a);break}}},i.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},i.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},i.prototype.getConvertPictureUrl=function(t,e,r){var a=this,n=this._chartContainer.clientWidth,o=this._chartContainer.clientHeight,s=It("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=Ft(s);s.width=n*u,s.height=o*u,l.scale(u,u),l.fillStyle=r??"#FFFFFF",l.fillRect(0,0,n,o);var c=t??!1;return this._drawPanes.forEach(function(h){var d=a._separatorPanes.get(h);if(P(d)){var f=d.getBounding();l.drawImage(d.getImage(c),f.left,f.top,f.width,f.height)}var v=h.getBounding();l.drawImage(h.getImage(c),0,v.top,n,v.height)}),s.toDataURL("image/".concat(e??"jpeg"))},i.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach(function(t){t.destroy()}),this._drawPanes=[],this._separatorPanes.forEach(function(t){t.destroy()}),this._separatorPanes.clear(),this._container.removeChild(this._chartContainer)},i}(),rr=new Map,yn=1;function Sn(i,t){var e;if(L(i)?e=document.getElementById(i):e=i,e===null)return null;var r=rr.get(e.id);if(P(r))return r;var a="k_line_chart_".concat(yn++);return r=new _n(e,t),r.id=a,e.setAttribute("k-line-chart-id",a),rr.set(a,r),r}let Ce=0;const Ar=()=>{const i=["#4169E1","#DC143C","#FF8C00","#3CB371","#FF1493","#FFD700","#9400D3","#40E0D0","#B22222","#32CD32","#4682B4","#FF6347","#6A5ACD","#BDB76B","#008080","#F4A460","#9370DB","#2E8B57","#E9967A","#1E90FF"];return Ce>=i.length&&(Ce=0),i[Ce++]};function xn(i){return i.length>1&&i[0].timestamp>i[1].timestamp&&i.reverse(),i.length>0&&i[0].timestamp<1e10&&i.forEach(t=>{t.timestamp*=1e3}),i}async function bn(i){const t=Sn(i,{timezone:"UTC"});console.log("Inited");const[e,r,a]=await Promise.all([fetch("http://localhost:3000/bars"),fetch("http://localhost:3000/plots"),fetch("http://localhost:3000/lines")]),n=await e.json(),o=await r.json(),s=await a.json();return t.applyNewData(xn(n)),Cn(t,o),s&&s.length>0&&wn(t,s),t}function Cn(i,t){const e=Object.values(t).reduce((r,a)=>{const n=a.config.location||"pane_1";return r[n]||(r[n]=[]),r[n].push(a),r},{});console.log(e),Object.entries(e).forEach(([r,a])=>{const n=a.map((o,s)=>({key:`line_${s+1}`,type:"line",title:`line${s+1}:`}));zi({name:r,shortName:r,calcParams:[],precision:a[0].config.precision||1,figures:n,styles:{lines:a.map(o=>({size:o.config.width||0,color:o.config.color||Ar(),smooth:o.config.smooth||0,style:o.config.dashed?N.Dashed:N.Solid,dashedValue:o.config.dashed?[o.config.dashed]:[]}))},calc:o=>{const s=o.map((l,u)=>{const c={};for(let h=0;h<a.length;h++){const d=a[h].data[u].value;c[`line_${h+1}`]=d===null?NaN:d}return c});return console.log("it:"),console.log(s),s}}),console.log(`id=${r}`),i.createIndicator(r,!0,{id:r,height:r==="candle_pane"?void 0:100,minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}},()=>{})})}function wn(i,t){for(const e of t)i.createOverlay({name:e.type,points:e.points.map(r=>({timestamp:r.x*1e3,value:r.y})),styles:{line:{color:e.config.color||Ar(),style:e.config.dashed?N.Dashed:N.Solid,dashedValue:e.config.dashed?[e.config.dashed]:[],size:e.config.width}}},e.config.location)}window.onload=()=>{bn(document.getElementById("chart"))};
